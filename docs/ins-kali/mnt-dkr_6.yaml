- en: Chapter 6. Exploring Third Party Options
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第6章。探索第三方选项
- en: 'So far, we have been looking at the tools and services you host yourself. Along
    with these self-hosted tools, a large amount of cloud-based software has developed
    around Docker as a service ecosystem. In this chapter, we will look at the following
    topics:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们一直在研究自己托管的工具和服务。除了这些自托管的工具之外，围绕Docker作为服务生态系统发展了大量基于云的软件。在本章中，我们将研究以下主题：
- en: Why use a SaaS service over self-hosted or real-time metrics?
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为什么要使用SaaS服务而不是自托管或实时指标？
- en: What services are available and what do they offer?
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有哪些可用的服务以及它们提供了什么？
- en: Installation of agents for Sysdig Cloud, Datadog, and New Relic on the host
    machines
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在主机机器上安装Sysdig Cloud、Datadog和New Relic的代理
- en: Configuration of the agents to ship metrics
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置代理以传送指标
- en: A word about externally hosted services
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 关于外部托管服务的说明
- en: So far, to work through the examples in this book, we have used locally hosted
    virtual servers that are launched using vagrant. During this chapter, we are going
    to use services that need to be able to communicate with your host machine, so
    rather than trying to do this using your local machine, its about time you took
    your host machine into the cloud.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，为了在本书中的示例中工作，我们已经使用了使用vagrant启动的本地托管虚拟服务器。在本章中，我们将使用需要能够与主机通信的服务，因此与其尝试使用本地机器来做这件事，不如将主机机器移到云中。
- en: As we are going to start and stop the remote hosts while we look at the services,
    it pays to use a public cloud, as we only get charged for what we use.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们查看服务时，我们将启动和停止远程主机，因此最好使用公共云，因为我们只会按使用量收费。
- en: 'There are several public cloud services that you can use to evaluate the tools
    covered in this chapter, which one you choose to use is up to you, you could use:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 有几个公共云服务可供您评估本章涵盖的工具，您可以选择使用哪一个，您可以使用：
- en: 'Digital Ocean: [https://www.digitalocean.com/](https://www.digitalocean.com/)'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Digital Ocean：[https://www.digitalocean.com/](https://www.digitalocean.com/)
- en: 'Amazon Web Services: [https://aws.amazon.com/](https://aws.amazon.com/)'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 亚马逊网络服务：[https://aws.amazon.com/](https://aws.amazon.com/)
- en: 'Microsoft Azure: [https://azure.microsoft.com/](https://azure.microsoft.com/)'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Microsoft Azure：[https://azure.microsoft.com/](https://azure.microsoft.com/)
- en: 'VMware vCloud Air: [http://vcloud.vmware.com/](http://vcloud.vmware.com/)'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: VMware vCloud Air：[http://vcloud.vmware.com/](http://vcloud.vmware.com/)
- en: Or use your own preferred provider, the only pre-requisite is that your server
    is publically accessible.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 或者使用您自己喜欢的提供商，唯一的先决条件是您的服务器是公开可访问的。
- en: This chapter assumes that you are capable of launching either a CentOS 7 or
    Ubuntu 14.04 cloud instance and you understand that you will likely incur charges
    while the cloud instance is up and running.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 本章假设您有能力启动CentOS 7或Ubuntu 14.04云实例，并且您了解在云实例运行时可能会产生费用。
- en: Deploying Docker in the cloud
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在云中部署Docker
- en: Once you have launched your cloud instance, you can bootstrap Docker in the
    same way that you installed using vagrant. In the `chapter 6` folder of the Git
    repository, there are two separate scripts to download and install the Docker
    engine and compose it on your cloud instance.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您启动了云实例，您可以像使用vagrant安装一样引导Docker。在Git存储库的`第6章`文件夹中，有两个单独的脚本可下载并在云实例上安装Docker引擎并组合它。
- en: 'To install Docker, ensure that your cloud instance is updated by running:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装Docker，请确保您的云实例已更新，方法是运行：
- en: '[PRE0]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'For the CentOS instance of your Ubuntu, run the following command:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 对于您的CentOS实例或Ubuntu，请运行以下命令：
- en: '[PRE1]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Once updated, run the following command to install the software. Due to the
    differences in the way different cloud environments are configured, it is best
    to switch over to the root user to run the remainder of the commands, to do this,
    run:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 更新后，运行以下命令安装软件。由于不同的云环境配置方式不同，最好切换到root用户以运行其余的命令，要做到这一点，请运行：
- en: '[PRE2]'
  id: totrans-23
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Now you will be able to run the install script using the following command:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您将能够使用以下命令运行安装脚本：
- en: '[PRE3]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'To check that everything works as expected, run the following command:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 要检查一切是否按预期工作，请运行以下命令：
- en: '[PRE4]'
  id: totrans-27
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'You should see something similar to the terminal output, as shown in the following
    screenshot:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到类似于终端输出的内容，如下面的屏幕截图所示：
- en: '![Deploying Docker in the cloud](../images/00045.jpeg)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
  zh: '![在云中部署Docker](../images/00045.jpeg)'
- en: We can start to look at the SasS services once you have Docker up and running.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您的Docker运行起来，我们可以开始查看SaaS服务。
- en: Why use a SaaS service?
  id: totrans-31
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 为什么要使用SaaS服务？
- en: You may have noticed while working with the examples in the previous chapters
    that the tools we have used can potentially use many resources if we needed to
    start collecting more metrics, especially if the applications we want to monitor
    are in production.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能已经注意到，在前几章的示例中，如果我们需要开始收集更多的指标，我们使用的工具可能会使用很多资源，特别是如果我们要监视的应用程序正在生产中。
- en: To help shift this load from both storage and CPU, a number of cloud-based SaaS
    options have started offering support to record metrics for your containers. Many
    of these services were already offering services to monitor servers, so adding
    support for containers seemed a natural progression for them.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助减轻存储和CPU的负担，许多基于云的SaaS选项开始提供支持，记录容器的指标。许多这些服务已经提供了监视服务器的服务，因此为容器添加支持似乎是它们的自然发展。
- en: These typically require you to install an agent on your host machine, once installed,
    the agent will sit in the background and report to the services, normally cloud-based
    and API services.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 这些通常需要您在主机上安装代理，一旦安装完成，代理将在后台运行并向服务报告，通常是基于云和API服务。
- en: 'A few of the services allow you to deploy the agents as Docker containers.
    They offer containerized agents so that the service can run on stripped down operating
    systems, such as:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 其中一些服务允许您将代理部署为Docker容器。它们提供容器化代理，以便服务可以在精简的操作系统上运行，例如：
- en: 'CoreOS: [https://coreos.com/](https://coreos.com/)'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'CoreOS: [https://coreos.com/](https://coreos.com/)'
- en: 'RancherOS: [http://rancher.com/rancher-os/](http://rancher.com/rancher-os/)'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'RancherOS: [http://rancher.com/rancher-os/](http://rancher.com/rancher-os/)'
- en: 'Atomic: [http://www.projectatomic.io/](http://www.projectatomic.io/)'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Atomic: [http://www.projectatomic.io/](http://www.projectatomic.io/)'
- en: 'Ubuntu Snappy Core: [https://developer.ubuntu.com/en/snappy/](https://developer.ubuntu.com/en/snappy/)'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Ubuntu Snappy Core: [https://developer.ubuntu.com/en/snappy/](https://developer.ubuntu.com/en/snappy/)'
- en: These operating systems differ from traditional ones, as you cannot install
    services on them directly; their only purpose is to run a service, such as Docker,
    so that you can launch the services or applications you need to be run as containers.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 这些操作系统与传统操作系统不同，因为您不能直接在它们上安装服务；它们的唯一目的是运行服务，比如Docker，以便您可以启动需要作为容器运行的服务或应用程序。
- en: As we are running full operating systems as our host systems, we do not need
    this option and will be deploying the agents directly to the hosts.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们正在运行完整的操作系统作为我们的主机系统，我们不需要这个选项，将直接部署代理到主机上。
- en: 'The SaaS options that we are going to look at in this chapter are as follows:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在本章中查看的SaaS选项如下：
- en: 'Sysdig Cloud: [https://sysdig.com/product/](https://sysdig.com/product/)'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Sysdig Cloud: [https://sysdig.com/product/](https://sysdig.com/product/)'
- en: 'Datadog: [https://www.datadoghq.com/](https://www.datadoghq.com/)'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Datadog: [https://www.datadoghq.com/](https://www.datadoghq.com/)'
- en: 'New Relic: [http://newrelic.com](http://newrelic.com)'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: New Relic：[http://newrelic.com](http://newrelic.com)
- en: They all offer free trials and two of them offer free cut-down versions of the
    main service. On the face of it, they might all appear to offer similar services;
    however, when you start to use them, you will immediately notice that they are
    in fact all very different from each other.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 它们都提供免费试用，其中两个提供主要服务的免费简化版本。乍一看，它们可能都提供类似的服务；然而，当您开始使用它们时，您会立即注意到它们实际上彼此非常不同。
- en: Sysdig Cloud
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Sysdig Cloud
- en: In the previous chapter, we had a look at the open source version of Sysdig.
    We saw that there is a great ncurses interface called cSysdig and it allows us
    to navigate through all the data that Sysdig is collecting about our host.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们看了Sysdig的开源版本。我们看到有一个很棒的ncurses界面叫做cSysdig，它允许我们浏览Sysdig收集的关于我们主机的所有数据。
- en: The sheer amount of metrics and data collected by Sysdig means that you have
    to try to stay on top of it either by shipping your files off the server, maybe
    to Amazon Simple Storage Service (S3), or to some local shared storage. In addition,
    you can query the data in the command line on the host itself or on your local
    machine using an installation of the command-line tools.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: Sysdig收集的大量指标和数据意味着您必须尝试掌握它，可以通过将文件从服务器传输到亚马逊简单存储服务（S3）或一些本地共享存储来实现。此外，您可以在主机本身或使用命令行工具的安装在本地机器上查询数据。
- en: This is where Sysdig Cloud comes into play; it offers a web-based interface
    to the metrics that Sysdig captures along with the options to ship the Sysdig
    captures off your host machine either to Sysdig's own storage or to your S3 bucket.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是Sysdig Cloud发挥作用的地方；它提供了一个基于Web的界面，用于显示Sysdig捕获的指标，并提供将Sysdig捕获从主机机器传输到Sysdig自己的存储或您的S3存储桶的选项。
- en: 'Sysdig cloud offers the following functionality:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: Sysdig云提供以下功能：
- en: ContainerVision™
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ContainerVision™
- en: Real-Time Dashboard
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实时仪表板
- en: Historical Replay
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 历史回放
- en: Dynamic Topology
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 动态拓扑
- en: Alerting
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 警报
- en: As well as, the option to trigger a capture on any of your hosts and at any
    time.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，还可以在任何时间触发任何主机的捕获。
- en: 'Sysdig describes ContainerVision as:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: Sysdig将ContainerVision描述为：
- en: '*"Sysdig Cloud''s patent-pending core technology, ContainerVision, is the only
    monitoring technology on the market designed specifically to respect the unique
    characteristics of containers. ContainerVision offers you deep and comprehensive
    visibility into all aspects of your containerized environment - applications,
    infrastructures, servers, and networks - all without the need to pollute your
    containers with any extra instrumentation. In other words, ContainerVision gives
    you 100% visibility into the activity inside your containers, from the outside."*'
  id: totrans-59
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: “Sysdig Cloud的专利核心技术ContainerVision是市场上唯一专门设计用于尊重容器独特特性的监控技术。ContainerVision为您提供对容器化环境的所有方面-应用程序、基础设施、服务器和网络-的深入和全面的可见性，而无需向容器添加任何额外的仪器。换句话说，ContainerVision为您提供对容器内部活动的100%可见性，从外部看。”
- en: Before we delve into Sysdig Cloud any further, I should point out that this
    is a commercial server and at the time of writing, it costs $25 per host per month.
    There is also a 14-day fully featured trial available. If you wish to work through
    the agent installation and follow the example in this chapter, you will need an
    active account that runs either on the 14-day trial or a paid subscription.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们进一步深入了解Sysdig Cloud之前，我应该指出这是一个商业服务器，在撰写本文时，每台主机的费用为25美元。还提供14天完全功能的试用。如果您希望通过代理安装并按照本章的示例进行操作，您将需要一个在14天试用或付费订阅上运行的活跃帐户。
- en: 'Sign up for a 14-day free trial: [https://sysdig.com/](https://sysdig.com/)'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 注册14天免费试用：[https://sysdig.com/](https://sysdig.com/)
- en: 'Details on pricing: [https://sysdig.com/pricing/](https://sysdig.com/pricing/)'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定价详情：[https://sysdig.com/pricing/](https://sysdig.com/pricing/)
- en: 'Introduction to the company: [https://sysdig.com/company/](https://sysdig.com/company/)'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 公司简介：[https://sysdig.com/company/](https://sysdig.com/company/)
- en: Installing the agent
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装代理
- en: The agent installation is similar to installing the open source version; you
    need to ensure that your cloud host is running an up-to-date kernel and that you
    are also booted into the kernel.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 代理安装类似于安装开源版本；您需要确保您的云主机运行的是最新的内核，并且您也引导到了内核。
- en: Some cloud providers keep a tight control on the kernels you can boot into (for
    example, Digital Ocean), and they do not allow you to manage your kernel on the
    host itself. Instead, you need to choose the correct version through their control
    panel.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 一些云服务提供商严格控制您可以引导的内核（例如，Digital Ocean），他们不允许您在主机上管理内核。相反，您需要通过他们的控制面板选择正确的版本。
- en: 'Once you have the correct kernel installed, you should be able to run the following
    command to install the agent. Ensure that you replace the access key at the end
    of the command with your own access key, which can be found on your **User Profile**
    page or on the agent installation pages; you can find these at:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 安装了正确的内核后，您应该能够运行以下命令来安装代理。确保您用您自己的访问密钥替换命令末尾的访问密钥，您可以在**用户配置文件**页面或代理安装页面上找到它；您可以在以下位置找到这些信息：
- en: 'User Profile: [https://app.sysdigcloud.com/#/settings/user](https://app.sysdigcloud.com/#/settings/user)'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户配置文件：[https://app.sysdigcloud.com/#/settings/user](https://app.sysdigcloud.com/#/settings/user)
- en: 'Agent Installation: [https://app.sysdigcloud.com/#/settings/agentInstallation](https://app.sysdigcloud.com/#/settings/agentInstallation)'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 代理安装：[https://app.sysdigcloud.com/#/settings/agentInstallation](https://app.sysdigcloud.com/#/settings/agentInstallation)
- en: 'The command to run is:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 运行的命令是：
- en: '[PRE5]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The shell output should look like the following screen:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: Shell输出应该如下屏幕所示：
- en: '![Installing the agent](../images/00046.jpeg)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![安装代理](../images/00046.jpeg)'
- en: 'Once the agent has been installed, it will immediately start to report the
    data back to Sysdig Cloud. If you click on **Explore**, you will see your host
    machine and the running containers:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦代理安装完成，它将立即开始向Sysdig Cloud报告数据。如果您点击**探索**，您将看到您的主机和正在运行的容器：
- en: '![Installing the agent](../images/00047.jpeg)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![安装代理](../images/00047.jpeg)'
- en: As you can see here, I have my host machine and four containers running a WordPress
    installation similar to the one we used in the previous chapter. From here, we
    can start to drill down into our metrics.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 如您在这里所见，我有我的主机和四个容器运行着一个类似于我们在上一章中使用的WordPress安装。从这里，我们可以开始深入了解我们的指标。
- en: 'To launch the WordPress installation on your cloud-based machine, run the following
    commands as the root user:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 要在基于云的机器上启动WordPress安装，请以root用户身份运行以下命令：
- en: '[PRE6]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Exploring your containers
  id: totrans-79
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索您的容器
- en: 'The Sysdig Cloud web interface will feel instantly familiar, as it shares a
    similar design and overall feeling with cSysdig:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: Sysdig Cloud的Web界面会让人感到非常熟悉，因为它与cSysdig共享类似的设计和整体感觉：
- en: '![Exploring your containers](../images/00048.jpeg)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![探索您的容器](../images/00048.jpeg)'
- en: Once you start to drill down, you can see that a bottom pane opens up and this
    is where you can view the statistics. One of the things I liked about Sysdig Cloud
    is that it opens up a wealth of metrics and there should be very little that you
    need to configure from here.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您开始深入了解，您会发现底部窗格会打开，这是您可以查看统计数据的地方。我喜欢Sysdig Cloud的一点是它提供了丰富的指标，从这里您几乎不需要进行任何配置。
- en: 'For example, if you want to know what processes have been consuming the most
    CPU time in the last 2 hours, click on **2H** in the secondary menu and then from
    the **Views** tab in the bottom-left click on **System: Top Processes**; this
    will give you a table of the processes, ordered by the ones that have used the
    most time.'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '例如，如果您想知道在过去2小时内哪些进程消耗了最多的CPU时间，请单击次要菜单中的**2H**，然后从左下角的**Views**选项卡中单击**System:
    Top Processes**；这将为您提供一个按使用时间排序的进程表。'
- en: To apply this view to a container, click on a container in the top-section and
    the bottom-section will be instantly updated to reflect the top CPU utilization
    for just that container; as most containers will only run one or two processes,
    this may not be that interesting. So, let's have a deep look at the processes
    themselves. Let's say, we clicked on our database container and we wanted information
    on what is happening within MySQL.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 要将此视图应用于容器，请单击顶部部分中的容器，底部部分将立即更新以反映该容器的顶部CPU利用率；由于大多数容器只运行一个或两个进程，这可能并不那么有趣。因此，让我们深入了解进程本身。假设我们点击了我们的数据库容器，并且想要了解MySQL内部发生了什么。
- en: 'Sysdig Cloud comes with application overlays, these when selected give you
    more granular information on the processes within the container. Selecting the
    **App: MySQL/PostgreSQL** view gives you an insight into what your MySQL processes
    are currently doing:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 'Sysdig Cloud配备了应用程序叠加层，当选择时，可以更详细地了解容器内的进程。选择**App: MySQL/PostgreSQL**视图可以让您深入了解MySQL进程当前正在做什么：'
- en: '![Exploring your containers](../images/00049.jpeg)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![探索您的容器](../images/00049.jpeg)'
- en: Here, you can see that view in the bottom section has instantly updated to give
    a wealth of information on what has been happening in the last 5 minutes within
    MySQL.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，您可以看到底部部分的视图已经立即更新，提供了关于MySQL在过去5分钟内发生了什么的大量信息。
- en: 'Sysdig Cloud supports a number of application views, including:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: Sysdig Cloud支持多种应用程序视图，包括：
- en: Apache
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Apache
- en: HAProxy
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: HAProxy
- en: NGINX
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: NGINX
- en: RabbitMQ
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: RabbitMQ
- en: Redis
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Redis
- en: Tomcat
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Tomcat
- en: Each one gives you immediate access to metrics, which even the most experienced
    SysAdmins will find valuable.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 每个视图都可以立即访问指标，即使是最有经验的SysAdmins也会发现其价值。
- en: 'You may have noticed that at the top of the second panel there are also a few
    icons, these allow you to:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能已经注意到第二个面板顶部还有一些图标，这些图标允许您：
- en: '**Add Alert**: Creates an alert based on the view you have open; it lets you
    tweak the threshold and also choose how you are notified.'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**添加警报**：基于您打开的视图创建警报；它允许您调整阈值，并选择如何通知您。'
- en: '**Sysdig Capture**: Pressing this brings up a dialog, which lets you record
    a Sysdig session. Once recorded, the session is transferred to Sysdig Cloud or
    your own S3 bucket. Once the session is available, you download it or explore
    it within the web interface.'
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Sysdig Capture**：单击此按钮会弹出一个对话框，让您记录一个Sysdig会话。一旦记录完成，会话将传输到Sysdig Cloud或您自己的S3存储桶。会话可用后，您可以下载它或在Web界面中进行探索。'
- en: '**SSH Connect**: Gets a remote shell on the server from the Sysdig Cloud web
    interface; it is useful if you do not have immediate access to your laptop or
    desktop machine and you want to do some troubleshooting.'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**SSH连接**：从Sysdig Cloud Web界面在服务器上获取远程shell；如果您无法立即访问笔记本电脑或台式机，并且想要进行一些故障排除，这将非常有用。'
- en: '**Pin to dashboard**: Adds the current view to a custom dashboard.'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**固定到仪表板**：将当前视图添加到自定义仪表板。'
- en: 'Out these options icons, the "Add Alert" and "Sysdig Capture" options are probably
    the ones that you will end up using the most. One final view that I found interesting,
    is the topology one. It gives you a bird''s eye view of your host and containers,
    this is useful too see the interaction between containers and hosts:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 在这些选项图标中，“添加警报”和“Sysdig捕获”选项可能是您最终最常使用的选项。我发现有趣的最后一个视图是拓扑视图。它为您提供了对主机和容器的鸟瞰视图，这也对于查看容器和主机之间的交互非常有用。
- en: '![Exploring your containers](../images/00050.jpeg)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![探索您的容器](../images/00050.jpeg)'
- en: Here, you can see me request a page from the WordPress site (it's in the box
    on the left), this request hits my host machine (the box on the right). Once it's
    on the host machine, it is routed to the HAProxy container, which then passes
    the page request to the Wordpress2 container. From here, the Wordpress2 container
    interacts with the database that is running on the MySQL container.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，您可以看到我从WordPress网站请求页面（在左边的框中），这个请求命中了我的主机（右边的框）。一旦它在主机上，它被路由到HAProxy容器，然后将页面请求传递给Wordpress2容器。从这里，Wordpress2容器与在MySQL容器上运行的数据库进行交互。
- en: Summary and further reading
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要和进一步阅读
- en: 'Although Sysdig Cloud is quite a new service, it feels instantly familiar and
    fully featured as it is built on top of an already established and respected open
    source technology. If you like, the level of detail you get from the open source
    version of Sysdig, then Sysdig Cloud is a natural progression for you to start
    storing your metrics offsite and also to configure alerts. Some good starting
    points for learning more about Sysdig Cloud are:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管Sysdig Cloud是一个相当新的服务，但它感觉立即熟悉，并且功能齐全，因为它是建立在一个已经建立和受人尊敬的开源技术之上。如果您喜欢从Sysdig的开源版本中获得的详细信息，那么Sysdig
    Cloud是您开始将指标存储在外部并配置警报的自然进步。了解更多关于Sysdig Cloud的一些好的起点是：
- en: 'Video Introduction: [https://www.youtube.com/watch?v=p8UVbpw8n24](https://www.youtube.com/watch?v=p8UVbpw8n24)'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 视频介绍：[https://www.youtube.com/watch?v=p8UVbpw8n24](https://www.youtube.com/watch?v=p8UVbpw8n24)
- en: 'Sysdig Cloud Best Practices: [http://support.sysdigcloud.com/hc/en-us/articles/204872795-Best-Practices](http://support.sysdigcloud.com/hc/en-us/articles/204872795-Best-Practices)'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Sysdig云最佳实践：[http://support.sysdigcloud.com/hc/en-us/articles/204872795-Best-Practices](http://support.sysdigcloud.com/hc/en-us/articles/204872795-Best-Practices)
- en: 'Dashboards: [http://support.sysdigcloud.com/hc/en-us/articles/204863385-Dashboards](http://support.sysdigcloud.com/hc/en-us/articles/204863385-Dashboards)'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 仪表板：[http://support.sysdigcloud.com/hc/en-us/articles/204863385-Dashboards](http://support.sysdigcloud.com/hc/en-us/articles/204863385-Dashboards)
- en: 'Sysdig blog: [https://sysdig.com/blog/](https://sysdig.com/blog/)'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Sysdig博客：[https://sysdig.com/blog/](https://sysdig.com/blog/)
- en: Tip
  id: totrans-110
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: If you have launched a cloud instance and are no longer using it, now would
    be a good time to power the instance down or terminate it altogether. This will
    ensure that you do not get billed for services that you are not using.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您已经启动了一个云实例，但不再使用它，现在是一个很好的时机来关闭实例或彻底终止它。这将确保您不会因为未使用的服务而被收费。
- en: Datadog
  id: totrans-112
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Datadog
- en: 'Datadog is a full monitoring platform; it supports various servers, platforms,
    and applications. Wikipedia describes the service as:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: Datadog是一个完整的监控平台；它支持各种服务器、平台和应用程序。维基百科描述了该服务：
- en: '*"Datadog is a SaaS-based monitoring and analytics platform for IT infrastructure,
    operations and development teams. It brings together data from servers, databases,
    applications, tools and services to present a unified view of the applications
    that run at scale in the cloud."*'
  id: totrans-114
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*"Datadog是一个面向IT基础设施、运营和开发团队的基于SaaS的监控和分析平台。它汇集了来自服务器、数据库、应用程序、工具和服务的数据，以呈现云中规模运行的应用程序的统一视图。"*'
- en: It uses an agent that is installed on your host machine; this agent sends metrics
    back to the Datadog service periodically. It also support multiple cloud platforms,
    such as Amazon Web Services, Microsoft Azure, and OpenStack to name a few.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 它使用安装在主机上的代理；该代理定期将指标发送回Datadog服务。它还支持多个云平台，如亚马逊网络服务、微软Azure和OpenStack等。
- en: The aim is to bring all of your servers, applications, and host provider metrics
    into a single pane of glass; from here, you can create custom dashboards and alerts
    so that you can be notified of any problem at any level within your infrastructure.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 目标是将所有服务器、应用程序和主机提供商的指标汇集到一个统一的视图中；从这里，您可以创建自定义仪表板和警报，以便在基础架构的任何级别收到通知。
- en: You can sign up for a free trial of the full service at [https://app.datadoghq.com/signup](https://app.datadoghq.com/signup).
    You will need at least a trial account to configure the altering, and if your
    trial has already expired the lite account will do. For more detail on Datadog's
    pricing structure, please see [https://www.datadoghq.com/pricing/](https://www.datadoghq.com/pricing/).
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在[https://app.datadoghq.com/signup](https://app.datadoghq.com/signup)注册免费试用全套服务。您至少需要一个试用帐户来配置警报，如果您的试用已经过期，那么lite帐户也可以。有关Datadog定价结构的更多详细信息，请参阅[https://www.datadoghq.com/pricing/](https://www.datadoghq.com/pricing/)。
- en: Installing the agent
  id: totrans-118
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装代理
- en: 'The agent can be installed either directly on the host machine or as a container.
    To install directly on the host machine, run the following command and make sure
    that you use your own unique `DD_API_KEY`:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 代理可以直接安装在主机上，也可以作为容器安装。要直接在主机上安装，请运行以下命令，并确保使用您自己独特的`DD_API_KEY`：
- en: '[PRE7]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'To run the agent as a container, use the following command and again make sure
    that you use your own `DD_API_KEY`:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 要将代理作为容器运行，请使用以下命令，并确保使用您自己的`DD_API_KEY`：
- en: '[PRE8]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Once the agent has been installed, it will call back to Datadog and the host
    will appear in your account.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 安装代理后，它将回调Datadog，并且主机将出现在您的帐户中。
- en: If the agent has been installed directly on the host machine then we will need
    to enable the Docker integration, if you installed the agent using the container
    then this will have been done for you automatically.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 如果代理直接安装在主机上，那么我们需要启用Docker集成；如果您使用容器安装代理，则这将自动完成。
- en: 'To do this, you first need to allow the Datadog agent access to your Docker
    installation by adding the `dd-agent` user to the Docker group by running the
    following command:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 为了做到这一点，首先需要允许Datadog代理访问您的Docker安装，方法是通过运行以下命令将`dd-agent`用户添加到Docker组中：
- en: '[PRE9]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The next step is to create the `docker.yaml` configuration file, luckily the
    Datadog agent ships with an example configuration file that we can use; copy this
    in place and then restart the agent:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是创建`docker.yaml`配置文件，幸运的是，Datadog代理附带了一个示例配置文件，我们可以使用；将其复制到指定位置，然后重新启动代理：
- en: '[PRE10]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Now the agent on our host machine has been configured and the final step is
    to enable the integration through the website. To do this, go to [https://app.datadoghq.com/](https://app.datadoghq.com/)
    and click on **Integrations**, scroll down and then click on install on **Docker**:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们的主机上的代理已经配置好，最后一步是通过网站启用集成。要做到这一点，请转到[https://app.datadoghq.com/](https://app.datadoghq.com/)，点击**集成**，向下滚动，然后点击**Docker**上的安装：
- en: '![Installing the agent](../images/00051.jpeg)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
  zh: '![安装代理](../images/00051.jpeg)'
- en: Once you click install, you will be presented with an overview of the integration,
    click on the **Configuration** tab, this gives instructions on how to configure
    the agent; as we have already done this step, you can click on **Install Integration**.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 点击安装后，您将看到集成的概述，点击**配置**选项卡，这里提供了如何配置代理的说明；由于我们已经完成了这一步，您可以点击**安装集成**。
- en: 'You can find more information on installing the agent and the integrations
    at the following URLs:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在以下网址找到有关安装代理和集成的更多信息：
- en: '[https://app.datadoghq.com/account/settings#agent](https://app.datadoghq.com/account/settings#agent)'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://app.datadoghq.com/account/settings#agent](https://app.datadoghq.com/account/settings#agent)'
- en: '[https://app.datadoghq.com/account/settings#integrations](https://app.datadoghq.com/account/settings#integrations)'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://app.datadoghq.com/account/settings#integrations](https://app.datadoghq.com/account/settings#integrations)'
- en: Exploring the web interface
  id: totrans-135
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索网络界面
- en: Now, you have installed the agent and enabled the Docker integration, you can
    start to have a look around the web interface. To find your host, click on "Infrastructure"
    in the left-hand side menu.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您已经安装了代理并启用了Docker集成，您可以开始浏览网络界面。要找到您的主机，请在左侧菜单中点击“基础设施”。
- en: 'You should be taken to a screen that contains a map of your infrastructure.
    Like me, you probably only have a single host machine listed, click on it and
    some basic stats should appear at the bottom of the screen:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到一个包含您基础设施地图的屏幕。像我一样，您可能只列出了一个单个主机，点击它，一些基本统计数据应该出现在屏幕底部：
- en: '![Exploring the web interface](../images/00052.jpeg)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![探索网络界面](../images/00052.jpeg)'
- en: 'If you don''t already have the containers launched, now would be a good time
    to do so, lets launch the WordPress installation again using:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您还没有启动容器，现在是一个很好的时机，让我们再次使用以下内容启动WordPress安装：
- en: '[PRE11]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Now, go back to the web interface, from there you can click on any of the services
    listed on the hexagon. This will bring up some basic metrics for the service you
    have selected. If you click on **docker**, you will see a link for a Docker Dashboard
    among the various graphs and so on; clicking this will take you to a more detailed
    view of your containers:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，返回到网络界面，您可以点击六边形上列出的任何服务。这将为您选择的服务显示一些基本指标。如果您点击**docker**，您将看到Docker仪表板的链接，以及各种图表等；点击这个链接将带您进入容器的更详细视图：
- en: '![Exploring the web interface](../images/00053.jpeg)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![探索网络界面](../images/00053.jpeg)'
- en: As you can see, this gives us our now familiar break down of the CPU and memory
    metrics, along with in the top right of the dashboard a breakdown of the container
    activity on the host machine; this logs events, such as stopping and starting
    containers.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 正如您所看到的，这为我们提供了我们现在熟悉的CPU和内存指标的详细情况，以及仪表板右上角有关主机机器上容器活动的详细情况；这些记录了事件，例如停止和启动容器。
- en: 'Datadog currently records the following metrics:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: Datadog目前记录以下指标：
- en: '`docker.containers.running`'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`docker.containers.running`'
- en: '`docker.containers.stopped`'
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`docker.containers.stopped`'
- en: '`docker.cpu.system`'
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`docker.cpu.system`'
- en: '`docker.cpu.user`'
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`docker.cpu.user`'
- en: '`docker.images.available`'
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`docker.images.available`'
- en: '`docker.images.intermediate`'
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`docker.images.intermediate`'
- en: '`docker.mem.cache`'
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`docker.mem.cache`'
- en: '`docker.mem.rss`'
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`docker.mem.rss`'
- en: '`docker.mem.swap`'
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`docker.mem.swap`'
- en: 'From the **Metrics** explorer option in the left-hand side menu, you can start
    to graph these metrics and once you have the graphs, you can then start to add
    them to your own custom dashboards or even annotate them. When you annotate a
    graph, a snapshot is created and the graph shows up in the events queue along
    with the other events, that have been recorded, such as container stopping and
    starting:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 从左侧菜单中的**指标**资源管理器选项开始绘制这些指标，一旦您有了图表，您可以开始将它们添加到您自己的自定义仪表板，甚至注释它们。当您注释一个图表时，将创建一个快照，并且图表将显示在事件队列中，以及其他已记录的事件，例如容器的停止和启动：
- en: '![Exploring the web interface](../images/00054.jpeg)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![探索网络界面](../images/00054.jpeg)'
- en: Also, within the web interface you can configure monitors; these allow you to
    define triggers, which alert you if your conditions are not met. Alerts can be
    sent as e-mails or via third party services, such as Slack, Campfire, or PagerDuty.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，在Web界面中，您可以配置监视器；这些允许您定义触发器，如果条件不满足，则会向您发出警报。警报可以通过电子邮件或通过Slack、Campfire或PagerDuty等第三方服务发送。
- en: Summary and further reading
  id: totrans-157
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要和进一步阅读
- en: 'While Datadog''s Docker integration only gives you the basic metrics on your
    containers, it does have a wealth of features and integration with other applications
    and third parties. If you need to monitor a number of different services alongside
    your Docker containers, then this service could be for you:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然Datadog的Docker集成只为您提供容器的基本指标，但它具有丰富的功能和与其他应用程序和第三方的集成。如果您需要监视Docker容器以及其他不同服务，那么这项服务可能适合您：
- en: 'Home page: [https://www.datadoghq.com](https://www.datadoghq.com)'
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主页：[https://www.datadoghq.com](https://www.datadoghq.com)
- en: 'Overview: [https://www.datadoghq.com/product/](https://www.datadoghq.com/product/)'
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 概述：[https://www.datadoghq.com/product/](https://www.datadoghq.com/product/)
- en: 'Monitoring Docker with Datadog: [https://www.datadoghq.com/blog/monitor-docker-datadog/](https://www.datadoghq.com/blog/monitor-docker-datadog/)'
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Datadog监视Docker：[https://www.datadoghq.com/blog/monitor-docker-datadog/](https://www.datadoghq.com/blog/monitor-docker-datadog/)
- en: 'Twitter: [https://twitter.com/datadoghq](https://twitter.com/datadoghq)'
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Twitter：[https://twitter.com/datadoghq](https://twitter.com/datadoghq)
- en: Tip
  id: totrans-163
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: '**Please Remember**'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: '**请记住**'
- en: If you have launched a cloud instance and are no longer using it then now would
    be a good time to power the instance down or terminate it altogether. This will
    ensure that you do not get billed for any services you are not using.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您已经启动了一个云实例，但不再使用它，现在是关闭实例或彻底终止它的好时机。这将确保您不会因为未使用的任何服务而被收费。
- en: New Relic
  id: totrans-166
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 新的遗迹
- en: New Relic could be considered the granddaddy of SaaS monitoring tools, chances
    are that if you are a developer you will have heard of New Relic. It has been
    around for a while and it is the standard to which other SaaS tools compare themselves.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: New Relic可以被认为是SaaS监控工具的鼻祖，如果您是开发人员，很有可能您已经听说过New Relic。它已经存在一段时间了，是其他SaaS工具比较的标准。
- en: 'New Relic has grown into several products over the year, currently, they offer:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 多年来，New Relic已经发展成为几种产品，目前，它们提供：
- en: '**New Relic APM**: The main application performance-monitoring tool. This is
    what most people will know New Relic for; this toll gives you the code level visibility
    of your application.'
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**New Relic APM**：主要的应用程序性能监控工具。这是大多数人会知道New Relic的东西；这个工具可以让您看到应用程序的代码级别可见性。'
- en: '**New Relic Mobile**: A set of libraries to embed into your native mobile apps,
    giving APM levels of detail for your iOS and android application.'
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**New Relic Mobile**：一组库，嵌入到您的原生移动应用程序中，为您的iOS和Android应用程序提供APM级别的详细信息。'
- en: '**New Relic Insights**: A high-level view of all of the metrics collected by
    other New Relic services.'
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**New Relic Insights**：查看其他New Relic服务收集的所有指标的高级视图。'
- en: '**New Relic Servers**: Monitors your host servers, recording metrics around
    CPU, RAM, and storage utilization.'
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**New Relic Servers**：监视您的主机服务器，记录有关CPU、RAM和存储利用率的指标。'
- en: '**New Relic Browser**: Gives you an insight into what happens with your web-based
    applications once they leave your servers and enter your end user''s browser'
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**New Relic Browser**：让您了解您的基于Web的应用程序离开服务器并进入最终用户浏览器后发生了什么'
- en: '**New Relic Synthetics**: Monitors your applications responsiveness from various
    locations around the world.'
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**New Relic Synthetics**：从世界各地的各个位置监视您的应用程序的响应能力。'
- en: Rather than looking at all of these offerings that give us an insight into what
    is happening with our Docker-based code, as that's probably a whole book on its
    own, we are going to take a look at the server product.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 与其查看所有这些提供的内容，让我们了解一下关于基于Docker的代码发生了什么，这可能是一本完整的书，我们将看一下服务器产品。
- en: The server monitoring service offered by New Relic is available free of charge,
    you just need an active New Relic account, you can sign up for an account at [https://newrelic.com/signup/](https://newrelic.com/signup/)
    details on New Relics pricing can be found at their homepage at [http://newrelic.com/](http://newrelic.com/).
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: New Relic提供的服务器监控服务是免费的，您只需要一个活跃的New Relic账户，您可以在[https://newrelic.com/signup/](https://newrelic.com/signup/)注册账户，有关New
    Relic定价的详细信息可以在他们的主页[http://newrelic.com/](http://newrelic.com/)找到。
- en: Installing the agent
  id: totrans-177
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装代理
- en: 'Like the other SaaS offerings we have looked at in this chapter, New Relic
    Servers has a host-based client, which needs to be able to access the Docker binary.
    To install this on a CentOS machine, run the following:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 选择服务器将允许您开始探索代理正在记录的各种指标：
- en: '[PRE12]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'For Ubuntu, run the following command:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 对于Ubuntu，运行以下命令：
- en: '[PRE13]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Now that you have the agent installed, you need to configure the agent with
    your license key. You can do this with the following command and make sure that
    you add your license, which can be found in your settings page:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: '![探索Web界面](../images/00056.jpeg)'
- en: '[PRE14]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Now that the agent is configured, we need to add the `newrelic` user to the
    `docker` group so that the agent has access to our container information:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 现在代理已配置，我们需要将`newrelic`用户添加到`docker`组，以便代理可以访问我们的容器信息：
- en: '[PRE15]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Finally, we need to start the New Relic Server agent and restart Docker:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 网络：让您查看主机的网络活动
- en: '[PRE16]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Tip
  id: totrans-188
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 与本章中我们看过的其他SaaS产品一样，New Relic Servers有一个基于主机的客户端，需要能够访问Docker二进制文件。要在CentOS机器上安装此客户端，请运行以下命令：
- en: Restarting Docker will stop the running containers that you have; make sure
    that you make a note of these using `docker ps` and then start them manually and
    back up once the Docker service restarts.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 重新启动Docker将停止您正在运行的容器，请确保使用`docker ps`做好记录，然后在Docker服务重新启动后手动启动它们并备份。
- en: You should see your server appear on your New Relic control panel after a few
    minutes.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 几分钟后，您应该在New Relic控制面板上看到您的服务器出现。
- en: Exploring the web interface
  id: totrans-191
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索Web界面
- en: 'Once you have the New Relic server agent installed, configured, and running
    on your host machine, you will see something similar to the following screenshot
    when clicking on **Servers** in the top menu:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 安装、配置和在主机上运行New Relic服务器代理后，单击顶部菜单中的**服务器**时，您将看到类似以下截图的内容：
- en: '![Exploring the web interface](../images/00055.jpeg)'
  id: totrans-193
  prefs: []
  type: TYPE_IMG
  zh: '![探索Web界面](../images/00055.jpeg)'
- en: 'Selecting the server will allow you to start exploring the various metrics
    that the agent is recording:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 磁盘：提供有关您使用了多少空间的详细信息
- en: '![Exploring the web interface](../images/00056.jpeg)'
  id: totrans-195
  prefs: []
  type: TYPE_IMG
  zh: 最后，我们需要启动New Relic服务器代理并重新启动Docker：
- en: 'From here, you have the option to drill down further:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 从这里，您可以选择进一步深入：
- en: '**Overview**: Gives a quick overview of your host machine'
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 现在您已经安装了代理，您需要使用以下命令配置代理与您的许可证密钥。确保添加您的许可证，可以在设置页面中找到：
- en: '**Processes**: Lists all of the processes that are running both on the host
    machine and within your containers'
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 进程：列出在主机和容器中运行的所有进程
- en: '**Network**: Lets you see the network activity for your host machine'
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提示
- en: '**Disks**: Gives you details on how much space you are using'
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 概述：快速概述您的主机
- en: '**Docker**: Shows you the CPU and memory utilization for your containers'
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Docker：显示容器的CPU和内存利用率
- en: 'As you may have guessed, we are going to be looking at the **Docker** item
    next, click on it and you will see a list of your active images:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能已经猜到，接下来我们将看一下**Docker**项目，点击它，您将看到您的活动镜像列表：
- en: '![Exploring the web interface](../images/00057.jpeg)'
  id: totrans-203
  prefs: []
  type: TYPE_IMG
  zh: '![探索Web界面](../images/00057.jpeg)'
- en: You may have noticed a difference between New Relic and the other services,
    as you can see New Relic does not show you the running containers, instead it
    shows you the utilization by Docker image.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能已经注意到New Relic和其他服务之间的差异，正如您所看到的，New Relic不会显示您正在运行的容器，而是显示Docker镜像的利用率。
- en: 'In the preceding screenshot, I have four containers active and running the
    WordPress installation we have used elsewhere in the book. If I wanted a breakdown
    per container, then I would be out of luck, as demonstrated by the following screen:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 在上面的屏幕截图中，我有四个活动的容器，并且正在运行我们在本书其他地方使用过的WordPress安装。如果我想要每个容器的详细信息，那么我就没那么幸运了，就像下面的屏幕所示：
- en: '![Exploring the web interface](../images/00058.jpeg)'
  id: totrans-206
  prefs: []
  type: TYPE_IMG
  zh: '![探索Web界面](../images/00058.jpeg)'
- en: It's a pretty dull screen, but it gives you an idea about what you will see
    if you are running multiple containers that have been launched using the same
    image. So how is this useful? Well, coupled with the other services offered by
    New Relic, it can give you an indication of what your containers were up to when
    a problem occurred within your application. If you remember the Pets versus Cattle
    versus Chickens analogy from [Chapter 1](part0014_split_000.html#DB7S1-fcf7b4d102f841bba77b823d677470e0
    "Chapter 1. Introduction to Docker Monitoring"), *Introduction to Docker Monitoring*,
    we don't necessarily care which container did what; we just want to see the impact
    it had during the issue we are looking into.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个相当乏味的屏幕，但它可以让您了解，如果您运行了使用相同镜像启动的多个容器，您将看到什么。那么这有什么用呢？嗯，再加上New Relic提供的其他服务，它可以让您了解在应用程序发生问题时您的容器在做什么。如果您还记得第1章中关于宠物与牛与鸡的类比，我们并不一定关心哪个容器做了什么；我们只是想看到它在我们正在调查的问题发生期间产生的影响。
- en: Summary and further reading
  id: totrans-208
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 总结和进一步阅读
- en: 'Due to the amount of products it offers, New Relic can be a little daunting
    at first, but if you work with a development team that actively uses New Relic
    within their day-to-day workflow, then having all of the information about your
    infrastructure alongside this data can be both valuable and necessary, especially
    during an issue:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 由于New Relic提供的产品数量很多，一开始可能有点令人生畏，但如果您与一个开发团队合作，他们在日常工作流程中积极使用New Relic，那么拥有关于您的基础设施的所有信息以及这些数据可能是非常有价值和必要的，特别是在出现问题时：
- en: 'New Relic Server monitoring: [http://newrelic.com/server-monitoring](http://newrelic.com/server-monitoring)'
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: New Relic服务器监控：[http://newrelic.com/server-monitoring](http://newrelic.com/server-monitoring)
- en: 'New Relic and Docker: [http://newrelic.com/docker/](http://newrelic.com/docker/)'
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: New Relic和Docker：[http://newrelic.com/docker/](http://newrelic.com/docker/)
- en: 'Twitter: [https://twitter.com/NewRelic](https://twitter.com/NewRelic)'
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Twitter: [https://twitter.com/NewRelic](https://twitter.com/NewRelic)'
- en: Tip
  id: totrans-213
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: If you have launched a cloud instance and are no longer using it then, now is
    a good time to power the instance down or terminate it altogether, this will ensure
    you do not get billed for any services you are not using.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您启动了一个云实例，现在不再使用它，那么现在是关闭实例或彻底终止它的好时机，这将确保您不会因为未使用的任何服务而被收费。
- en: Summary
  id: totrans-215
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: 'Which SaaS service you choose depends on your circumstances, there are a number
    of questions you should ask yourself before you start evaluating the SaaS offerings:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 选择哪种SaaS服务取决于您的情况，在开始评估SaaS产品之前，您应该问自己一些问题：
- en: How many containers would you like to monitor?
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您想要监控多少个容器？
- en: How many host machines do you have?
  id: totrans-218
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您有多少台主机？
- en: Is there a non-containerized infrastructure you need to monitor?
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您需要监控非容器化基础架构吗？
- en: What metrics do you need from the monitoring service?
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您需要监控服务提供的哪些指标？
- en: How long should the data be retained for?
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据应该保留多长时间？
- en: Could other departments, such as development and utilize the service?
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 其他部门，比如开发部门，能否利用这项服务？
- en: 'We covered just three of the available SaaS options in this chapter, there
    are other options available, such as:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 本章中我们只涵盖了三种可用的SaaS选项，还有其他选项可用，比如：
- en: 'Ruxit: [https://ruxit.com/docker-monitoring/](https://ruxit.com/docker-monitoring/)'
  id: totrans-224
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Ruxit: [https://ruxit.com/docker-monitoring/](https://ruxit.com/docker-monitoring/)'
- en: 'Scout: [https://scoutapp.com/plugin_urls/19761-docker-monitor](https://scoutapp.com/plugin_urls/19761-docker-monitor)'
  id: totrans-225
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Scout: [https://scoutapp.com/plugin_urls/19761-docker-monitor](https://scoutapp.com/plugin_urls/19761-docker-monitor)'
- en: 'Logentries: [https://logentries.com/insights/server-monitoring/](https://logentries.com/insights/server-monitoring/)'
  id: totrans-226
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Logentries: [https://logentries.com/insights/server-monitoring/](https://logentries.com/insights/server-monitoring/)'
- en: 'Sematext: [http://sematext.com/spm/integrations/docker-monitoring.html](http://sematext.com/spm/integrations/docker-monitoring.html)'
  id: totrans-227
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Sematext: [http://sematext.com/spm/integrations/docker-monitoring.html](http://sematext.com/spm/integrations/docker-monitoring.html)'
- en: Monitoring servers and services are only as good as the metrics you collect,
    if possible and if your budget allows, you should take full advantage of the services
    offered by your chosen providers, as more data being recorded by a single provider
    will only benefit you when it comes to analyzing problems with not only your containerized
    applications, but also with your infrastructure, code and even your cloud provider.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 监控服务器和服务的效果取决于您收集的指标，如果可能并且预算允许，您应该充分利用所选提供商提供的服务，因为单个提供商记录的数据越多，不仅有利于分析容器化应用程序的问题，还有利于分析基础架构、代码甚至云提供商的问题。
- en: For example, if you are monitoring your host machine using the same service
    as you use to monitor your containers, then by using the custom graphing functions,
    you should be able to create overlay graphs of CPU load spikes of both your host
    machine and your container. This is a lot more useful than trying to compare two
    different graphs from different systems side by side.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果您正在使用相同的服务来监视主机和容器，那么通过使用自定义图形函数，您应该能够创建CPU负载峰值的叠加图，包括主机和容器。这比尝试将来自不同系统的两个不同图形进行比较要有用得多。
- en: 'In the next chapter, we will look at an often-overlooked part of monitoring:
    shipping your log files away from your containers/hosts to a single location so
    that they can be monitored and reviewed.'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将看一下监控中经常被忽视的部分：将日志文件从容器/主机中传输到单一位置，以便进行监控和审查。
