- en: Chapter 10. Beta Testing Your Apps
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第10章。测试您的应用程序
- en: You did everything you could do to ensure the quality and performance of your
    app. Now it is time to ship your app to your beta users to see what they think
    of it.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 您已经尽力确保应用程序的质量和性能。现在是时候将应用程序发布到测试版用户，看看他们对此的看法了。
- en: Tip
  id: totrans-2
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Before shipping your app, you should have a look at Crashlytics first. You can
    find it at [https://try.crashlytics.com](https://try.crashlytics.com).
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在发布应用程序之前，您应该先查看Crashlytics。您可以在[https://try.crashlytics.com](https://try.crashlytics.com)找到它。
- en: Crashlytics can provide you with real-time crash reporting information not only
    during your beta tests, but also after releasing your app on the Play Store. Sooner
    or later, your app runs on a device that you have not tested your app on and it
    crashes on it. Crashlytics can help you find the cause for this.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Crashlytics可以为您提供实时崩溃报告信息，不仅在测试版测试期间，还在您的应用程序发布到Play商店后。迟早，您的应用程序会在您没有测试过的设备上运行，并在其上崩溃。Crashlytics可以帮助您找到这一原因。
- en: Just download their SDK, add a few lines of code to your app, and you are good
    to go.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 只需下载他们的SDK，向您的应用程序添加几行代码，然后您就可以开始了。
- en: Distribute your app and get it tested before revealing your app to a large audience
    by publishing it on the Play Store. Learn from their feedback and improve your
    app.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在将应用程序发布到Play商店上向大众公开之前，先分发您的应用程序并进行测试。从他们的反馈中学习并改进您的应用程序。
- en: 'At last, you can put this logo on your website:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，您可以将这个标志放在您的网站上：
- en: '![Beta Testing Your Apps](img/B04299_10_01.jpg)'
  id: totrans-8
  prefs: []
  type: TYPE_IMG
  zh: '![测试您的应用程序](img/B04299_10_01.jpg)'
- en: 'In this chapter, you will learn about:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您将学习以下内容：
- en: Build variants
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建变体
- en: Runtime permissions
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 运行时权限
- en: Play Store beta distribution
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Play商店测试版分发
- en: Introduction
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: 'A typical software release cycle goes like this, although it does not necessarily
    have to go through each phase:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 典型的软件发布周期是这样的，尽管不一定必须经过每个阶段：
- en: Alpha -> closed beta -> open beta -> release.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: Alpha -> 封闭测试版 -> 公开测试版 -> 发布。
- en: You could release your app directly on the Google Play Store, but having at
    least one beta round is a clever thing to do. Gathering feedback and applying
    further improvements can make your app even better.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以直接在Google Play商店上发布您的应用程序，但至少进行一轮测试是明智的。收集反馈并进行进一步改进可以使您的应用程序变得更好。
- en: We will have a look at how to set up multiple different flavors for your app
    and how to define different build types for it. For example, your release app
    will most likely use different API endpoints than those you used to debug and
    test, at least I hope so.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将看看如何为您的应用程序设置多个不同的风味，以及如何为其定义不同的构建类型。例如，您的发布应用程序很可能会使用不同的API端点，而不是您用于调试和测试的端点，至少我希望如此。
- en: The minimum API level you choose, the required features, and the requested permissions
    will affect the number of devices that your app will be available for in the Play
    Store. Also, we will have a preview of how runtime permissions that come with
    Android Marshmallow require a different approach.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 您选择的最低API级别、所需功能和所请求的权限将影响您的应用程序在Play商店中可用的设备数量。此外，我们将预览Android Marshmallow提供的运行时权限需要不同的方法。
- en: Finally, we will find out what we need to do to distribute a beta or alpha version
    of our app using the Google Play Store.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们将找出在Google Play商店上分发应用程序的测试版或Alpha版本需要做什么。
- en: Build variants
  id: totrans-20
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 构建变体
- en: Android Studio supports different configurations for your app. For example,
    your app might use different API endpoints for debugging. For this purpose, we
    will use build types.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: Android Studio支持应用程序的不同配置。例如，您的应用程序可能会在调试时使用不同的API端点。为此，我们将使用构建类型。
- en: In addition to this, you may have different versions of your app. A single project
    can have multiple customized versions of the app. If these changes are minimal
    and, for example, just change the look of an app in case it is a white label solution
    using a flavor is the way to go.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 除此之外，您可能会有不同版本的应用程序。一个项目可以有多个定制版本的应用程序。如果这些变化很小，例如只是改变了应用程序的外观，那么使用风味是一个好方法。
- en: A build variant is the combination of a build type and a particular flavor.
    The upcoming recipe will demonstrate how to use these.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 构建变体是构建类型和特定风味的组合。接下来的教程将演示如何使用这些。
- en: Getting ready
  id: totrans-24
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: For this recipe, you just need a recent copy of Android Studio.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个教程，您只需要一个最新版本的Android Studio。
- en: How to do it...
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'We will build a simple messaging app that uses different build types and build
    flavors:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将构建一个简单的消息应用程序，该应用程序使用不同的构建类型和构建风味：
- en: Create a new project in Android Studio, name it `WhiteLabelMessenger`, enter
    a company name in the **Company Domain** field, and click on the **OK** button.
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Android Studio中创建一个新项目，命名为`WhiteLabelMessenger`，在**公司域**字段中输入公司名称，然后单击**确定**按钮。
- en: Next, choose **Phone and Tablet** and click on the **Next** button.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，选择**手机和平板电脑**，然后单击**下一步**按钮。
- en: Choose **Blank activity** and click on the **Next** button.
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**空白活动**，然后单击**下一步**按钮。
- en: Accept the suggested values and click on the **Finish** button.
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接受建议的值，然后单击**完成**按钮。
- en: 'Open the `strings.xml` file and add a few extra strings. They should look like
    these:'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开`strings.xml`文件并添加一些额外的字符串。它们应该看起来像这样：
- en: '[PRE0]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Create an `icon.xml` and a `background.xml` resource file in the `res/drawable`
    folder.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`res/drawable`文件夹中创建一个`icon.xml`和一个`background.xml`资源文件。
- en: 'In the `res/drawable` folder, create a new file and name it `icon.xml`. It
    will draw a blue-colored circle:'
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`res/drawable`文件夹中，创建一个名为`icon.xml`的新文件。它将绘制一个蓝色的圆圈：
- en: '[PRE1]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'In the `res/drawable` folder, create a new file and name it `background.xml`.
    It defines a gradient blue background:'
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`res/drawable`文件夹中，创建一个名为`background.xml`的新文件。它定义了一个渐变蓝色背景：
- en: '[PRE2]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Open the `activity_main.xml` file and modify it so that it looks like this:'
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开`activity_main.xml`文件并修改它，使其看起来像这样：
- en: '[PRE3]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Open the `androidmanifest.xml` file and a permission to send SMS messages:'
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开`androidmanifest.xml`文件并添加一个发送短信的权限：
- en: '[PRE4]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Modify the `onCreate` method of the `MainActivity` file. You can press *Shift*
    two times to display a search panel. Type `onCreate` on the search panel and select
    the `onCreate` method of the `MainActivity` class:'
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修改`MainActivity`文件的`onCreate`方法。您可以按两次*Shift*键来显示搜索面板。在搜索面板上输入`onCreate`，并选择`MainActivity`类的`onCreate`方法：
- en: '[PRE5]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Add an on click listener on the `MainActivity` class and implement the `onClick`
    method:'
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`MainActivity`类上添加一个点击监听器，并实现`onClick`方法：
- en: '[PRE6]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Select the `app` folder. Next, choose **Edit flavors** from the **Build** menu.
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择`app`文件夹。然后，从**构建**菜单中选择**编辑风味**。
- en: The list only contains a defaultConfig. Click on the **+** button to add a new
    flavor. Name it `blueFlavor` and give it the same values as `min sdk version`
    and `target sdk version` as is the case with **defaultConfig**.
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 列表中只包含一个defaultConfig。单击**+**按钮添加一个新的风味。将其命名为`blueFlavor`，并与**defaultConfig**相同的值作为`min
    sdk version`和`target sdk version`。
- en: For the **application id** field, use the package name **+** the extension .`blue`.
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于**application id**字段，使用包名**+**扩展名`.blue`。
- en: Enter the **version code** and **version name** for this flavor and click on
    the **OK** button.
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为该风味输入**版本代码**和**版本名称**，然后单击**确定**按钮。
- en: Repeat step 14 to 16 for another flavor. Name that flavor `greenFlavor`.
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为另一个风味重复步骤14到16。将该风味命名为`greenFlavor`。
- en: 'Now your `build.gradle` file should contain the flavors as shown:'
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在您的`build.gradle`文件应该包含如下风味：
- en: '[PRE7]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: In the **Project** panel, select the `src` folder under the `app` folder. Then,
    create a new folder and name it `blueFlavor`. Within that folder, you can maintain
    the same structure, as is the case for the `main` folder. For this recipe, it
    is sufficient just to add a `res` folder and within that folder another one called
    `drawable`.
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**项目**面板中，选择`app`文件夹下的`src`文件夹。然后，创建一个新文件夹，并命名为`blueFlavor`。在该文件夹中，您可以保持与`main`文件夹相同的结构。对于本教程，只需添加一个`res`文件夹，在该文件夹中再添加一个名为`drawable`的文件夹即可。
- en: Do the same thing for the `greenFlavor` build's flavor. The project structure
    will now look like this:![How to do it...](img/B04299_10_02.jpg)
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对`greenFlavor`构建的风味执行相同的操作。项目结构现在如下所示：![如何操作...](img/B04299_10_02.jpg)
- en: Copy the `background.xml` and `icon.xml` files from the `/main/res/drawable`
    folder and paste them in the `blueFlavor/res/drawable` folder.
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从`/main/res/drawable`文件夹中复制`background.xml`和`icon.xml`文件，并将它们粘贴到`blueFlavor/res/drawable`文件夹中。
- en: 'Repeat this for `greenFlavor` and open the `background.xml` file in the `greenFlavor/res/drawable`
    folder. Modify its content. For the green flavor, we will be using a gradient
    green color:'
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为`greenFlavor`重复此操作，并在`greenFlavor/res/drawable`文件夹中打开`background.xml`文件。修改其内容。对于绿色风味，我们将使用渐变绿色：
- en: '[PRE8]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Now, within the same folder, open the `icon.xml` file and make the `drawable`
    folder appear in green as well:'
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，在同一文件夹中，打开`icon.xml`文件，并将`drawable`文件夹也显示为绿色：
- en: '[PRE9]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: The same thing can be done to use different values (or classes or layouts) for
    the debug and release build types. Create a `debug` folder in the `app/src` folder.
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 可以使用相同的方法来为调试和发布构建类型使用不同的值（或类或布局）。在`app/src`文件夹中创建一个`debug`文件夹。
- en: Within that folder, create a `res` folder and within that, a `values` folder.
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在该文件夹中，创建一个`res`文件夹，然后在其中创建一个`values`文件夹。
- en: Copy the `strings.xml` file from the `main/res/values` folder and paste it into
    the `debug/res/values` folder.
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将`strings.xml`文件从`main/res/values`文件夹复制并粘贴到`debug/res/values`文件夹中。
- en: 'Open the `strings.xml` file and modify the `really_send_sms` string resource:'
  id: totrans-64
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开`strings.xml`文件，并修改`really_send_sms`字符串资源：
- en: '[PRE10]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Tip
  id: totrans-66
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: A better approach for this purpose of course will be to use a constants class
    that defines different values, but for the sake of simplicity, we will modify
    the string resource instead.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，为了简单起见，我们将修改字符串资源，而更好的方法当然是使用一个定义不同值的常量类。
- en: Build variants
  id: totrans-68
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 构建变体
- en: 'Select the `app` folder and choose **Select Build Variant** from the **Build**
    menu. It will display the **Build variants** panel as shown in the following screenshot:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 选择`app`文件夹，并从**构建**菜单中选择**选择构建变体**。它将显示如下截图所示的**构建变体**面板：
- en: '![Build variants](img/B04299_10_03.jpg)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![构建变体](img/B04299_10_03.jpg)'
- en: 'And follow the next steps in **Build Variants**:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 在**构建变体**中按照以下步骤进行：
- en: Choose the **greenFlavorDebug** build variant and run the app.
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**greenFlavorDebug**构建变体，并运行应用程序。
- en: If everything goes well, the app has a green look and behaves as if it is being
    debugged.
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果一切顺利，应用程序将呈现绿色外观，并且表现得好像正在进行调试。
- en: Now change the build variant to **blueFlavorDebug** and run the app again. Indeed,
    it looks blue now.
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在将构建变体更改为**blueFlavorDebug**，然后再次运行应用程序。确实，现在它看起来是蓝色的。
- en: Build types
  id: totrans-75
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 构建类型
- en: More or less the same thing applies to the debug and release build types; however,
    this time instead of the looks, the behavior or data (or end points for that matter)
    changes.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 调试和发布构建类型也基本相同；但是，这次不是外观，而是行为或数据（或者端点）发生了变化。
- en: Note
  id: totrans-77
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Releasing the app requires signing, which is something we will do when we distribute
    the app to the Play Store, which has been described in the last recipe.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 发布应用程序需要签名，这是我们将在将应用程序分发到Play商店时执行的操作，这在上一篇教程中已经描述过了。
- en: '![Build types](img/B04299_10_04.jpg)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![构建类型](img/B04299_10_04.jpg)'
- en: This is basically all there is to tell about build variants. Most ideal build
    types and flavors contain just a small number of modifications. If the differences
    between the various flavors of your app are more than just some tweaks in layouts,
    drawables, or constant values, you will have to consider a different approach.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 这基本上就是构建变体的全部内容。大多数理想的构建类型和风味只包含少量修改。如果您的应用程序的各种风味之间的差异不仅仅是在布局、可绘制对象或常量值上进行一些微调，那么您将不得不考虑采用不同的方法。
- en: There's more...
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'Android Studio comes with a couple of other great features to finalize your
    app. One of them is creating technical documentation automatically. Just add some
    comments to a class or method, like this:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: Android Studio还提供了一些其他很棒的功能来完成您的应用程序。其中之一是自动生成技术文档。只需向类或方法添加一些注释，就像这样：
- en: '[PRE11]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Now if you choose **Generate JavaDoc** from the **Tools** menu and define the
    path in the **output directory** field in the dialog that appears, you just need
    to click the **OK** button and all documentation is being generated as HTML files.
    The outcome will be displayed in your browser as follows:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，如果您从**工具**菜单中选择**生成JavaDoc**，并在出现的对话框中定义**输出目录**字段的路径，您只需要点击**确定**按钮，所有文档都将被生成为HTML文件。结果将显示在您的浏览器中，如下所示：
- en: '![There''s more...](img/B04299_10_05.jpg)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![更多内容...](img/B04299_10_05.jpg)'
- en: Note
  id: totrans-86
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**Android Studio tip**'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '**Android Studio提示**'
- en: 'Do you often need to return to a particular place in your code? Create a bookmark
    with the *Cmd* + *F3* (for Windows: *F11*) shortcut.'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 您经常需要返回到代码中的特定位置吗？使用*Cmd* + *F3*（对于Windows：*F11*）快捷键创建书签。
- en: 'To display a list of bookmarks and to choose from them, use the shortcut *Cmd*
    + *F3* (for Windows: *Shift* + *F11*).'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 要显示书签列表并从中选择，请使用快捷键*Cmd* + *F3*（对于Windows：*Shift* + *F11*）。
- en: Runtime permissions
  id: totrans-90
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 运行时权限
- en: The number of different types of devices that your app will target depends on
    the feature requirements (which needs permissions) and the markets at which you
    are targeting (by explicitly selecting specific countries or by offering your
    app in specific languages).
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 您的应用程序将针对不同类型的设备取决于功能要求（需要权限）和您所针对的市场（通过明确选择特定国家或提供特定语言的应用程序）的数量。
- en: If, for example, your app requires both a front and a back camera, you will
    be targeting a smaller number of devices, as would be the case if you just require
    a back camera.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果您的应用程序需要前置摄像头和后置摄像头，那么您将针对较少数量的设备，就像您只需要后置摄像头一样。
- en: Usually when installing an app, the user is asked to accept (or decline) all
    the required permissions, as it has been defined in the `AndroidManifest` file
    of an app.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，在安装应用程序时，用户会被要求接受（或拒绝）所有所需的权限，就像在应用程序的`AndroidManifest`文件中定义的那样。
- en: With the introduction of Android 6 (Marshmallow), the way a user is asked for
    particular permissions has changed. Only if a certain type of permission is required,
    the user will be prompted so that he can allow or deny that permission.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 随着Android 6（Marshmallow）的推出，用户被要求特定权限的方式发生了变化。只有在需要某种类型的权限时，用户才会被提示，以便他可以允许或拒绝该权限。
- en: With that, there is an opportunity for the app to explain why this permission
    is needed. After this, the whole thing makes much more sense to the user. These
    so-called runtime permissions require a somewhat different development approach.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 有了这个机会，应用程序可以解释为什么需要这个权限。之后，整个过程对用户来说就更有意义了。这些所谓的运行时权限需要一种稍微不同的开发方法。
- en: For this recipe, we will modify the previous app that sends SMSs. Now we need
    to ask the user's permission once he hits the button in order to send an SMS.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个示例，我们将修改之前发送短信的应用程序。现在，我们需要在用户点击按钮后请求用户的权限，以便发送短信。
- en: Getting ready
  id: totrans-97
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: To test runtime permissions, you need to have a device running on Android 6.0
    or higher or you need to have a virtual device running on Android Marshmallow
    or higher.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 要测试运行时权限，您需要有一个运行Android 6.0或更高版本的设备，或者您需要有一个运行Android Marshmallow或更高版本的虚拟设备。
- en: Also, make sure that you have downloaded the Android 6.x SDK (API Level 23 or
    above).
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 还要确保您已经下载了Android 6.x SDK（API级别23或更高）。
- en: How to do it...
  id: totrans-100
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 操作步骤...
- en: 'So, how do these runtime permissions look and how do we handle them? This can
    be checked with the help of the following steps:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，这些运行时权限是什么样的，我们如何处理它们？可以通过以下步骤来检查：
- en: Open the project from the previous recipe.
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从上一个示例中打开项目。
- en: 'Open the `AndroidManifest` file and add the permission (according to the new
    model) to send SMS messages:'
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开`AndroidManifest`文件，并添加权限（根据新模型）以发送短信：
- en: '[PRE12]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Open the `build.gradle` file in the `app` folder and set the value for `compileSdkVersion`
    to the latest available version. Also, change the values for each `minSdkVersion`
    and `targetSdkVersion` to `23` or above.
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`app`文件夹中打开`build.gradle`文件，并将`compileSdkVersion`的值设置为最新可用版本。还要将每个`minSdkVersion`和`targetSdkVersion`的值更改为`23`或更高。
- en: 'Modify the `onClick` method:'
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修改`onClick`方法：
- en: '[PRE13]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Add a constant value so that later we will know to which permission request
    the permission result is referring to:'
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加一个常量值，以便以后我们将知道权限请求的权限结果是指哪个权限请求：
- en: '[PRE14]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Implement the `sendSms` method. We will use the `SmsManager` method to send
    the `Y-E-A-H` text to the phone number that the user has entered. Once the message
    has been sent, a toast will be displayed:'
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 实现`sendSms`方法。我们将使用`SmsManager`方法将`Y-E-A-H`文本发送到用户输入的电话号码。一旦消息发送成功，将显示一个toast：
- en: '[PRE15]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Finally, implement the `onRequestPermissionsResult` method. If the granted
    permission is the permission for an SMS, then call the `sendSms` method. If the
    permission is denied, a toast will be displayed and the **send** button and the
    edit text to enter the phone number will be disabled:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，实现`onRequestPermissionsResult`方法。如果授予的权限是短信权限，则调用`sendSms`方法。如果权限被拒绝，则会显示一个toast，并且**发送**按钮和输入电话号码的编辑文本将被禁用：
- en: '[PRE16]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Run your app. Use a device running on Android 6.0 or higher or create a virtual
    device that runs on the API level 23 or above.
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行您的应用程序。使用运行Android 6.0或更高版本的设备，或者创建一个运行API级别23或更高版本的虚拟设备。
- en: Now the permission to send the SMS will not be asked upfront (that is, if the
    user installs the application). Instead, a dialog asking for permission pops up
    as soon as you hit the **Send** button.
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，发送短信的权限不会被事先要求（也就是说，如果用户安装了应用程序）。相反，一旦您点击**发送**按钮，就会弹出一个请求权限的对话框。
- en: If you agree with the request permission, the SMS message will be sent. If you
    deny the requested permission, the edit box and the button will be disabled and
    a toast will be displayed to provide feedback:![How to do it...](img/B04299_10_06.jpg)
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您同意请求权限，短信将被发送。如果您拒绝了请求的权限，编辑框和按钮将被禁用，并且将显示一个toast以提供反馈：![操作步骤...](img/B04299_10_06.jpg)
- en: This recipe has demonstrated the basic idea of runtime permissions.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 这个示例演示了运行时权限的基本概念。
- en: There's more...
  id: totrans-118
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多内容...
- en: To see how and when to ask for permission, or how and when to provide feedback
    about particular features that are not available, you can check the Google guidelines
    at [https://www.google.com/design/spec/patterns/permissions.html](https://www.google.com/design/spec/patterns/permissions.html).
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解何时以及如何请求权限，或者何时以及如何提供有关不可用特定功能的反馈意见，您可以在[https://www.google.com/design/spec/patterns/permissions.html](https://www.google.com/design/spec/patterns/permissions.html)上查看Google的指南。
- en: Note
  id: totrans-120
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**Android Studio tip**'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: '**Android Studio提示**'
- en: 'You can easily extract code from a method that has become too large. Just mark
    the code that you want to move and use the shortcut *Cmd* + *Alt* + *M* (for Windows:
    *Ctrl* + *Alt* + *M*).'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以轻松地从变得太大的方法中提取代码。只需标记您想要移动的代码，然后使用快捷键*Cmd* + *Alt* + *M*（对于Windows：*Ctrl*
    + *Alt* + *M*）。
- en: Play Store beta distribution
  id: totrans-123
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Play商店beta分发
- en: All right, we are going to upload our app to the Play Store as a beta distribution.
    Exciting, isn't it?
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 好了，我们将把我们的应用程序上传到Play商店作为beta分发。很激动人心，不是吗？
- en: Getting ready
  id: totrans-125
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: For this recipe, we will be using the app from the first recipe; although, any
    app that you consider to be ready for the beta launch will do.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个食谱，我们将使用第一个食谱中的应用程序；尽管如此，任何您认为已准备好进行beta发布的应用程序都可以。
- en: Make sure you do have some artwork for it as well, such as icons and screenshots.
    Don't worry, for this recipe, you can download these items as well from <[www.packtpub.com](http://www.packtpub.com)>.
    Also, think about your app's metadata, such as title, description, and category.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 确保您也有一些艺术作品，例如图标和截图。别担心，对于这个食谱，您也可以从<[www.packtpub.com](http://www.packtpub.com)>下载这些项目。此外，考虑您应用程序的元数据，例如标题、描述和类别。
- en: Most important is that you do have a developers account and that you do have
    access to the Google Play Developer console. If you do not have an account, you
    need to register first via [http://developer.android.com/distribute/googleplay/start.html](http://developer.android.com/distribute/googleplay/start.html).
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 最重要的是您必须拥有开发者帐户，并且可以访问Google Play开发者控制台。如果您没有帐户，您需要首先通过[http://developer.android.com/distribute/googleplay/start.html](http://developer.android.com/distribute/googleplay/start.html)注册。
- en: How to do it...
  id: totrans-129
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Getting your app into the Play Store is not so hard. It just takes some time
    to set up things the right way:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 将您的应用程序放入Play商店并不难。只是需要一些时间来正确设置事物：
- en: Sign in to your **Google Play Developer Console** webpage or register first
    if you need to.
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到您的**Google Play开发者控制台**网页，或者如果需要的话，首先注册。
- en: On the dashboard, click on the **Add new application** button.
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在仪表板上，点击**添加新应用程序**按钮。
- en: In the dialog, enter the **Title** of the application `Blue Messenger` and click
    on the **Upload now APK** button.
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在对话框中，输入应用程序的**标题**“蓝色信使”，然后点击**立即上传APK**按钮。
- en: You will notice the **production**, **beta**, and **alpha** tabs. Ideally, you
    start with alpha testing, but for demonstration purposes, we will choose the **beta**
    tab right away. On that, the **Upload your first APK to beta** button is shown.
    Click on that button.
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您会注意到**production**、**beta**和**alpha**选项卡。理想情况下，您应该从alpha测试开始，但出于演示目的，我们将立即选择**beta**选项卡。在那里，将显示**将第一个APK上传到beta**按钮。点击该按钮。
- en: In Android Studio, open the app that we created for the first (or second) recipe
    and from the **Build** menu, choose the **Generate signed APK** option.
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Android Studio中，打开我们为第一个（或第二个）食谱创建的应用程序，然后从**构建**菜单中选择**生成已签名的APK**选项。
- en: Select the `app` module and click on the **Next** button.
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择`app`模块，然后点击**下一步**按钮。
- en: Enter the **path** to your key store. If you do have one, click on the **Create
    new…** button and find a good place for your key store file (with the `.jks` extension).
    Enter a **password** for it, repeat the password, and enter a suitable value for
    **First and last name**. Then, click on the **OK** button.
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入**密钥库的路径**。如果没有，请点击**创建新...**按钮，找到一个适合您的密钥库文件（带有`.jks`扩展名）的好地方。为其输入一个**密码**，重复密码，并输入**名字**的合适值。然后，点击**确定**按钮。
- en: Enter the **key store password**, create a new **key alias**, and name it `whitelabelmessenger`.
    Enter a **password** for the key and click on the **Next** button.
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入**密钥库密码**，创建一个新的**密钥别名**，并将其命名为“whitelabelmessenger”。为密钥输入一个**密码**，然后点击**下一步**按钮。
- en: Enter the **master password** if needed and click on the **OK** button.
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果需要，输入**主密码**，然后点击**确定**按钮。
- en: Modify the **destination path** if you wish and then select a **build type**
    and **flavor**. Choose **release** and **blueFlavor** and then click on the **OK**
    button.
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果需要，修改**目标路径**，然后选择**构建类型**和**风味**。选择**发布**和**blueFlavor**，然后点击**确定**按钮。
- en: A new dialog informs us that a new-signed APK has been created successfully
    if everything goes well. Click on the **Reveal in Finder** (or find it using Windows
    Explorer in case you are using Windows) button to see the APK file that has just
    been created.
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一个新的对话框通知我们，如果一切顺利，已成功创建了一个新的已签名APK。点击**在Finder中显示**（或者在Windows中使用Windows资源管理器找到）按钮，以查看刚刚创建的APK文件。
- en: In your browser, upload this APK file. Once the APK file has been uploaded,
    the version is displayed on the **beta** tab; you can pick a testing method and
    you see the number of supported devices, which will depend on the API level you
    have chosen and the required feature that comes with the SMS permission (which
    will exclude many tablets right away for example).
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在浏览器中上传此APK文件。一旦APK文件上传完成，版本将显示在**beta**选项卡上；您可以选择测试方法并查看受支持设备的数量，这将取决于您选择的API级别以及带有短信权限的必需功能（例如，这将立即排除许多平板电脑）。
- en: For the testing method, click on the **Setup closed beta testing** button.
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于测试方法，点击**设置封闭式beta测试**按钮。
- en: Create a list by clicking on the **Create a list** button. Give the list a name,
    for example, **Internal testing** and add the e-mail addresses of the testers
    (or just for practicing purpose, enter your own). When you are done, click on
    the **Save** button.
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建列表**按钮创建一个列表。给列表取一个名字，例如**内部测试**，然后添加测试人员的电子邮件地址（或者只是为了练习，输入您自己的）。完成后，点击**保存**按钮。
- en: Enter your own e-mail address as **Feedback channel** and click on the **Save
    draft** button.
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将您自己的电子邮件地址输入为**反馈渠道**，然后点击**保存草稿**按钮。
- en: Although we are not publishing anything on the store yet, you need to enter
    some values for the **Store listing** section, which is an option that you can
    select from the menu on the left-hand side of the webpage:![How to do it...](img/B04299_10_07.jpg)
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 尽管我们尚未在商店上发布任何内容，但您需要为**商店列表**部分输入一些值，这是您可以从网页左侧的菜单中选择的选项：![如何做…](img/B04299_10_07.jpg)
- en: Enter title, short, and long description. Also, add two screenshots, a high-resolution
    icon and a feature graphic image. You can download these resources from <[www.packtpub.com](http://www.packtpub.com)>
    or you can create them yourself by capturing screenshots from your app and have
    some fun with some kind of a paint program to give them the right widths and heights.
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入标题、简短和长描述。还要添加两张截图、一个高分辨率图标和一个特色图像。您可以从<[www.packtpub.com](http://www.packtpub.com)>下载这些资源，或者您可以通过从您的应用中截取截图并使用某种绘图程序进行一些有趣的操作，以使它们具有正确的宽度和高度。
- en: At **categorization**, choose **applications** as the **application type** and
    **Social** or **Communication** as the **category**.
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**分类**中，选择**应用程序**作为**应用程序类型**，并选择**社交**或**通讯**作为**类别**。
- en: Enter your **contact details** and select **Not submitting a privacy policy
    at this time** (unless you do want to do so, of course).
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入您的**联系方式**，并选择**目前不提交隐私政策**（除非您确实希望这样做）。
- en: Click on the **Save draft** button and continue with the **Content Rating**
    section by choosing this option from the menu on the left-hand side of the screen.
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**保存草稿**按钮，然后从屏幕左侧的菜单中选择**内容评级**部分，继续进行。
- en: Rate your app
  id: totrans-151
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 为您的应用评分
- en: 'Click on the **Continue** button, enter your **e-mail address**, and answer
    the questions about whether your app has any violent, sexual, or other potential
    dangerous content or features. Finally, click on the **Save Questionnaire** button:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**继续**按钮，输入您的**电子邮件地址**，并回答有关您的应用是否具有任何暴力、色情或其他潜在危险内容或功能的问题。最后，点击**保存问卷**按钮：
- en: You may now click on the **Calculate Rating** button. Your rating will be displayed
    after that. Click on the **Apply Rating** button and you are done.
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，您可以点击**计算评级**按钮。之后将显示您的评级。点击**应用评级**按钮，然后您就完成了。
- en: The next section is **Pricing and Distribution**. Pick this option from the
    **menu** on the left-hand side of the page.
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来是**定价和分发**部分。从页面左侧的菜单中选择此选项。
- en: Make it a free app by clicking on the **Free** button and **choose to select
    all countries** (or specify specific countries if you wish). After that, click
    on the **Save Draft** button.
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过点击**免费**按钮，使其成为免费应用，并**选择所有国家**（或者如果您愿意，可以指定特定国家）。之后，点击**保存草稿**按钮。
- en: By now, the **Publish app** button should be enabled. Click on it. If it is
    not enabled, you can click on the **I can't publish?** link to find out what information
    is missing.
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 到目前为止，**发布应用**按钮应该已经启用。点击它。如果它没有启用，您可以点击**我无法发布？**链接，找出缺少哪些信息。
- en: Here, the term "publishing" is a bit confusing. It actually means, in this context,
    that the app will be published for the test users that are on the list that you
    just created. Do not worry. Until you promote the app to production, nothing will
    be available at the Play Store, although the term "publishing" seems to suggest
    this.
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这里，“发布”这个词有点令人困惑。实际上，在这种情况下，它意味着该应用将被发布给您刚刚创建的测试用户名单上的用户。不用担心。在您将应用程序推广到生产环境之前，Play商店中将不会有任何内容，尽管“发布”这个词似乎暗示了这一点。
- en: While your app status says **Pending publication**, you can investigate some
    other options such as the list of devices your app is supporting, the required
    features, and permissions and options for analytical purposes, including features
    split testing (A/B tests).
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当您的应用状态显示为**待发布**时，您可以调查一些其他选项，比如您的应用支持的设备列表、所需功能和权限以及用于分析目的的选项，包括功能分割测试（A/B测试）。
- en: Have a break
  id: totrans-159
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 休息一下
- en: The **Pending publication** status may take a couple of hours (or perhaps even
    longer) as recently (since April 2015) Google announced that it will be reviewing
    the apps upfront (in a half-manual-half-automated way) even for alpha and beta
    distributions.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '**待发布**状态可能需要几个小时（甚至更长时间），因为自2015年4月以来，谷歌宣布将事先审查应用程序（以半手动半自动的方式），即使是alpha和beta版本的分发也是如此。'
- en: Eat a marshmallow or have some coffee or have a walk in the park. Return within
    a couple of hours to check whether your app's status has changed to **Published**.
    It may take some time, but it will.
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 吃一个棉花糖，喝点咖啡，或者在公园里散散步。几个小时后回来检查您的应用状态是否已更改为**已发布**。可能需要一些时间，但会成功的。
- en: Note
  id: totrans-162
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Your testers might need to change their (security) settings to **allow to install
    apps outside of Google Play Store**.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 您的测试人员可能需要更改其（安全）设置，以**允许在Google Play商店之外安装应用程序**。
- en: There are some other things that look confusing. Behind the package name, there
    will be a link that reads **View in Play Store…** and a hint saying that alpha
    and beta apps are not listed in the Play Store.
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 还有一些其他看起来令人困惑的事情。在包名称后面，会有一个链接，上面写着**在Play商店中查看…**，还有一个提示说alpha和beta应用程序不会在Play商店中列出。
- en: Click on the **APK** item in the menu on the left-hand side of the webpage.
    By following the link, you will find **Opt In Url** on the **Beta** tab that your
    test users can download and use to install the beta app:![Have a break](img/B04299_10_08.jpg)
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在网页左侧的菜单中点击**APK**项目。通过链接，您将在**Beta**选项卡上找到**Opt In Url**，您的测试用户可以通过该链接下载并安装beta应用程序：![休息一下](img/B04299_10_08.jpg)
- en: Huge! Your first beta distribution is ready to be tested. You might need multiple
    iterations to get things right or maybe just one beta version will turn out to
    be sufficient to find out that your app is ready for the **Play Store**.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 太棒了！您的第一个beta分发已经准备好进行测试。您可能需要多次迭代才能做到完美，或者也许只需要一个beta版本就足以发现您的应用已经准备好进入**Play商店**。
- en: To release your app on the Play Store, click on the **Promote to Prod** button,
    if you dare…
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 要在Play商店上发布你的应用，点击**推广到生产**按钮，如果你敢的话…
- en: And with that, this book ends. There is so much more to tell and to learn about
    Android development, such as services, Android Pay, **Near Field Communication**
    (**NFC**), and Bluetooth to name just a few; however, by reading this book, you
    have seen most of the elements of the Android Studio IDE and that was what we
    were aiming at.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 就到这里吧。还有很多关于Android开发的东西要讲和学习，比如服务、Android Pay、**近场通讯**（NFC）和蓝牙等等；然而，通过阅读这本书，你已经看到了Android
    Studio IDE的大部分元素，这也是我们的目标。
- en: So this is it for now. Thank you for reading, and happy coding!
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 就是这样了。谢谢你的阅读，祝你编码愉快！
- en: There's more...
  id: totrans-170
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多…
- en: You should be aware of the fact that besides technology, methodology will be
    just as important. It is hard to develop an app that is not only technically perfect
    but also has a lot of users who are so happy with your app and its flow, usability,
    and appearance that they all give you the five stars that you deserve.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该意识到，除了技术，方法论同样重要。开发一个不仅在技术上完美，而且有很多用户对你的应用和其流程、可用性和外观都非常满意，给你应得的五星评价的应用是很难的。
- en: I assume you do not want to develop an app for months or for years only to find
    out later that actually nobody cares about it. To find out at an early stage what
    makes people really want to use your app, you should consider the lean start-up
    methodology for your app development.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 我假设你不想花几个月甚至几年的时间开发一个应用，最后发现其实没有人在乎。在早期阶段找出是什么让人们真正想使用你的应用，你应该考虑精益创业方法论来开发你的应用。
- en: '**Build – Measure – Learn**'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: '**构建-测量-学习**'
- en: The **lean start-up** methodology is a method to develop businesses and products
    (or services). The idea is that experiments based on hypotheses, validated learning,
    and iterative product releases lead to shorter product development cycles.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '**精益创业**方法论是一种开发企业和产品（或服务）的方法。其理念是基于假设的实验、验证学习和迭代产品发布会导致更短的产品开发周期。'
- en: 'Most important key elements of the lean start-up methodology are:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 精益创业方法论的最重要的关键元素是：
- en: '**Minimum viable product** (**MVP**)'
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最小可行产品**（MVP）'
- en: Split testing and actionable metrics
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分割测试和可操作指标
- en: Continuous deployment
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 持续部署
- en: In short, a MVP is a version of a product that takes minimal effort to test
    particular ypotheses.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 简而言之，MVP是产品的一个版本，需要最小的努力来测试特定的假设。
- en: To learn more about the Lean start-up methodologies, check out the website [http://theleanstartup.com](http://theleanstartup.com),
    read Eric Ries' book, or find a lean start-up event near you from [http://www.leanstartupcircle.com](http://www.leanstartupcircle.com).
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于精益创业方法论的信息，可以查看网站[http://theleanstartup.com](http://theleanstartup.com)，阅读Eric
    Ries的书，或者从[http://www.leanstartupcircle.com](http://www.leanstartupcircle.com)找到一个靠近你的精益创业活动。
- en: The **Play Store developer console** provides options for split testing and
    to measure how your app is being used. Google analytics can help you to do this
    as it is the easiest way to get actionable metrics, which you will need to gather
    for feedback in order to improve your app by learning from it.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: '**Play商店开发者控制台**提供了分割测试和测量应用程序使用情况的选项。谷歌分析可以帮助你做到这一点，因为这是获得可操作指标的最简单方法，你需要收集这些指标以便通过学习改进你的应用程序。'
- en: '**Continuous** **deployment** nicely fits into the Lean Start-up methodology.
    It can improve the quality and speed of your app development.'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: '**持续部署**很好地融入了精益创业方法论。它可以提高应用程序开发的质量和速度。'
- en: You might wonder what continuous deployment is about. It takes another book
    to fully explain the concept, but here is a short introduction to continuous integration
    and continuous delivery, which, if combined, is what continuous deployment is
    about.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能会想知道持续部署是什么。完全解释这个概念需要另一本书，但这里是对持续集成和持续交付的简要介绍，如果结合起来，就是持续部署的内容。
- en: '**Continuous integration** (**CI**) is the process where developers commit
    their changes and merge results to a source code repository. A build server observes
    the code repository for changes, pulling and compiling code. The server also runs
    automated tests.'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: '**持续集成**（CI）是开发人员提交他们的更改并将结果合并到源代码存储库的过程。构建服务器观察代码存储库的更改，拉取和编译代码。服务器还运行自动化测试。'
- en: '**Continuous delivery** is the process of creating deployable versions of your
    app automatically, for example, by publishing an alpha or beta app in the Play
    Store. For this reason, it is important that the submitted and validated code
    will be in an always-deployable state.'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: '**持续交付**是自动创建可部署版本的过程，例如，通过在Play商店发布alpha或beta应用。因此，提交和验证的代码始终处于可部署状态是很重要的。'
- en: Setting up continuous deployment will take some upfront, but in the end, it
    will result in smaller and faster development cycles.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 设置持续部署需要一些前期工作，但最终会导致更小更快的开发周期。
- en: For a continuous deployment of your Android app, both `Jenkins` and `TeamCity`
    will be suitable. `Teamcity` is recommended most often and does integrate with
    Android Studio using a plugin.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 对于Android应用程序的持续部署，`Jenkins`和`TeamCity`都是合适的。`Teamcity`经常被推荐，并且使用插件可以与Android
    Studio集成。
- en: To learn how to set up a `TeamCity` server or to find any further information,
    you can check the website of Packt Publishing that offers some great books that
    explain the concept of continuous integration and `TeamCity` in particular.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解如何设置`TeamCity`服务器或找到更多信息，你可以查看Packt Publishing的网站，那里有一些很好的书来解释持续集成和`TeamCity`的概念。
