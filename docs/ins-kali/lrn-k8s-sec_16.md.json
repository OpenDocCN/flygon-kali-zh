["```\nkubectl cp /tmp/test <pod>:/tmp/bar\n```", "```\nkubectl cp <some-pod>:/tmp/foo /tmp/bar\n```", "```\n    $ curl https://storage.googleapis.com/kubernetes-release/release/stable.txt\n    v1.18.3\n    ```", "```\n    deny[reason] {\n    \u00a0\u00a0input.request.kind.kind == \"PodExecOptions\"\n    \u00a0\u00a0input.request.resource.resource == \"pods\"\n    \u00a0\u00a0input.request.subResource == \"exec\"\n    \u00a0\u00a0input.request.object.command[0] == \"tar\"\n    \u00a0\u00a0reason = sprintf(\"kubectl cp was detected on %v/%v by user: %v\", [\n    \u00a0\u00a0\u00a0\u00a0input.request.namespace,\n    \u00a0\u00a0\u00a0\u00a0input.request.object.container,\n    \u00a0\u00a0\u00a0\u00a0input.request.userInfo.username])\n    }\n    ```", "```\n    spec:\n    \u00a0\u00a0\u00a0\u00a0securityContext:\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0readOnlyRootFilesystem: true\n    ```", "```\n    - rule: Write below monitored dir\n    \u00a0\u00a0desc: an attempt to write to any file below a set of binary directories\n    \u00a0\u00a0condition: >\n    \u00a0\u00a0\u00a0\u00a0evt.dir = < and open_write and monitored_dir\n    \u00a0\u00a0\u00a0\u00a0and not package_mgmt_procs\n    \u00a0\u00a0\u00a0\u00a0and not coreos_write_ssh_dir\n    \u00a0\u00a0\u00a0\u00a0and not exe_running_docker_save\n    \u00a0\u00a0\u00a0\u00a0and not python_running_get_pip\n    \u00a0\u00a0\u00a0\u00a0and not python_running_ms_oms\n    \u00a0\u00a0\u00a0\u00a0and not google_accounts_daemon_writing_ssh\n    \u00a0\u00a0\u00a0\u00a0and not cloud_init_writing_ssh\n    \u00a0\u00a0\u00a0\u00a0and not user_known_write_monitored_dir_conditions\n    \u00a0\u00a0output: >\n    \u00a0\u00a0\u00a0\u00a0File below a monitored directory opened for writing (user=%user.name\n    \u00a0\u00a0\u00a0\u00a0command=%proc.cmdline file=%fd.name parent=%proc.pname pcmdline=%proc.pcmdline gparent=%proc.aname[2] container_id=%container.id image=%container.image.repository)\n    \u00a0\u00a0priority: ERROR\n    \u00a0\u00a0tags: [filesystem, mitre_persistence]\n    ```", "```\n    - macro: safe_kubectl_version\n    \u00a0\u00a0condition: (jevt.value[/userAgent] startswith \"kubectl/v1.15\" or\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0jevt.value[/userAgent] startswith \"kubectl/v1.14.3\" or\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0jevt.value[/userAgent] startswith \"kubectl/v1.14.2\" or\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0jevt.value[/userAgent] startswith \"kubectl/v1.13.7\" or\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0jevt.value[/userAgent] startswith \"kubectl/v1.13.6\" or\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0jevt.value[/userAgent] startswith \"kubectl/v1.12.9\")\n    # CVE-2019-1002101\n    # Run kubectl version --client and if it does not say client version 1.12.9,\n    1.13.6, or 1.14.2 or newer,\u00a0\u00a0you are running a vulnerable version.\n    - rule: K8s Vulnerable Kubectl Copy\n    \u00a0\u00a0desc: Detect any attempt vulnerable kubectl copy in pod\n    \u00a0\u00a0condition: kevt_started and pod_subresource and kcreate and\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0ka.target.subresource = \"exec\" and ka.uri.param[command] = \"tar\" and\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0not safe_kubectl_version\n    \u00a0\u00a0output: Vulnerable kubectl copy detected (user=%ka.user.name pod=%ka.target.name ns=%ka.target.namespace action=%ka.target.subresource command=%ka.uri.param[command] userAgent=%jevt.value[/userAgent])\n    \u00a0\u00a0priority: WARNING\n    \u00a0\u00a0source: k8s_audit\n    \u00a0\u00a0tags: [k8s]\n    ```", "```\nspec:\n\u00a0\u00a0template:\n\u00a0\u00a0\u00a0\u00a0spec:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0containers:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0- name: db\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0image: redis\n```", "```\n    container_memory_max_usage_bytes{pod_ name=\"kube-apiserver-xxx\" }\n    sum(rate(container_cpu_usage_seconds_total{pod_name=\"kube-apiserver-xxx\"}[5m]))\n    sum(rate(container_network_receive_bytes_total{pod_name=\"kube-apiserver-xxx\"}[5m]))\n    ```", "```\n    kops create cluster k8s-clusters.k8s-demo-zone.com \\\n    \u00a0\u00a0--cloud aws \\\n    \u00a0\u00a0--node-count 3 \\\n    \u00a0\u00a0--zones $ZONES \\\n    \u00a0\u00a0--node-size $NODE_SIZE \\\n    \u00a0\u00a0--master-size $MASTER_SIZE \\\n    \u00a0\u00a0--master-zones $ZONES \\\n    \u00a0\u00a0--networking calico \\\n    \u00a0\u00a0--kubernetes-version 1.14.3 \\\n    \u00a0\u00a0--yes \\\n    kube-apiserver-ip-172-20-43-65.ec2.internal\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a01/1\u00a0\u00a0\u00a0\u00a0\u00a0Running\u00a0\u00a0\u00a04\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a04h16m\n    kube-apiserver-ip-172-20-67-151.ec2.internal\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a01/1\u00a0\u00a0\u00a0\u00a0\u00a0Running\u00a0\u00a0\u00a04\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a04h15m\n    ```", "```\n    kubectl auth reconcile -f rbac.yaml --remove-extra-subjects --remove-extra-permissions\n    kubectl annotate --overwrite clusterrolebinding/system:basic-user rbac.authorization.kubernetes.io/autoupdate=false \n    ```", "```\n    \u00a0\u00a0apiVersion: audit.k8s.io/v1 # This is required.\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0kind: Policy\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0rules:\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0- level: RequestResponse\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0verbs: [\"patch\", \"update\", \"delete\"]\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0resources:\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0- group: \"\"\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0resources: [\"pods\"]\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0namespaces: [\"kube-system\", \"monitoring\"]\n    ```", "```\n    $git clone https://github.com/aquasecurity/kube-hunter\n    ```", "```\n    $ ./kubectl create -f job.yaml\n    ```", "```\n    $ ./kubectl get pods\n    NAME\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0READY\u00a0\u00a0\u00a0STATUS\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0RESTARTS\u00a0\u00a0\u00a0AGE\n    kube-hunter-7hsfc\u00a0\u00a0\u00a00/1\u00a0\u00a0\u00a0\u00a0\u00a0ContainerCreating\u00a0\u00a0\u00a00\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a012s\n    ```"]