- en: '9'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '9'
- en: Time-Series Models for Volatility Forecasts and Statistical Arbitrage
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用于波动率预测和统计套利的时间序列模型
- en: In *Chapter 7*, *Linear Models – From Risk Factors to Asset Return Forecasts*,
    we introduced linear models for inference and prediction, starting with static
    models for a contemporaneous relationship with cross-sectional inputs that have
    an immediate effect on the output. We presented the **ordinary least squares**
    (**OLS**) learning algorithm, and saw that it produces unbiased coefficients for
    a correctly specified model with residuals that are not correlated with the input
    variables. Adding the assumption that the residuals have constant variance guarantees
    that OLS produces the smallest mean squared prediction error among unbiased estimators.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在*第7章*，*线性模型-从风险因素到资产回报预测*中，我们介绍了用于推断和预测的线性模型，从具有立即影响输出的横截面输入的静态模型开始。我们介绍了**普通最小二乘法**（**OLS**）学习算法，并且发现它对于具有未与输入变量相关的残差的正确规范化模型产生无偏系数。添加残差具有恒定方差的假设可以保证OLS在无偏估计器中产生最小的均方预测误差。
- en: We also encountered panel data that had both cross-sectional and time-series
    dimensions, when we learned how the Fama-Macbeth regressions estimate the value
    of risk factors over time and across assets. However, the relationship between
    returns across time is typically fairly low, so this procedure could largely ignore
    the time dimension.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们学习Fama-Macbeth回归如何估计随时间和跨资产的风险因素的价值时，我们还遇到了既有横截面又有时间序列维度的面板数据。然而，随时间的回报之间的关系通常相当低，因此这个过程可能会大部分忽略时间维度。
- en: Furthermore, we covered the regularized ridge and lasso regression models, which
    produce biased coefficient estimates but can reduce the mean squared prediction
    error. These predictive models took a more dynamic perspective and combined historical
    returns with other inputs to predict forward returns.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，我们还介绍了正则化的岭回归和套索回归模型，这些模型产生有偏系数估计，但可以减少均方预测误差。这些预测模型采用了更加动态的视角，将历史回报与其他输入结合起来，以预测未来回报。
- en: 'In this chapter, we will build dynamic linear models to explicitly represent
    time and include variables observed at specific intervals or lags. A key characteristic
    of time-series data is their sequential order: rather than random samples of individual
    observations, as in the case of cross-sectional data, our data is a single realization
    of a stochastic process that we cannot repeat.'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将构建动态线性模型，明确表示时间并包括在特定间隔或滞后观察到的变量。时间序列数据的一个关键特征是它们的顺序：与横截面数据的情况不同，我们的数据不是单个观察值的随机样本，而是我们无法重复的随机过程的单个实现。
- en: Our goal is to identify systematic patterns in time series that help us predict
    how the time series will behave in the future. More specifically, we will focus
    on models that extract signals from a historical sequence of the output and, optionally,
    other contemporaneous or lagged input variables to predict future values of the
    output. For example, we might try to predict future returns for a stock using
    past returns, combined with historical returns of a benchmark or macroeconomic
    variables. We will focus on linear time-series models before turning to nonlinear models
    like recurrent or convolutional neural networks in Part 4.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的目标是识别时间序列中的系统模式，帮助我们预测时间序列在未来的行为。更具体地，我们将专注于从输出的历史序列中提取信号的模型，并且可以选择性地使用其他同时发生或滞后的输入变量来预测输出的未来值。例如，我们可以尝试使用过去的回报以及基准或宏观经济变量的历史回报来预测股票的未来回报。在转向第4部分的非线性模型之前，我们将专注于线性时间序列模型。
- en: Time-series models are very popular given the time dimension inherent to trading.
    Key applications include the prediction of asset returns and volatility, as well
    as the identification of the co-movements of asset price series. Time-series data
    is likely to become more prevalent as an ever-broader array of connected devices
    collects regular measurements with potential signal content.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列模型非常受欢迎，因为交易中固有的时间维度。关键应用包括预测资产回报和波动性，以及识别资产价格序列的共同运动。随着越来越广泛的连接设备收集具有潜在信号内容的定期测量，时间序列数据可能会变得更加普遍。
- en: We will first introduce the tools we can use to diagnose time-series characteristics
    and to extract features that capture potential patterns. Then, we will cover how
    to diagnose and achieve time-series stationarity. Next, we will introduce univariate
    and multivariate time-series models and apply them in order to forecast macro
    data and volatility patterns. We will conclude with the concept of cointegration
    and how to apply it to develop a pairs trading strategy.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将首先介绍我们可以用来诊断时间序列特征并提取捕捉潜在模式的特征的工具。然后，我们将介绍如何诊断和实现时间序列的平稳性。接下来，我们将介绍单变量和多变量时间序列模型，并应用它们来预测宏观数据和波动性模式。最后，我们将介绍协整概念以及如何应用它来开发配对交易策略。
- en: 'In particular, we will cover the following topics:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 特别是，我们将涵盖以下主题：
- en: How to use time-series analysis to prepare and inform the modeling process
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何使用时间序列分析来准备和指导建模过程
- en: Estimating and diagnosing univariate autoregressive and moving-average models
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 估计和诊断单变量自回归和移动平均模型
- en: Building **autoregressive conditional heteroskedasticity** (**ARCH**) models
    to predict volatility
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建**自回归条件异方差**（**ARCH**）模型来预测波动性
- en: How to build multivariate vector autoregressive models
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何构建多变量向量自回归模型
- en: Using cointegration to develop a pairs trading strategy
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用协整来开发配对交易策略
- en: You can find the code samples for this chapter and links to additional resources
    in the corresponding directory of the GitHub repository. The notebooks include
    color versions of the images. For a thorough introduction to the topics of this
    chapter from an investment perspective, see Tsay (2005) and Fabozzi, Focardi,
    and Kolm (2010).
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在GitHub存储库的相应目录中找到本章的代码示例和其他资源的链接。笔记本包括图像的彩色版本。有关从投资角度对本章主题的全面介绍，请参阅Tsay（2005）和Fabozzi，Focardi和Kolm（2010）。
- en: Tools for diagnostics and feature extraction
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 诊断和特征提取工具
- en: A time series is a sequence of values separated by discrete intervals that are
    typically even spaced (except for missing values). A time series is often modeled
    as a stochastic process consisting of a collection of random variables, ![](img/B15439_09_001.png),
    with one variable for each point in time, ![](img/B15439_09_002.png). A univariate
    time series consists of a single value, *y*, at each point in time, whereas a
    multivariate time series consists of several observations that can be represented
    by a vector.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列是一系列值，这些值由离散间隔分隔，通常是均匀间隔的（除了缺失值）。时间序列通常被建模为由一组随机变量![](img/B15439_09_001.png)组成的随机过程，每个时间点![](img/B15439_09_002.png)有一个变量。单变量时间序列由每个时间点的单个值*y*组成，而多变量时间序列由几个观测值组成，可以用向量表示。
- en: The number of periods, ![](img/B15439_09_003.png), between distinct points in
    time, *t*[i], *t*[j], is called **lag**, with *T*-1 distinct lags for each time
    series. Just as relationships between different variables at a given point in
    time is key for cross-sectional models, relationships between data points separated
    by a given lag are fundamental to analyzing and exploiting patterns in time series.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列中不同时间点*t*[i]和*t*[j]之间的周期数![](img/B15439_09_003.png)称为**滞后**，每个时间序列有*T*-1个不同的滞后。正如横截面模型中不同变量之间的关系对于交叉模型至关重要一样，分析和利用相隔给定滞后的数据点之间的关系对于分析和利用时间序列中的模式至关重要。
- en: For cross-sectional models, we distinguished between input and output variables,
    or target and predictors, with the labels *y* and *x*, respectively. In a time-series
    context, some or all of the lagged values ![](img/B15439_09_004.png) of the outcome
    *y* play the role of the input or *x* values in the cross-section context.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 对于横截面模型，我们区分输入和输出变量，或目标和预测变量，分别用标签*y*和*x*表示。在时间序列的情境中，结果*y*的一些或全部滞后值![](img/B15439_09_004.png)扮演了横截面情境中输入或*x*值的角色。
- en: A time series is called **white noise** if it is a sequence of **independent
    and identically distributed** (**IID**) random variables, ![](img/B15439_09_005.png),
    with finite mean and variance. In particular, the series is called a **Gaussian
    white noise** if the random variables are normally distributed with a mean of
    zero and a constant variance of ![](img/B15439_09_006.png).
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 如果时间序列是一个独立同分布（IID）的随机变量序列，![](img/B15439_09_005.png)，并且具有有限的均值和方差，则称为**白噪声**。特别地，如果随机变量服从均值为零、方差恒定为![](img/B15439_09_006.png)的正态分布，则该序列被称为**高斯白噪声**。
- en: 'A time series is linear if it can be written as a weighted sum of past disturbances,
    ![](img/B15439_09_007.png), that are also called innovations and are here assumed
    to represent white noise, and the mean of the series, ![](img/B15439_04_005.png):'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 如果时间序列可以被写成过去扰动的加权和，![](img/B15439_09_007.png)，也称为创新，这里假设它们代表白噪声，以及序列的均值，![](img/B15439_04_005.png)，则该时间序列是线性的。
- en: '![](img/B15439_09_009.png)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_009.png)'
- en: A key goal of time-series analysis is to understand the dynamic behavior that
    is driven by the coefficients, ![](img/B15439_09_010.png). The analysis of time
    series offers methods tailored to this type of data with the goal of extracting
    useful patterns that, in turn, help us build predictive models.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列分析的一个关键目标是理解由系数![](img/B15439_09_010.png)驱动的动态行为。时间序列分析提供了专门针对这种数据类型的方法，旨在提取有用的模式，进而帮助我们构建预测模型。
- en: We will introduce the most important tools for this purpose, including the decomposition
    into key systematic elements, the analysis of autocorrelation, and rolling window
    statistics such as moving averages.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将介绍用于此目的的最重要工具，包括分解为关键系统元素、自相关分析和滚动窗口统计，如移动平均值。
- en: For most of the examples in this chapter, we will work with data provided by
    the Federal Reserve that you can access using pandas-datareader, which we introduced
    in *Chapter 2*, *Market and Fundamental Data – Sources and Techniques*. The code
    examples for this section are available in the notebook `tsa_and_stationarity`.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的大多数示例中，我们将使用由美联储提供的数据进行工作，您可以使用pandas-datareader访问这些数据，我们在*第2章*，*市场和基本数据-来源和技术*中介绍了这一点。本节的代码示例可在笔记本`tsa_and_stationarity`中找到。
- en: How to decompose time-series patterns
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何分解时间序列模式
- en: Time-series data typically contains a mix of patterns that can be decomposed
    into several components. In particular, a time series often combines systematic
    components like trend, seasonality, and cycles with unsystematic noise. These
    components can be modeled as a linear combination (for example, when fluctuations
    do not depend on the level of the series) or in a nonlinear, multiplicative form.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列数据通常包含多种模式，可以分解为几个组成部分。特别地，时间序列通常将趋势、季节性和周期性等系统性组成部分与非系统性噪声组合在一起。这些组成部分可以被建模为线性组合（例如，当波动不依赖于序列的水平时）或非线性的乘法形式。
- en: 'Based on the model assumptions, they can also be split up automatically. Statsmodels
    includes a simple method to split the time series into separate trend, seasonal,
    and residual components using moving averages. We can apply it to monthly data
    on industrial manufacturing that contain both a strong trend component and a seasonality
    component, as follows:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 根据模型假设，它们也可以自动分割。Statsmodels包括一种简单的方法，使用移动平均值将时间序列分割为单独的趋势、季节和残差组件。我们可以将其应用于包含强趋势组件和季节性组件的工业制造业月度数据，如下所示：
- en: '[PRE0]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '*Figure 9.1* shows the resulting charts that display the additive components.
    The residual component would be the focus of subsequent modeling efforts, assuming
    that the trend and seasonality components are more deterministic and amenable
    to simple extrapolation:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '*图9.1*显示了显示加法组件的结果图表。残差组件将成为随后建模工作的重点，假设趋势和季节性组件更具决定性，并且更适合简单的外推。'
- en: '![](img/15439_09_01.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15439_09_01.png)'
- en: 'Figure 9.1: Time-series decomposition into trend, seasonality, and residuals'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.1：时间序列分解为趋势、季节性和残差
- en: There are more sophisticated model-based approaches—see, for example, *Chapter
    6*, *The Machine  Learning Process*, in Hyndman and Athanasopoulos (2018).
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 有更复杂的基于模型的方法——例如，参见Hyndman和Athanasopoulos（2018）中的*第6章*，*机器学习过程*。
- en: Rolling window statistics and moving averages
  id: totrans-34
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 滚动窗口统计和移动平均
- en: Given the sequential ordering of time-series data, it is natural to compute
    familiar descriptive statistics for periods of a given length. The goal is to
    detect whether the series is stable or changes over time and obtain a smoothed
    representation that captures systematic aspects while filtering out the noise.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 鉴于时间序列数据的顺序排列，自然而然地计算给定长度的时间段的熟悉描述性统计。目标是检测系列是否稳定或随时间变化，并获得一个平滑的表示，捕捉系统方面，同时滤除噪音。
- en: 'Rolling window statistics serve this process: they produce a new time series
    where each data point represents a summary statistic computed for a certain period
    of the original data. Moving averages are the most familiar example. The original
    data points can enter the computation with weights that are equal or, for example,
    emphasize more recent data points. Exponential moving averages recursively compute
    weights that decay for data points further in the past. The new data points are
    typically a summary of all preceding data points, but they can also be computed
    from a surrounding window.'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 滚动窗口统计信息用于此过程：它们产生一个新的时间序列，其中每个数据点代表原始数据的一定期间内计算的摘要统计量。移动平均是最熟悉的例子。原始数据点可以以相等的权重进入计算，也可以例如强调更近期的数据点。指数移动平均递归地计算权重，以便对更久远的数据点进行衰减。新的数据点通常是所有先前数据点的摘要，但也可以从周围的窗口计算得出。
- en: The pandas library includes rolling or expanding windows and allows for various
    weight distributions. In a second step, you can apply computations to each set
    of data captured by a window. These computations include built-in functions for
    individual series, such as the mean or the sum, and the correlation or covariance
    for several series, as well as user-defined functions.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: pandas库包括滚动或扩展窗口，并允许使用各种权重分布。在第二步中，您可以对窗口捕获的每组数据应用计算。这些计算包括用于单个系列的内置函数，例如均值或总和，以及用于多个系列的相关性或协方差，以及用户定义的函数。
- en: We used this functionality to engineer features in *Chapter 4*, *Financial Feature
    Engineering – How to Research Alpha Factors*, and *Chapter 7*, *Linear Models
    – From Risk Factors to Return Forecasts*, for example. The moving average and
    exponential smoothing examples in the following section will also apply these
    tools.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在*第4章*，*金融特征工程-如何研究Alpha因子*和*第7章*，*线性模型-从风险因子到收益预测*中使用了这个功能。以下部分中的移动平均和指数平滑示例也将应用这些工具。
- en: Early forecasting models included **moving-average models** with exponential
    weights called **exponential smoothing models**. We will encounter moving averages
    again as key building blocks for linear time series. Forecasts that rely on exponential
    smoothing methods use weighted averages of past observations, where the weights
    decay exponentially as the observations get older. Hence, a more recent observation
    receives a higher associated weight. These methods are popular for time series
    that do not have very complicated or abrupt patterns.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 早期的预测模型包括带有指数权重的**移动平均模型**，称为**指数平滑模型**。我们将再次遇到移动平均作为线性时间序列的关键构建块。依赖指数平滑方法的预测使用过去观察值的加权平均，其中权重随着观察值变老而呈指数衰减。因此，较新的观察值会获得更高的相关权重。这些方法在没有非常复杂或突然模式的时间序列中很受欢迎。
- en: How to measure autocorrelation
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何测量自相关
- en: '**Autocorrelation** (also called *serial correlation*) adapts the concept of
    correlation to the time-series context: just as the correlation coefficient measures
    the strength of a linear relationship between two variables, the **autocorrelation
    coefficient**, ![](img/B15439_09_011.png), measures the extent of a linear relationship
    between time-series values separated by a given lag, *k*:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '**自相关**（也称为*串行相关*）将相关性的概念调整到时间序列的背景下：正如相关系数衡量两个变量之间线性关系的强度一样，**自相关系数**，![](img/B15439_09_011.png)，衡量了相隔给定滞后*k*的时间序列值之间线性关系的程度。'
- en: '![](img/B15439_09_012.png)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_012.png)'
- en: Hence, we can calculate one autocorrelation coefficient for each of the *T*-1
    lags in a time series of length *T*. The **autocorrelation function** (**ACF**)
    computes the correlation coefficients as a function of the lag.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们可以为长度为*T*的时间序列中的*T*-1个滞后计算一个自相关系数。**自相关函数**（**ACF**）计算滞后的相关系数。
- en: The autocorrelation for a lag larger than 1 (that is, between observations more
    than one timestep apart) reflects both the direct correlation between these observations
    and the indirect influence of the intervening data points. The **partial autocorrelation**
    removes this influence and only measures the linear dependence between data points
    at the given lag distance, *T*. Removing means using the residuals of a linear
    regression with the outcome *x*[t] and the lagged values *x*[t][-1], *x*[t][-2],
    …, *x*[T][-1] as features (also known as an *AR*(*T*-1) model, which we'll discuss
    in the next section on univariate time-series models). The **partial autocorrelation
    function** (**PACF**) provides all the correlations that result once the effects
    of a correlation at shorter lags have been removed, as described previously.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 滞后大于1的自相关（即，两个观察值之间相隔一个时间步长以上）反映了这些观察值之间的直接相关性以及介入数据点的间接影响。**偏自相关**消除了这种影响，只测量给定滞后距离*T*处的数据点之间的线性依赖关系。通过使用线性回归的残差来消除均值，其中结果*x*[t]和滞后值*x*[t][-1]、*x*[t][-2]，…，*x*[T][-1]作为特征（也称为*AR*(*T*-1)模型，在我们将在下一节中讨论的单变量时间序列模型中）。**偏自相关函数**（**PACF**）提供了一旦去除了较短滞后的相关性的影响所产生的所有相关性，如前所述。
- en: There are also algorithms that estimate the partial autocorrelation from the
    sample autocorrelation based on the exact theoretical relationship between the
    PACF and the ACF.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 还有一些算法可以根据样本自相关来估计偏自相关，基于偏自相关函数和自相关函数之间的精确理论关系。
- en: A **correlogram** is simply a plot of the ACF or PACF for sequential lags, *k*=0,1,...,*n*.
    It allows us to inspect the correlation structure across lags at one glance (see
    *Figure 9.3* for an example). The main usage of correlograms is to detect any
    autocorrelation after the removal of a deterministic trend or seasonality. Both
    the ACF and the PACF are key diagnostic tools for the design of linear time-series
    models, and we will review examples of ACF and PACF plots in the following section
    on time-series transformations.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 自相关图只是顺序滞后*k*=0,1,...,*n*的自相关函数或偏自相关函数的图表。它允许我们一目了然地检查滞后间的相关结构（参见*图9.3*的示例）。自相关图的主要用途是在去除确定性趋势或季节性后检测任何自相关。自相关函数和偏自相关函数都是线性时间序列模型设计的关键诊断工具，我们将在下一节关于时间序列转换的示例中回顾自相关函数和偏自相关函数的图表。
- en: How to diagnose and achieve stationarity
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何诊断和实现平稳性
- en: The statistical properties, such as the mean, variance, or autocorrelation,
    of a **stationary time series** are independent of the period—that is, they don't
    change over time. Thus, **stationarity** implies that a time series does not have
    a trend or seasonal effects. Furthermore, it requires that descriptive statistics,
    such as the mean or the standard deviation, when computed for different rolling
    windows, are constant or do not change significantly over time. A stationary time
    series reverts to its mean, and the deviations have a constant amplitude, while
    short-term movements are always alike in a statistical sense.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 平稳时间序列的统计特性，如均值、方差或自相关，与时间段无关，即它们随时间不变。因此，平稳性意味着时间序列没有趋势或季节效应。此外，它要求描述统计数据，如均值或标准差，在不同滚动窗口计算时是恒定的或随时间不显著变化。平稳时间序列回归到其均值，偏差具有恒定的振幅，而短期波动在统计意义上总是相似的。
- en: More formally, **strict stationarity** requires the joint distribution of any
    subset of time-series observations to be independent of time with respect to all
    moments. So, in addition to the mean and variance, higher moments such as skew
    and kurtosis also need to be constant, irrespective of the lag between different
    observations. In most applications, such as most time-series models in this chapter
    that we can use to model asset returns, we limit stationarity to first and second
    moments so that the time series is covariance stationary with constant mean, variance,
    and autocorrelation. However, we abandon this assumption when building modeling
    volatility and explicitly assume the variance to change over time in predictable
    ways.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 更正式地，严格的平稳性要求任何时间序列观测子集的联合分布与时间无关，关于所有时刻的矩。因此，除了均值和方差外，偏度和峰度等更高阶矩也需要保持恒定，不考虑不同观测之间的滞后。在大多数应用中，例如本章中我们用来模拟资产回报的大多数时间序列模型，我们将平稳性限制在一阶和二阶矩，使得时间序列具有恒定的均值、方差和自相关性。然而，在构建波动率模型时，我们放弃了这一假设，并明确假设方差以可预测的方式随时间变化。
- en: Note that we specifically allow for **dependence between output values at different
    lags**, just like we want the input data for linear regression to be correlated
    with the outcome. Stationarity implies that these relationships are stable. Stationarity
    is a key assumption of classical statistical models. The following two subsections
    introduce transformations that can help make a time series stationary, as well
    as how to address the special case of a stochastic trend caused by a unit root.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，我们特别允许不同滞后输出值之间的依赖关系，就像我们希望线性回归的输入数据与结果相关一样。平稳性意味着这些关系是稳定的。平稳性是古典统计模型的关键假设。以下两个小节介绍了可以帮助使时间序列平稳的转换，以及如何处理由单位根引起的随机趋势的特殊情况。
- en: Transforming a time series to achieve stationarity
  id: totrans-51
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将时间序列转换为平稳性
- en: To satisfy the stationarity assumption of many time-series models, we need to
    transform the original series, often in several steps. Common transformations
    include the (natural) **logarithm** to convert an exponential growth pattern into
    a linear trend and stabilize the variance. **Deflation** implies dividing a time
    series by another series that causes trending behavior, for example, dividing
    a nominal series by a price index to convert it into a real measure.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 为了满足许多时间序列模型的平稳性假设，我们需要转换原始序列，通常需要经过几个步骤。常见的转换包括（自然）对数，将指数增长模式转换为线性趋势并稳定方差。通货紧缩意味着将一个时间序列除以另一个导致趋势行为的系列，例如，将名义系列除以价格指数以将其转换为实际度量。
- en: A series is **trend-stationary** if it reverts to a stable long-run linear trend.
    It can often be made stationary by fitting a trend line using linear regression
    and using the residuals. This implies including the time index as an independent
    variable in a linear regression model, possibly combined with logging or deflating.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 如果一个序列回归到一个稳定的长期线性趋势，那么它是趋势平稳的。通常可以通过使用线性回归拟合趋势线并使用残差来使其平稳。这意味着在线性回归模型中将时间指数作为独立变量，可能结合对数或通货紧缩。
- en: In many cases, detrending is not sufficient to make the series stationary. Instead,
    we need to transform the original data into a series of **period-to-period and/or
    season-to-season differences**. In other words, we use the result of subtracting
    neighboring data points or values at seasonal lags from each other. Note that
    when such differencing is applied to a log-transformed series, the results represent
    instantaneous growth rates or returns in a financial context.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多情况下，去趋势化不足以使序列平稳。相反，我们需要将原始数据转换为一系列周期间和/或季节间的差异序列。换句话说，我们使用相邻数据点或季节滞后值相减的结果。请注意，当这种差分应用于对数转换的系列时，结果代表金融背景下的瞬时增长率或回报率。
- en: If a univariate series becomes stationary after differencing *d* times, it is
    said to be integrated of the order of *d*, or simply integrated if *d*=1\. This
    behavior is due to unit roots, which we will explain next.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 如果单变量系列经过*d*次差分后变得平稳，就称为具有*d*阶的整合，或者如果*d*=1，则称为简单整合。这种行为是由单位根引起的，我们将在下面解释。
- en: Handling instead of how to handle
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 处理而不是如何处理
- en: Unit roots pose a particular problem for determining the transformation that
    will render a time series stationary. We will first explain the concept of a unit
    root before discussing diagnostics tests and solutions.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 单位根对确定将时间序列变为平稳的转换构成了特殊问题。我们将首先解释单位根的概念，然后讨论诊断测试和解决方案。
- en: On unit roots and random walks
  id: totrans-58
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 关于单位根和随机游走
- en: 'Time series are often modeled as stochastic processes of the following autoregressive
    form so that the current value is a weighted sum of past values, plus a random
    disturbance:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列经常被建模为以下自回归形式的随机过程，因此当前值是过去值的加权和，再加上一个随机扰动：
- en: '![](img/B15439_09_013.png)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_013.png)'
- en: 'We will explore these models in more detail as the AR building block for ARIMA
    models in the next section on univariate time-series models. Such a process has
    a characteristic equation of the following form:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在下一节关于单变量时间序列模型的ARIMA模型的AR构建块中更详细地探讨这些模型。这样的过程具有以下形式的特征方程：
- en: '![](img/B15439_09_014.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_014.png)'
- en: If one of the (up to) *p* roots of this polynomial equals 1, then the process
    is said to have a **unit root**. It will be non-stationary but will not necessarily
    have a trend. If the remaining roots of the characteristic equation are less than
    1 in absolute terms, the first difference of the process will be stationary, and
    the **process is integrated of order 1 or I(1)**. With additional roots larger
    than 1 in absolute terms, the order of integration is higher and additional differencing
    will be required.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 如果这个多项式的（最多）*p*个根之一等于1，则该过程被称为具有**单位根**。它将是非平稳的，但不一定具有趋势。如果特征方程的其余根绝对值小于1，该过程的一阶差分将是平稳的，且**过程是一阶整合或I(1)**。如果额外的根大于绝对值1，整合的阶数会更高，需要额外的差分。
- en: 'In practice, time series of interest rates or asset prices are often not stationary
    because there isn''t a price level to which the series reverts. The most prominent
    example of a non-stationary series is the random walk. Given a time series of
    prices *p*[t] with starting price *p*[0](for example, a stock''s IPO price) and
    a white-noise disturbance ![](img/B15439_09_005.png), then a random walk satisfies
    the following autoregressive relationship:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，利率或资产价格的时间序列通常不是平稳的，因为没有价格水平可以回归到。非平稳系列的最突出的例子是随机游走。给定一个价格时间序列*p*[t]，初始价格为*p*[0]（例如，股票的IPO价格）和一个白噪声扰动![](img/B15439_09_005.png)，那么随机游走满足以下自回归关系：
- en: '![](img/B15439_09_016.png)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_016.png)'
- en: Repeated substitution shows that the current value, *p*[t], is the sum of all
    prior disturbances or innovations, ![](img/B15439_09_005.png), and the initial
    price, *p*[0]. If the equation includes a constant term, then the random walk
    is said to have **drift**.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 重复替换表明当前值*p*[t]是所有先前扰动或创新的总和，![](img/B15439_09_005.png)，以及初始价格*p*[0]。如果方程包括一个常数项，那么随机游走被称为具有**漂移**。
- en: 'The random walk is thus an **autoregressive stochastic process** of the following
    form:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，随机游走是以下形式的**自回归随机过程**：
- en: '![](img/B15439_09_018.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_018.png)'
- en: It has the characteristic equation ![](img/B15439_09_019.png) with a unit root
    and is both non-stationary and integrated of order 1\. On the one hand, given
    the IID nature of ![](img/B15439_09_020.png), the variance of the time series
    equals ![](img/B15439_09_021.png), which is **not second-order stationary**, and
    implies that, in principle, the series could assume any value over time. On the
    other hand, taking the **first difference**, ![](img/B15439_09_022.png), leaves
    ![](img/B15439_09_023.png), which is **stationary**, given the statistical assumption
    about ![](img/B15439_09_024.png).
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 它具有特征方程![](img/B15439_09_019.png)，具有单位根，既是非平稳的，又是一阶整合。一方面，鉴于![](img/B15439_09_020.png)的IID性质，时间序列的方差等于![](img/B15439_09_021.png)，这**不是二阶平稳**，并且原则上意味着时间序列可以随时间取任何值。另一方面，取**一阶差分**![](img/B15439_09_022.png)，得到**平稳**的![](img/B15439_09_023.png)，鉴于对![](img/B15439_09_024.png)的统计假设。
- en: 'The defining characteristic of a non-stationary series with a unit-root is
    **long memory**: since current values are the sum of past disturbances, large
    innovations persist for much longer than for a mean-reverting, stationary series.'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 具有单位根的非平稳系列的定义特征是**长期记忆**：因为当前值是过去扰动的总和，大的创新持续时间比均值回归的平稳系列长得多。
- en: How to diagnose a unit root
  id: totrans-71
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 如何诊断单位根
- en: Statistical unit root tests are a common way to determine objectively whether
    (additional) differencing is necessary. These are statistical hypothesis tests
    of stationarity that are designed to determine whether differencing is required.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 统计单位根检验是一种客观确定是否需要（额外）差分的常见方法。这些是用于确定是否需要差分的平稳性的统计假设检验。
- en: The **augmented Dickey-Fuller test** (**ADF test**) evaluates the null hypothesis
    that a time-series sample has a unit root against the alternative of stationarity.
    It regresses the differenced time series on a time trend, the first lag, and all
    lagged differences, and computes a test statistic from the value of the coefficient
    on the lagged time-series value. `statsmodels` makes it easy to implement (see
    the notebook `tsa_and_stationarity`).
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: '**增广迪基-富勒检验**（**ADF检验**）评估时间序列样本是否具有单位根的零假设，对立假设是平稳性。它将差分时间序列回归到时间趋势、第一滞后和所有滞后差分上，并从滞后时间序列值的系数值计算一个检验统计量。`statsmodels`使其易于实现（参见笔记本`tsa_and_stationarity`）。'
- en: 'Formally, the ADF test for a time series, ![](img/B15439_09_025.png), runs
    the linear regression where ![](img/B15439_09_026.png) is a constant, ![](img/B15439_07_004.png)
    is a coefficient on a time trend, and *p* refers to the number of lags used in
    the model:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 形式上，对于时间序列的ADF检验，![](img/B15439_09_025.png)，进行线性回归，其中![](img/B15439_09_026.png)是一个常数，![](img/B15439_07_004.png)是时间趋势上的系数，*p*是模型中使用的滞后数：
- en: '![](img/B15439_09_028.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_028.png)'
- en: The constraint ![](img/B15439_09_029.png) implies a random walk, whereas only
    ![](img/B15439_09_030.png) implies a random walk with drift. The lag order is
    usually decided using the **Akaike information criterion** (**AIC**) and **Bayesian
    information criterion** (**BIC**) information criteria introduced in *Chapter 7*,
    *Linear Models – From Risk Factors to Return Forecasts*.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 约束![](img/B15439_09_029.png)意味着随机游走，而只有![](img/B15439_09_030.png)意味着带漂移的随机游走。滞后顺序通常使用*第7章*中引入的**Akaike信息准则**（**AIC**）和**贝叶斯信息准则**（**BIC**）信息标准来决定。
- en: The ADF test statistic uses the sample coefficient ![](img/B15439_09_031.png),
    which, under the null hypothesis of unit-root non-stationarity, equals zero and
    is negative otherwise. It intends to demonstrate that, for an integrated series,
    the lagged series value should not provide useful information in predicting the first
    difference above and beyond lagged differences.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: ADF检验统计量使用样本系数![](img/B15439_09_031.png)，在单位根非平稳的零假设下等于零，否则为负。它旨在证明对于一个积分系列，滞后的系列值不应该在预测超出滞后差异的第一差分方面提供有用信息。
- en: How to remove unit roots and work with the resulting series
  id: totrans-78
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 如何消除单位根并处理结果系列
- en: In addition to using the difference between neighboring data points to remove
    a constant pattern of change, we can apply **seasonal differencing** to remove
    patterns of seasonal change. This involves taking the difference of values at
    a lag distance that represents the length of the seasonal pattern. For monthly
    data, this usually involves differences at lag 12, and for quarterly data, it
    involves differences at lag 4 to remove both seasonality and linear trend.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 除了使用相邻数据点之间的差异来消除恒定的变化模式外，我们还可以应用**季节性差分**来消除季节性变化的模式。这涉及在代表季节模式长度的滞后距离上取值的差异。对于月度数据，这通常涉及在滞后12处进行差异，对于季度数据，这涉及在滞后4处进行差异，以消除季节性和线性趋势。
- en: 'Identifying the correct transformation and, in particular, the appropriate
    number and lags for differencing is not always clear-cut. Some **heuristics**
    have been suggested, which can be summarized as follows:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 确定正确的转换，特别是适当的差分数量和滞后并不总是清晰的。一些启发式方法已经被提出，可以总结如下：
- en: 'Lag-1 autocorrelation close to zero or negative, or autocorrelation generally
    small and patternless: there is no need for higher-order differencing'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 滞后1自相关接近零或为负，或者自相关普遍较小且无规律：不需要更高阶的差分
- en: 'Positive autocorrelations up to 10+ lags: the series probably needs higher-order
    differencing'
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 正自相关延续到10个以上的滞后：系列可能需要更高阶的差分
- en: 'Lag-1 autocorrelation < -0.5: the series may be over-differenced'
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 滞后1自相关< -0.5：系列可能过度差分
- en: Slightly over- or under-differencing can be corrected with AR or MA terms (see
    the next section on univariate time-series models)
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 轻微过度或不足的差分可以通过AR或MA项进行校正（请参阅下一节关于单变量时间序列模型）。
- en: Some authors recommend fractional differencing as a more flexible approach to
    rendering an integrated series stationary, and may be able to keep more information
    or signal than simple or seasonal differences at discrete intervals. See, for
    example, *Chapter 5*, *Portfolio Optimization and Performance Evaluation*, in
    Marcos Lopez de Prado (2018).
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 一些作者建议使用分数差分作为使积分系列平稳的更灵活的方法，并且可能能够在离散间隔处保留比简单或季节性差异更多的信息或信号。例如，参见Marcos Lopez
    de Prado（2018）的*第5章*，*投资组合优化和绩效评估*。
- en: Time-series transformations in practice
  id: totrans-86
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 实际中的时间序列转换
- en: The charts in *Figure 9.2* shows time series for the NASDAQ stock index and
    industrial production for the 30 years through 2017 in their original form, as
    well as the transformed versions after applying the logarithm and subsequently
    applying the first and seasonal differences (at lag 12), respectively.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '*图9.2*中的图表显示了纳斯达克股指和工业生产的时间序列，经过对数变换后以及分别应用第一和季节性差分（在滞后12）后的转换版本。'
- en: 'The charts also display the ADF p-value, which allows us to reject the hypothesis
    of unit-root non-stationarity after all transformations in both cases:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 图表还显示了ADF p值，这使我们能够在两种情况下拒绝单位根非平稳的假设：
- en: '![](img/15439_09_02.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15439_09_02.png)'
- en: 'Figure 9.2: Time-series transformations and unit-root test results'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.2：时间序列转换和单位根检验结果
- en: We can further analyze the relevant time-series characteristics for the transformed
    series using a Q-Q plot that compares the quantiles of the distribution of the
    time-series observation to the quantiles of the normal distribution and the correlograms
    based on the ACF and PACF.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以进一步分析转换后系列的相关时间序列特征，使用Q-Q图比较时间序列观测的分布分位数和正态分布的分位数，以及基于ACF和PACF的自相关图。
- en: For the NASDAQ plots in *Figure 9.3*, we can see that while there is no trend,
    the variance is not constant but rather shows clustered spikes around periods
    of market turmoil in the late 1980s, 2001, and 2008\. The Q-Q plot highlights
    the fat tails of the distribution with extreme values that are more frequent than
    the normal distribution would suggest.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 在*图9.3*中的纳斯达克指数图中，我们可以看到虽然没有趋势，但方差并不是恒定的，而是在20世纪80年代末、2001年和2008年的市场动荡期间显示出聚集的尖峰。Q-Q图突出了分布的厚尾，极端值比正态分布所暗示的更频繁。
- en: 'The ACF and the PACF show similar patterns, with autocorrelation at several
    lags appearing to be significant:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: ACF和PACF显示相似的模式，几个滞后的自相关似乎是显著的：
- en: '![](img/15439_09_03.png)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15439_09_03.png)'
- en: 'Figure 9.3: Descriptive statistics for transformed NASDAQ Composite index'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.3：转换后的纳斯达克综合指数的描述统计
- en: 'For the monthly time series on industrial manufacturing production, we can
    see a large negative outlier following the 2008 crisis, as well as the corresponding
    skew in the Q-Q plot (see *Figure 9.4*). The autocorrelation is much higher than
    for the NASDAQ returns and declines smoothly. The PACF shows distinct positive
    autocorrelation patterns at lags 1 and 13 and significant negative coefficients
    at lags 3 and 4:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 对于工业制造生产的月度时间序列，我们可以看到2008年危机后出现了一个较大的负异常值，以及Q-Q图中相应的偏斜（见*图9.4*）。自相关性远高于纳斯达克指数的回报率，并且呈平稳下降。PACF显示出在滞后期1和13处明显的正自相关模式，以及在滞后期3和4处显著的负系数：
- en: '![](img/15439_09_04.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15439_09_04.png)'
- en: 'Figure 9.4: Descriptive statistics for transformed industrial production data'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.4：转换后的工业生产数据的描述统计
- en: Univariate time-series models
  id: totrans-99
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 单变量时间序列模型
- en: Multiple linear-regression models expressed the variable of interest as a linear
    combination of the inputs, plus a random disturbance. In contrast, univariate
    time-series models relate the current value of the time series to a linear combination
    of lagged values of the series, current noise, and possibly past noise terms.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 多元线性回归模型将感兴趣的变量表示为输入的线性组合，再加上一个随机扰动。相比之下，单变量时间序列模型将时间序列的当前值与系列的滞后值、当前噪声以及可能的过去噪声项的线性组合相关联。
- en: 'While exponential smoothing models are based on a description of the trend
    and seasonality in the data, **ARIMA models aim to describe the autocorrelations
    in the data**. ARIMA(*p*, *d*, *q*) models require stationarity and leverage two
    building blocks:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然指数平滑模型是基于数据中趋势和季节性的描述，**ARIMA模型旨在描述数据中的自相关**。ARIMA(*p*, *d*, *q*)模型需要平稳性，并利用两个基本组成部分：
- en: '**Autoregressive** (**AR**) terms consisting of *p* lagged values of the time
    series'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自回归**（**AR**）项由时间序列的*p*个滞后值组成'
- en: '**Moving average** (**MA**) terms that contain *q* lagged disturbances'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**移动平均**（**MA**）项包含*q*个滞后扰动'
- en: The **I** stands for *integrated* because the model can account for unit-root
    non-stationarity by differentiating the series *d* times. The term autoregression
    underlines that ARIMA models imply a regression of the time series on its own
    values.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: '**I**代表*积分*，因为该模型可以通过对系列进行*d*次差分来解释单位根的非平稳性。自回归一词强调了ARIMA模型意味着时间序列对其自身值的回归。'
- en: We will introduce the ARIMA building blocks, AR and MA models, and explain how
    to combine them in **autoregressive moving-average** (**ARMA**) models that may
    account for series integration as ARIMA models or include exogenous variables
    as **AR(I)MAX** models. Furthermore, we will illustrate how to include seasonal
    AR and MA terms to extend the toolbox so that it also includes **SARMAX** models.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将介绍ARIMA的基本组成部分，AR和MA模型，并解释如何将它们组合成可能像ARIMA模型一样解释系列积分或包括外生变量的**自回归移动平均**（**ARMA**）模型。此外，我们将说明如何包括季节性AR和MA项以扩展工具箱，使其还包括**SARMAX**模型。
- en: How to build autoregressive models
  id: totrans-106
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何构建自回归模型
- en: 'An AR model of order *p* aims to capture the linear dependence between time-series
    values at different lags and can be written as follows:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: '*p*阶的AR模型旨在捕捉不同滞后期时间序列值之间的线性依赖关系，可以写成如下形式：'
- en: '![](img/B15439_09_032.png)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_032.png)'
- en: 'This closely resembles a multiple linear regression on lagged values of *y*[t].
    This model has the following characteristic equation:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 这与*y*[t]的滞后值的多元线性回归非常相似。该模型具有以下特征方程：
- en: '![](img/B15439_09_033.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_033.png)'
- en: The inverses of the solution to this polynomial of degree *p* in *x* are the
    characteristic roots, and the AR(*p*) process is stationary if all roots are less
    than 1 in absolute terms, and unstable otherwise. For a stationary series, multistep
    forecasts will converge to the mean of the series.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 这个*p*次多项式在*x*中的解的倒数是特征根，如果所有根的绝对值小于1，则AR(*p*)过程是平稳的，否则是不稳定的。对于平稳系列，多步预测将收敛到系列的均值。
- en: We can estimate the model parameters with the familiar least squares method
    using the *p*+1, ..., *T* observations to ensure there is data for each lagged
    term and the outcome.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用熟悉的最小二乘法来估计模型参数，使用*p*+1, ..., *T*的观察值来确保每个滞后项和结果都有数据。
- en: How to identify the number of lags
  id: totrans-113
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 如何确定滞后期数
- en: In practice, the challenge consists of deciding on the appropriate order *p*
    of lagged terms. The time-series analysis tools for serial correlation, which
    we discussed in the *How to measure autocorrelation* section, play a key role
    in making this decision.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 在实践中，挑战在于决定适当的滞后项*p*的顺序。我们在*如何测量自相关*部分讨论的时间序列分析工具在做出这一决定时起着关键作用。
- en: 'More specifically, a visual inspection of the correlogram often provides helpful
    clues:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 更具体地，对自相关图的视觉检查通常会提供有用的线索：
- en: The **ACF** estimates the autocorrelation between observations at different
    lags, which, in turn, results from both direct and indirect linear dependence.
    Hence, if an AR model of order *k* is the correct model, the ACF will show a significant
    serial correlation up to lag *k* and, due to the inertia caused by the indirect
    effects of the linear relationship, will extend to subsequent lags until it eventually
    trails off as the effect weakens.
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ACF**估计了不同滞后期观察之间的自相关，这反过来是直接和间接线性依赖的结果。因此，如果*p*阶的AR模型是正确的模型，ACF将显示出直到滞后期*k*的显著串行相关，并且由于线性关系的间接效应引起的惯性，将延伸到随后的滞后期，直到最终随着效应的减弱而消失。'
- en: The **PACF**, in turn, only measures the direct linear relationship between
    observations a given lag apart so that it will not reflect correlation for lags
    beyond *k*.
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 而**PACF**只衡量给定滞后期间观察之间的直接线性关系，因此不会反映超过*k*的滞后期的相关性。
- en: How to diagnose model fit
  id: totrans-118
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 如何诊断模型拟合
- en: If the model properly captures the linear dependence across lags, then the residuals
    should resemble white noise, and the ACF should highlight the absence of significant
    autocorrelation coefficients.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 如果模型能够正确捕捉滞后期之间的线性依赖关系，那么残差应该类似于白噪声，自相关函数应该突出显示显著的自相关系数的缺失。
- en: 'In addition to a residual plot, the **Ljung-Box Q-statistic** allows us to
    test the hypothesis that the residual series follows white noise. The null hypothesis
    is that all *m* serial correlation coefficients are zero against the alternative
    that some coefficients are not. The test statistic is computed from the sample
    autocorrelation coefficients ![](img/B15439_09_034.png)for different lags *k*
    and follows a *X*² distribution:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 除了残差图之外，**Ljung-Box Q统计量**还允许我们测试残差序列是否遵循白噪声的假设。零假设是所有*m*个序列相关系数为零，备择假设是一些系数不为零。检验统计量是从不同滞后*k*的样本自相关系数![](img/B15439_09_034.png)计算得到，并遵循*X*²分布。
- en: '![](img/B15439_09_035.png)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_035.png)'
- en: As we will see, statsmodels provides information about the significance of coefficients
    for different lags, and insignificant coefficients should be removed. If the Q-statistic
    rejects the null hypothesis of no autocorrelation, you should consider additional
    AR terms.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们将看到的，statsmodels提供了关于不同滞后阶数系数显著性的信息，不显著的系数应该被移除。如果Q统计拒绝了无自相关的零假设，你应该考虑额外的AR项。
- en: How to build moving-average models
  id: totrans-123
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何构建移动平均模型
- en: 'An MA(*q*) model uses *q* past disturbances rather than lagged values of the
    time series in a regression-like model, as follows:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: MA(*q*)模型使用过去*q*个扰动，而不是时间序列的滞后值，如下所示：
- en: '![](img/B15439_09_036.png)'
  id: totrans-125
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_036.png)'
- en: Since we do not observe the white-noise disturbance values, ![](img/B15439_09_007.png),
    MA(*q*) is not a regression model like the ones we have seen so far. Rather than
    using least squares, MA(*q*) models are estimated using **maximum likelihood**
    (**MLE**), alternatively initializing or estimating the disturbances at the beginning
    of the series and then recursively and iteratively computing the remainder.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们无法观察到白噪声扰动值![](img/B15439_09_007.png)，MA(*q*)不像我们迄今所见的回归模型。MA(*q*)模型是使用**最大似然估计**（**MLE**）来估计的，或者在系列开始时初始化或估计扰动，然后递归和迭代地计算剩余部分。
- en: The MA(*q*) model gets its name from representing each value of *y*[t] as a
    weighted moving average of the past *q* innovations. In other words, current estimates
    represent a correction relative to past errors made by the model. The use of moving
    averages in MA(*q*) models differs from that of exponential smoothing, or the
    estimation of seasonal time-series components, because an MA(*q*) model aims to
    forecast future values, as opposed to denoising or estimating the trend cycle
    of past values.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: MA(*q*)模型得名于将*y*[t]的每个值表示为过去*q*个创新的加权移动平均值。换句话说，当前的估计值代表了模型过去错误的修正。MA(*q*)模型中移动平均的使用与指数平滑或季节时间序列分量的估计不同，因为MA(*q*)模型旨在预测未来值，而不是去噪或估计过去值的趋势周期。
- en: MA(*q*) processes are always stationary because they are the weighted sum of
    white noise variables that are, themselves, stationary.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: MA(*q*)过程总是平稳的，因为它们是白噪声变量的加权和，而白噪声变量本身是平稳的。
- en: How to identify the number of lags
  id: totrans-129
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 如何确定滞后阶数
- en: A time series generated by an MA(*q*) process is driven by the residuals of
    the prior *q* model predictions. Hence, the ACF for the MA(*q*) process will show
    significant coefficients for values up to lag *q* and then decline sharply because
    this is how the model assumes the series values have been generated.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 由MA(*q*)过程生成的时间序列由先前*q*个模型预测的残差驱动。因此，MA(*q*)过程的自相关函数将显示出到滞后*q*的显著系数，然后急剧下降，因为这是模型假设系列值生成的方式。
- en: Note how this differs from the AR case we just described, where the PACF would
    show a similar pattern.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，这与我们刚刚描述的AR情况有所不同，那里偏自相关函数将显示出类似的模式。
- en: The relationship between the AR and MA models
  id: totrans-132
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: AR和MA模型之间的关系
- en: An AR(*p*) model can always be expressed as an ![](img/B15439_09_038.png) process
    using repeated substitution, as in the random walk example in the *How to handle
    stochastic trends caused by unit roots* section.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: AR(*p*)模型总是可以使用重复替换表示为一个![](img/B15439_09_038.png)过程，就像*如何处理由单位根引起的随机趋势*部分中的随机游走示例一样。
- en: When the coefficients of the MA(*q*) process meet certain size constraints,
    it also becomes invertible and can be expressed as an ![](img/B15439_09_039.png)
    process (see Tsay, 2005, for details).
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 当MA(*q*)过程的系数满足一定的大小约束时，它也变得可逆，并且可以被表示为一个![](img/B15439_09_039.png)过程（详见Tsay,
    2005）。
- en: How to build ARIMA models and extensions
  id: totrans-135
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何构建ARIMA模型和扩展
- en: Autoregressive integrated moving-average—ARIMA(*p*, *d*, *q*)—models combine
    AR(*p*) and MA(*q*) processes to leverage the complementarity of these building
    blocks and simplify model development. They do this using a more compact form
    and reducing the number of parameters, in turn reducing the risk of overfitting.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 自回归积分移动平均—ARIMA(*p*, *d*, *q*)—模型结合了AR(*p*)和MA(*q*)过程，以利用这些构建块的互补性并简化模型开发。它们使用更紧凑的形式，减少参数数量，从而降低过拟合的风险。
- en: 'The models also take care of eliminating unit-root non-stationarity by using
    the *d*^(th) difference of the time-series values. An ARIMA(*p*, 1, *q*) model
    is the same as using an ARMA(*p*, *q*) model with the first differences of the
    series. Using *y*'' to denote the original series after non-seasonal differencing
    *d* times, the ARIMA(*p*, *d*, *q*) model is simply:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 该模型还通过使用时间序列值的*d*^(th)差分来消除单位根非平稳性。ARIMA(*p*, 1, *q*)模型与使用系列的一阶差分的ARMA(*p*,
    *q*)模型相同。使用*y*'表示非季节性差分*d*次后的原始系列，ARIMA(*p*, *d*, *q*)模型简单地表示为：
- en: '![](img/B15439_09_040.png)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_040.png)'
- en: ARIMA models are also estimated using MLE. Depending on the implementation,
    higher-order models may generally subsume lower-order models.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: ARIMA模型也是使用MLE估计的。根据实现方式，高阶模型通常包含低阶模型。
- en: For example, up to version 0.11, statsmodels includes all lower-order *p* and
    *q* terms and does not permit removing coefficients for lags below the highest
    value. In this case, higher-order models will always fit better. Be careful not
    to overfit your model to the data by using too many terms. The most recent version,
    which is 0.11 at the time of writing, added an experimental new ARIMA model with
    more flexible configuration options.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，直到版本0.11，statsmodels包括所有较低阶的*p*和*q*项，并且不允许删除低于最高值的滞后的系数。在这种情况下，更高阶的模型将始终拟合得更好。小心不要通过使用太多项来过度拟合数据。在撰写本文时，最新版本是0.11，它添加了一个具有更灵活配置选项的实验性新ARIMA模型。
- en: How to model differenced series
  id: totrans-141
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 如何对差分系列建模
- en: 'There are also guidelines for designing the univariate times-series models
    when using data:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用数据时，还有一些设计单变量时间序列模型的指导原则：
- en: A model without differencing assumes that the original series is stationary,
    including mean-reverting. It normally includes a constant term to allow for a
    non-zero mean.
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 没有差分的模型假定原始系列是平稳的，包括均值回归。通常包括一个常数项，以允许非零均值。
- en: A model with one order of differencing assumes that the original series has
    a constant trend and should thus include a constant term.
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 具有一阶差分的模型假定原始系列具有恒定趋势，因此应包括一个常数项。
- en: A model with two orders of differencing assumes that the original series has
    a time-varying trend and should not include a constant.
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 具有两个差分阶数的模型假定原始系列具有时变趋势，并且不应包括一个常数。
- en: How to identify the number of AR and MA terms
  id: totrans-146
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 如何确定AR和MA项的数量
- en: Since AR(*p*) and MA(*q*) terms interact, the information provided by the ACF
    and PACF is no longer reliable and can only be used as a starting point.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 由于AR(*p*)和MA(*q*)项相互作用，ACF和PACF提供的信息不再可靠，只能用作起点。
- en: Traditionally, the AIC and BIC information criteria have been used to rely on
    in-sample fit when selecting the model design. Alternatively, we can rely on out-of-sample
    tests to cross-validate multiple parameter choices.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 传统上，AIC和BIC信息标准已被用于在选择模型设计时依赖样本内拟合。或者，我们可以依赖样本外测试来交叉验证多个参数选择。
- en: 'The following summary provides some guidance on how to choose the model order
    in the case of considering AR and MA models in isolation:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 以下摘要提供了一些关于如何在考虑AR和MA模型时选择模型顺序的指导：
- en: The lag beyond which the PACF cuts off is the indicated number of AR terms.
    If the PACF of the differenced series cuts off sharply and/or the lag-1 autocorrelation
    is positive, add one or more AR terms.
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PACF截断的滞后是AR项的指示数量。如果差分系列的PACF截断明显和/或滞后1的自相关性为正，则添加一个或多个AR项。
- en: The lag beyond which the ACF cuts off is the indicated number of MA terms. If
    the ACF of the differenced series displays a sharp cutoff and/or the lag-1 autocorrelation
    is negative, consider adding an MA term to the model.
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ACF截断的滞后是MA项的指示数量。如果差分系列的ACF显示出明显的截断和/或滞后1的自相关性为负，则考虑向模型添加MA项。
- en: AR and MA terms may cancel out each other's effects, so always try to reduce
    the number of AR and MA terms by 1 if your model contains both to avoid overfitting,
    especially if the more complex model requires more than 10 iterations to converge.
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AR和MA项可能会互相抵消，因此如果您的模型同时包含两者，始终尝试减少1个AR和MA项的数量，以避免过度拟合，特别是如果更复杂的模型需要超过10次迭代才能收敛。
- en: If the AR coefficients sum to nearly one and suggest a unit root in the AR part
    of the model, eliminate one AR term and difference the model once (more).
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果AR系数总和接近于1，并且模型的AR部分表明存在单位根，则消除一个AR项并对模型进行一次差分（再次）。
- en: If the MA coefficients sum to nearly one and suggest a unit root in the MA part
    of the model, eliminate one MA term and reduce the order of differencing by one.
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果MA系数总和接近于1，并且模型的MA部分表明存在单位根，则消除一个MA项并将差分阶数减少一个。
- en: Unstable long-term forecasts suggest there may be a unit root in the AR or MA
    part of the model.
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不稳定的长期预测表明模型的AR或MA部分可能存在单位根。
- en: Adding features – ARMAX
  id: totrans-156
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 添加特征 - ARMAX
- en: 'An **autoregressive moving-average model with exogenous inputs** (**ARMAX**)
    model adds input variables or covariate on the right-hand side of the ARMA time-series
    model (assuming the series is stationary, so we can skip differencing):'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: '**具有外生输入的自回归移动平均模型**（**ARMAX**）模型在ARMA时间序列模型的右侧添加输入变量或协变量（假设系列是平稳的，因此我们可以跳过差分）：'
- en: '![](img/B15439_09_041.png)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_041.png)'
- en: This resembles a linear regression model but is quite difficult to interpret.
    This is because the effect of ![](img/B15439_09_042.png) on *y*[t] is not the
    effect of an increase in *x*[t] by one unit as in linear regression. Instead,
    the presence of lagged values of *y*[t] on the right-hand side of the equation
    implies that the coefficient can only be interpreted, given the lagged values
    of the response variable, which is hardly intuitive.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 这类似于线性回归模型，但解释起来相当困难。这是因为![](img/B15439_09_042.png)对*y*[t]的影响并不像线性回归中*x*[t]增加一个单位那样简单。相反，方程右侧的滞后*y*[t]值的存在意味着系数只能在给定响应变量的滞后值的情况下进行解释，这几乎是不直观的。
- en: Adding seasonal differencing – SARIMAX
  id: totrans-160
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 添加季节性差分 - SARIMAX
- en: For time series with seasonal effects, we can include AR and MA terms that capture
    the seasonality's periodicity. For instance, when using monthly data and the seasonal
    effect length is 1 year, the seasonal AR and MA terms would reflect this particular
    lag length.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 对于具有季节效应的时间序列，我们可以包括捕捉季节性周期性的AR和MA项。例如，当使用月度数据且季节效应长度为1年时，季节性AR和MA项将反映这个特定的滞后长度。
- en: The ARIMAX(*p*, *d*, *q*) model then becomes a SARIMAX(*p*, *d*, *q*) × (*P*,
    *D*, *Q*) model, which is a bit more complicated to write out, but the statsmodels
    documentation (see link on GitHub) provides this information in detail.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: ARIMAX(*p*, *d*, *q*)模型然后变成了SARIMAX(*p*, *d*, *q*) × (*P*, *D*, *Q*)模型，这样写起来有点复杂，但statsmodels文档（GitHub上的链接）提供了详细信息。
- en: We will now build a seasonal ARMA model using macro-data to illustrate its implementation.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将使用宏观数据构建一个季节性ARMA模型，以说明其实施。
- en: How to forecast macro fundamentals
  id: totrans-164
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何预测宏观基本面
- en: 'We will build a SARIMAX model for monthly data on an industrial production
    time series for the 1988-2017 period. As illustrated in the first section on analytical
    tools, the data has been log-transformed, and we are using seasonal (lag-12) differences.
    We estimate the model for a range of both ordinary and conventional AR and MA
    parameters using a rolling window of 10 years of training data, and evaluate the
    **root mean square error** (**RMSE**) of the 1-step-ahead forecast, as shown in
    the following simplified code (see the notebook `arima_models` for details):'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将为1988-2017年工业生产时间序列构建一个SARIMAX模型。如在分析工具的第一部分所示，数据已经进行了对数变换，并且我们使用了季节性（滞后12期）差分。我们使用了10年的训练数据滚动窗口，估计了普通和传统AR和MA参数的一系列模型，并评估了1步预测的**均方根误差**（**RMSE**），如下简化的代码所示（有关详细信息，请参阅笔记本`arima_models`）：
- en: '[PRE1]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'We also collect the AIC and BIC criteria, which show a very high rank correlation
    coefficient of 0.94, with BIC favoring models with slightly fewer parameters than
    AIC. The best five models by RMSE are:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还收集了AIC和BIC标准，显示出非常高的秩相关系数为0.94，BIC偏好于比AIC略少参数的模型。前五个RMSE最佳模型为：
- en: '[PRE2]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'We reestimate a SARIMA(2, 0 ,3) × (1, 0, 0) model, as follows:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 我们重新估计了一个SARIMA(2, 0 ,3) × (1, 0, 0)模型，如下所示：
- en: '[PRE3]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'We obtain the following summary:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 我们得到以下摘要：
- en: '![](img/15439_09_05.png)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15439_09_05.png)'
- en: 'Figure 9.5: SARMAX model results'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.5：SARMAX模型结果
- en: 'The coefficients are significant, and the Q-statistic rejects the hypothesis
    of further autocorrelation. The correlogram similarly indicates that we have successfully
    eliminated the series'' autocorrelation:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 系数是显著的，Q统计拒绝了进一步自相关的假设。相关图表同样表明我们已成功消除了序列的自相关：
- en: '![](img/15439_09_06.png)'
  id: totrans-175
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15439_09_06.png)'
- en: 'Figure 9.6: SARIMAX model diagnostics'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.6：SARIMAX模型诊断
- en: How to use time-series models to forecast volatility
  id: totrans-177
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何使用时间序列模型预测波动性
- en: A particularly important application for univariate time-series models in finance
    is the prediction of volatility. This is because it is usually not constant over
    time, with bouts of volatility clustering together. Changes in variance create
    challenges for time-series forecasting using the classical ARIMA models that assume
    stationarity. To address this challenge, we will now model volatility so that
    we can predict changes in variance.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 金融领域中单变量时间序列模型的一个特别重要的应用是预测波动性。这是因为波动性通常不是随时间恒定的，而是出现波动性聚集的情况。方差的变化对于使用假设平稳性的经典ARIMA模型进行时间序列预测提出了挑战。为了解决这一挑战，我们现在将对波动性进行建模，以便我们可以预测方差的变化。
- en: Heteroskedasticity is the technical term for changes in a variable's variance.
    The ARCH model expresses the variance of the error term as a function of the errors
    in previous periods. More specifically, it assumes that the error variance follows
    an AR(*p*) model.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 异方差是变量方差变化的技术术语。ARCH模型将误差项的方差表示为先前时期的误差的函数。更具体地说，它假设误差方差遵循AR(*p*)模型。
- en: The **generalized autoregressive conditional heteroskedasticity** (**GARCH**)
    model broadens the scope of ARCH to allow for ARMA models. Time-series forecasting
    often combines ARIMA models for the expected mean and ARCH/GARCH models for the
    expected variance of a time series. The 2003 Nobel Prize in Economics was awarded
    to Robert Engle and Clive Granger for developing this class of models. The former
    also runs the Volatility Lab at New York University's Stern School ([vlab.stern.nyu.edu](http://vlab.stern.nyu.edu)),
    which has numerous online examples and tools concerning the models we will discuss.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: '**广义自回归条件异方差**（**GARCH**）模型将ARCH的范围扩大到允许ARMA模型。时间序列预测通常将ARIMA模型用于预期均值，将ARCH/GARCH模型用于预期时间序列的方差。2003年诺贝尔经济学奖授予了罗伯特·恩格尔和克莱夫·格兰杰，因为他们开发了这一类模型。前者还在纽约大学斯特恩商学院运行波动性实验室（[vlab.stern.nyu.edu](http://vlab.stern.nyu.edu)），该实验室有许多关于我们将讨论的模型的在线示例和工具。'
- en: The ARCH model
  id: totrans-181
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ARCH模型
- en: The ARCH(*p*) model is simply an AR(*p*) model that's applied to the variance
    of the residuals of a time-series model, which makes this variance at time *t*
    conditional on lagged observations of the variance.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: ARCH(*p*)模型只是应用于时间序列模型残差的方差的AR(*p*)模型，这使得时间*t*的方差取决于滞后观测的方差。
- en: 'More specifically, the error terms, ![](img/B15439_09_043.png), are residuals
    of a linear model, such as ARIMA, on the original time series and are split into
    a time-dependent standard deviation, ![](img/B15439_09_044.png), and a disturbance,
    *z*[t], as follows:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 更具体地说，误差项，![](img/B15439_09_043.png)，是原始时间序列上ARIMA等线性模型的残差，并分为时间相关标准差，![](img/B15439_09_044.png)，和扰动*z*[t]，如下所示：
- en: '![](img/B15439_09_045.png)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_045.png)'
- en: An ARCH(*p*) model can be estimated using OLS. Engle proposed a method to identify
    the appropriate ARCH order using the Lagrange multiplier test, which corresponds
    to the F-test of the hypothesis that all coefficients in linear regression are
    zero (see *Chapter 7*, *Linear Models – From Risk Factors to Return Forecasts*).
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用OLS来估计ARCH(*p*)模型。Engle提出了一种方法来使用拉格朗日乘子检验来确定适当的ARCH阶数，这对应于线性回归中所有系数为零的F检验（见*第7章*，*线性模型-从风险因素到收益预测*）。
- en: A key **strength** of the ARCH model is that it produces volatility estimates
    with positive excess kurtosis — that is, fat tails relative to the normal distribution
    — which, in turn, is in line with empirical observations about returns. **Weaknesses**
    include the assumption of the same effect for positive and negative volatility
    shocks, whereas asset prices tend to respond differently. It also does not explain
    the variations in volatility and is likely to overpredict volatility because they
    respond slowly to large, isolated shocks to the return series.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: ARCH模型的一个关键**优势**是它产生具有正偏峰度的波动性估计-即相对于正态分布的厚尾-这与关于收益的实证观察一致。**弱点**包括假设正面和负面波动性冲击具有相同的效应，而资产价格往往会有不同的反应。它也不能解释波动性的变化，并且很可能会过度预测波动性，因为它对于大的孤立冲击的反应较慢。
- en: For a properly specified ARCH model, the standardized residuals (divided by
    the model estimate for the period of standard deviation) should resemble white
    noise and can be subjected to a Ljung-Box Q test.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 对于正确规范的ARCH模型，标准化残差（除以标准差期间的模型估计）应该类似于白噪声，并且可以接受Ljung-Box Q检验。
- en: Generalizing ARCH – the GARCH model
  id: totrans-188
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 广义ARCH - GARCH模型
- en: 'The ARCH model is relatively simple but often requires many parameters to capture
    the volatility patterns of an asset-return series. The GARCH model applies to
    a log-return series, *r*[t], with disturbances, ![](img/B15439_09_046.png), that
    follow a GARCH(*p*, *q*) model if:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: ARCH模型相对简单，但通常需要许多参数来捕捉资产收益系列的波动性模式。GARCH模型适用于对数收益系列*r*[t]，具有扰动项，如下图所示，如果其遵循GARCH(*p*,
    *q*)模型：
- en: '![](img/B15439_09_047.png)'
  id: totrans-190
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_047.png)'
- en: The GARCH(*p*, *q*) model assumes an ARMA(*p*, *q*) model for the variance of
    the error term, ![](img/B15439_09_048.png).
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: GARCH(*p*, *q*)模型假设误差项的方差遵循ARMA(*p*, *q*)模型，如下图所示：
- en: Similar to ARCH models, the tail distribution of a GARCH(1,1) process is heavier
    than that of a normal distribution. The model encounters the same weaknesses as
    the ARCH model. For instance, it responds equally to positive and negative shocks.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 类似于ARCH模型，GARCH(1,1)过程的尾部分布比正态分布更重。该模型遇到与ARCH模型相同的弱点。例如，它对正面和负面冲击的反应是相同的。
- en: To configure the lag order for ARCH and GARCH models, use the squared residuals
    of the time series trained to predict the mean of the original series. The residuals
    are zero-centered so that their squares are also the variance. Then, inspect the
    ACF and PACF plots of the squared residuals to identify autocorrelation patterns
    in the variance of the time series.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 要为ARCH和GARCH模型配置滞后阶数，请使用训练以预测原始系列均值的时间序列的平方残差。残差被零居中，因此它们的平方也是方差。然后，检查平方残差的ACF和PACF图，以识别时间序列方差中的自相关模式。
- en: How to build a model that forecasts volatility
  id: totrans-194
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 如何构建预测波动性的模型
- en: 'The development of a volatility model for an asset-return series consists of
    four steps:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 为资产收益系列开发波动性模型包括四个步骤：
- en: Build an ARMA time-series model for the financial time series based on the serial
    dependence revealed by the ACF and PACF
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据ACF和PACF显示的串行依赖关系构建金融时间序列的ARMA时间序列模型
- en: Test the residuals of the model for ARCH/GARCH effects, again relying on the
    ACF and PACF for the series of the squared residual
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 再次依靠ACF和PACF检查模型的残差是否存在ARCH/GARCH效应
- en: Specify a volatility model if serial correlation effects are significant, and
    jointly estimate the mean and volatility equations
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果串行相关效应显著，则指定波动性模型，并联合估计均值和波动性方程
- en: Check the fitted model carefully and refine it if necessary
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 仔细检查拟合模型，并在必要时进行调整
- en: When applying volatility forecasting to return series, the serial dependence
    may be limited so that a constant mean may be used instead of an ARMA model.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 在将波动性预测应用于收益系列时，串行依赖关系可能有限，因此可以使用恒定均值而不是ARMA模型。
- en: The `arch` library (see link to the documentation on GitHub) provides several
    options to estimate volatility-forecasting models. You can model the expected
    mean as a constant, as an AR(*p*) model, as discussed in the *How to build autoregressive
    models*, section or as more recent **heterogeneous autoregressive processes**
    (**HAR**), which use daily (1 day), weekly (5 days), and monthly (22 days) lags
    to capture the trading frequencies of short-, medium-, and long-term investors.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: '`arch`库（请参阅GitHub上的文档链接）提供了几种选项来估计波动性预测模型。您可以将预期均值建模为常数，也可以建模为AR(*p*)模型，如“如何构建自回归模型”部分所讨论的那样，或者作为更近期的**异质自回归过程**（**HAR**），它使用每日（1天）、每周（5天）和每月（22天）滞后来捕捉短期、中期和长期投资者的交易频率。'
- en: The mean models can be jointly defined and estimated with several conditional
    heteroskedasticity models that include, in addition to ARCH and GARCH, the **exponential
    GARCH** (**EGARCH**) model, which allows for asymmetric effects between positive
    and negative returns, and the **heterogeneous ARCH** (**HARCH**) model, which
    complements the HAR mean model.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 均值模型可以与几种条件异方差模型一起定义和估计，除了ARCH和GARCH之外，还包括**指数GARCH**（**EGARCH**）模型，它允许正面和负面收益之间的非对称效应，以及**异质ARCH**（**HARCH**）模型，它补充了HAR均值模型。
- en: 'We will use daily NASDAQ returns from 2000-2020 to demonstrate the usage of
    a GARCH model (see the notebook `arch_garch_models` for details):'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用2000年至2020年的每日纳斯达克收益来演示GARCH模型的使用（有关详细信息，请参阅笔记本`arch_garch_models`）：
- en: '[PRE4]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The rescaled daily return series exhibits only limited autocorrelation, but
    the squared deviations from the mean do have substantial memory reflected in the
    slowly decaying ACF and the PACF, which are high for the first two and cut off
    only after the first six lags:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 重新缩放的日收益系列只表现出有限的自相关性，但是与均值的平方偏差确实具有实质性的记忆，反映在缓慢衰减的ACF和PACF中，前两个滞后期的值很高，在第六个滞后期之后才截断：
- en: '[PRE5]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The function `plot_correlogram` produces the following output:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 函数`plot_correlogram`生成以下输出：
- en: '![](img/15439_09_07.png)'
  id: totrans-208
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15439_09_07.png)'
- en: 'Figure 9.7: Daily NASDAQ composite volatility'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.7：每日纳斯达克综合波动性
- en: Hence, we can estimate a GARCH model to capture the linear relationship of past
    volatilities. We will use rolling 10-year windows to estimate a GARCH(*p*, *q*)
    model with *p* and *q* ranging from 1-4 to generate one-step out-of-sample forecasts.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们可以估计一个GARCH模型来捕捉过去波动性的线性关系。我们将使用滚动10年窗口来估计一个GARCH(*p*, *q*)模型，其中*p*和*q*的范围为1-4，以生成一步外样本预测。
- en: 'We then compare the RMSE of the predicted volatility relative to the actual
    squared deviation of the return from its mean to identify the most predictive
    model. We are using winsorized data to limit the impact of extreme return values
    being reflected in the very high positive skew of the volatility:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们比较预测波动性的RMSE与实际收益的平方偏差相对于其均值，以确定最具预测性的模型。我们使用winsorized数据来限制极端收益值对波动性非常高的正偏态的影响：
- en: '[PRE6]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The GARCH(2, 2) model achieves the lowest RMSE (same value as GARCH(4, 2) but
    with fewer parameters), so we go ahead and estimate this model to inspect the
    summary:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: GARCH(2, 2)模型实现了最低的RMSE（与GARCH(4, 2)相同，但参数更少），因此我们继续估计这个模型以检查摘要：
- en: '[PRE7]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The output shows the maximized log-likelihood, as well as the AIC and BIC criteria,
    which are commonly minimized when selecting models based on in-sample performance
    (see *Chapter 7*, *Linear Models – From Risk Factors to Return Forecasts*). It
    also displays the result for the mean model, which, in this case, is just a constant
    estimate, as well as the GARCH parameters for the constant omega, the AR parameters,
    ![](img/B15439_09_049.png), and the MA parameters, ![](img/B15439_09_050.png),
    all of which are statistically significant:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 输出显示了最大化的对数似然，以及AIC和BIC标准，通常在选择基于样本内表现的模型时进行最小化（见*第7章*，*线性模型-从风险因素到收益预测*）。它还显示了均值模型的结果，在这种情况下，只是一个常数估计，以及常数omega的GARCH参数，AR参数，![](img/B15439_09_049.png)，和MA参数，![](img/B15439_09_050.png)，所有这些都是统计显著的：
- en: '![](img/15439_09_08.png)'
  id: totrans-216
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15439_09_08.png)'
- en: 'Figure 9.8: GARCH Model results'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.8：GARCH模型结果
- en: Let's now explore models for multiple time series and the concept of cointegration,
    which will enable a new trading strategy.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们探索多个时间序列的模型和协整概念，这将使新的交易策略成为可能。
- en: Multivariate time-series models
  id: totrans-219
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 多变量时间序列模型
- en: Multivariate time-series models are designed to capture the dynamic of multiple
    time series simultaneously and leverage dependencies across these series for more
    reliable predictions. The most comprehensive introduction to this subject is Lütkepohl
    (2005).
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 多变量时间序列模型旨在同时捕捉多个时间序列的动态，并利用这些序列之间的依赖关系进行更可靠的预测。关于这个主题最全面的介绍是Lütkepohl（2005）。
- en: Systems of equations
  id: totrans-221
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 方程组
- en: 'Univariate time-series models, like the ARMA approach we just discussed, are
    limited to statistical relationships between a target variable and its lagged
    values or lagged disturbances and exogenous series, in the case of ARMAX. In contrast,
    multivariate time-series models also allow for lagged values of other time series
    to affect the target. This effect applies to all series, resulting in complex
    interactions, as illustrated in the following diagram:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 单变量时间序列模型，就像我们刚讨论的ARMA方法一样，局限于目标变量与其滞后值或滞后扰动以及外生序列之间的统计关系，对于ARMAX来说也是如此。相比之下，多变量时间序列模型还允许其他时间序列的滞后值影响目标变量。这种影响适用于所有序列，导致复杂的交互作用，如下图所示：
- en: '![](img/15439_09_09.png)'
  id: totrans-223
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15439_09_09.png)'
- en: 'Figure 9.9: Interactions in univariate and multivariate time-series models'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.9：单变量和多变量时间序列模型中的交互作用
- en: In addition to potentially better forecasting, multivariate time series are
    also used to gain insights into cross-series dependencies. For example, in economics,
    multivariate time series are used to understand how policy changes to one variable,
    such as an interest rate, may affect other variables over different horizons.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 除了可能更好的预测外，多变量时间序列还用于获得跨序列依赖关系的见解。例如，在经济学中，多变量时间序列用于了解对一个变量的政策变化，例如利率，可能在不同的时间跨度内影响其他变量。
- en: The **impulse-response** function produced by the multivariate model serves
    this purpose and allows us to simulate how one variable responds to a sudden change
    in other variables. The concept of **Granger causality** analyzes whether one
    variable is useful in forecasting another (in the least-squares sense). Furthermore,
    multivariate time-series models allow for a decomposition of the prediction error
    variance to analyze how other series contribute.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 多变量模型产生的**冲击-响应**函数用于模拟一个变量如何对其他变量的突然变化做出响应。**Granger因果关系**的概念分析了一个变量是否对另一个变量的预测有用（以最小二乘意义上）。此外，多变量时间序列模型允许对预测误差方差进行分解，以分析其他序列如何贡献。
- en: The vector autoregressive (VAR) model
  id: totrans-227
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 向量自回归（VAR）模型
- en: 'We will see how the **vector autoregressive VAR(p) model** extends the AR(*p*)
    model to *k* series by creating a system of *k* equations, where each contains
    *p* lagged values of all *k* series. In the simplest case, a VAR(1) model for
    *k*=2 takes the following form:'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将看到**向量自回归VAR(p)模型**如何通过创建包含*p*个滞后值的所有*k*个系列的系统来扩展AR(*p*)模型。在最简单的情况下，*k*=2的VAR(1)模型采用以下形式：
- en: '![](img/B15439_09_051.png)'
  id: totrans-229
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_051.png)'
- en: 'This model can be expressed somewhat more concisely in **matrix form**:'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 这个模型可以用**矩阵形式**更加简洁地表示：
- en: '![](img/B15439_09_052.png)'
  id: totrans-231
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_052.png)'
- en: 'The **coefficients** on the lagged values of the output provide information
    about the dynamics of the series itself, whereas the cross-variable coefficients
    offer some insight into the interactions across the series. This notation extends
    to *k* time series and order *p*, as follows:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 输出中的输出系数提供了关于系列本身动态的信息，而交叉变量系数则提供了一些关于系列之间交互作用的见解。这种符号扩展到*k*个时间序列和*p*阶，如下所示：
- en: '![](img/B15439_09_053.png)'
  id: totrans-233
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_053.png)'
- en: VAR(*p*) models also require **stationarity** so that the initial steps from
    univariate time-series modeling carry over. First, explore the series and determine
    the necessary transformations. Then, apply the augmented Dickey-Fuller test to
    verify that the stationarity criterion is met for each series and apply further
    transformations otherwise. It can be estimated with an OLS conditional on initial
    information or with MLE, which is the equivalent for normally distributed errors
    but not otherwise.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: VAR(*p*)模型也需要**平稳性**，以便从单变量时间序列建模的初始步骤延续。首先，探索系列并确定必要的转换。然后，应用增广迪基-福勒检验来验证每个系列是否满足平稳性标准，否则进行进一步的转换。它可以根据初始信息进行OLS估计，也可以进行MLE估计，对于正态分布的误差是等价的，但对于其他情况则不是。
- en: If some or all of the *k* series are unit-root non-stationary, they may be **cointegrated**
    (see the next section). This extension of the unit root concept to multiple time
    series means that a linear combination of two or more series is stationary and,
    hence, mean-reverting.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 如果一些或所有的*k*系列是单位根非平稳的，它们可能是**协整**的（请参阅下一节）。将单位根概念扩展到多个时间序列意味着两个或更多系列的线性组合是稳定的，因此是均值回归的。
- en: The VAR model is not equipped to handle this case without differencing; instead,
    use the **vector error correction model** (**VECM**, Johansen and Juselius 1990).
    We will further explore cointegration because, if present and assumed to persist,
    it can be leveraged for a pairs-trading strategy.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: VAR模型没有处理这种情况的能力，而是使用**向量误差校正模型**（**VECM**，Johansen和Juselius 1990）。我们将进一步探讨协整，因为如果存在并且假定持续存在，可以利用它进行配对交易策略。
- en: The **determination of the lag order** also takes its cues from the ACF and
    PACF for each series, but is constrained by the fact that the same lag order applies
    to all series. After model estimation, **residual diagnostics** also call for
    a result resembling white noise, and model selection can use in-sample information
    criteria or, if the goal is to use the model for prediction, out-of-sample predictive
    performance to cross-validate alternative model designs.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: '**滞后阶数的确定**也受到每个系列的ACF和PACF的启发，但受到相同滞后阶数适用于所有系列的限制。在模型估计之后，**残差诊断**还需要产生类似白噪声的结果，并且模型选择可以使用样本内信息标准，或者如果目标是使用模型进行预测，则可以使用样本外预测性能来交叉验证替代模型设计。'
- en: As mentioned in the univariate case, predictions of the original time series
    require us to reverse the transformations applied to make a series stationary
    before training the model.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 如在单变量情况下所述，对原始时间序列的预测要求我们撤销应用于使时间序列稳定的转换。
- en: Using the VAR model for macro forecasts
  id: totrans-239
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用VAR模型进行宏观预测
- en: 'We will extend the univariate example of using a single time series of monthly
    data on industrial production and add a monthly time series on consumer sentiment,
    both of which are provided by the Federal Reserve''s data service. We will use
    the familiar pandas-datareader library to retrieve data from 1970 through 2017:'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将扩展使用单个时间序列的单变量示例，该时间序列包括工业生产的月度数据和美联储数据服务提供的消费者情绪的月度时间序列。我们将使用熟悉的pandas-datareader库从1970年到2017年检索数据：
- en: '[PRE8]'
  id: totrans-241
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Log-transforming the industrial production series and seasonal differencing
    using a lag of 12 for both series yields stationary results:'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 对工业生产系列进行对数转换，并使用12个滞后期进行季节性差分，可以得到稳定的结果：
- en: '[PRE9]'
  id: totrans-243
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'This leaves us with the following series:'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 这给我们留下了以下系列：
- en: '![](img/15439_09_10.png)'
  id: totrans-245
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15439_09_10.png)'
- en: 'Figure 9.10: Transformed time series: industrial production and consumer sentiment'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.10：转换后的时间序列：工业生产和消费者情绪
- en: 'To limit the size of the output, we will just estimate a VAR(1) model using
    the statsmodels `VARMAX` implementation (which allows for optional exogenous variables)
    with a constant trend using the first 480 observations:'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 为了限制输出的大小，我们将只使用statsmodels的`VARMAX`实现（允许使用可选的外生变量）来估计一个具有恒定趋势的VAR(1)模型，使用前480个观测值：
- en: '[PRE10]'
  id: totrans-248
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'This produces the following summary:'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 这产生了以下摘要：
- en: '![](img/15439_09_11.png)'
  id: totrans-250
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15439_09_11.png)'
- en: 'Figure 9.11: VAR(1) model results'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.11：VAR(1)模型结果
- en: 'The output contains the coefficients for both time-series equations, as outlined
    in the preceding VAR(1) illustration. statsmodels provides diagnostic plots to
    check whether the residuals meet the white noise assumptions. This is not exactly
    the case in this simple example because the variance does not appear to be constant
    (upper left) and the quantile plot shows differences in the distribution, namely
    fat tails (lower left):'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 输出包含了两个时间序列方程的系数，如前述的VAR(1)示例所述。statsmodels提供了诊断图来检查残差是否符合白噪声的假设。在这个简单的例子中并非完全如此，因为方差似乎不是恒定的（左上）并且分位数图显示了分布的差异，即尾部较厚（左下）：
- en: '![](img/15439_09_12.png)'
  id: totrans-253
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15439_09_12.png)'
- en: 'Figure 9.12: statsmodels VAR model diagnostic plot'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.12：statsmodels VAR模型诊断图
- en: 'You can generate out-of-sample predictions as follows:'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以按以下方式生成样本外预测：
- en: '[PRE11]'
  id: totrans-256
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'The following visualization of actual and predicted values shows how the prediction
    lags the actual values and does not capture nonlinear, out-of-sample patterns
    well:'
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 以下的实际值和预测值的可视化显示了预测滞后于实际值，并且不能很好地捕捉非线性的样本外模式：
- en: '![](img/15439_09_13.png)'
  id: totrans-258
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15439_09_13.png)'
- en: 'Figure 9.13: VAR model predictions versus actuals'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.13：VAR模型预测与实际值
- en: Cointegration – time series with a shared trend
  id: totrans-260
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 协整-具有共享趋势的时间序列
- en: We briefly mentioned cointegration in the previous section on multivariate time-series
    models. Let's now explain this concept and how to diagnose its presence in more
    detail before leveraging it for a statistical arbitrage trading strategy.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在上一节关于多变量时间序列模型中简要提到了协整。现在让我们更详细地解释这个概念以及如何诊断其存在，然后利用它进行统计套利交易策略。
- en: We have seen how a time series can have a unit root that creates a stochastic
    trend and makes the time series highly persistent. When we use such an integrated
    time series in their original, rather than in differenced, form as a feature in
    a linear regression model, its relationship with the outcome will often appear
    statistically significant, even though it is not. This phenomenon is called spurious
    regression (for details, see *Chapter 18*, *CNNs for Financial Time Series and
    Satellite Images*, in Wooldridge, 2008). Therefore, the recommended solution is
    to difference the time series so they become stationary before using them in a
    model.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经看到时间序列可以具有单位根，从而产生随机趋势，并使时间序列高度持久。当我们在线性回归模型中使用这样的积分时间序列作为特征时，其与结果的关系通常会显得统计上显著，即使实际上并非如此。这种现象称为伪回归（有关详细信息，请参阅Wooldridge,
    2008年的*第18章*，*金融时间序列和卫星图像的CNNs*）。因此，建议的解决方案是在将时间序列用于模型之前对其进行差分处理，使其变得稳定。
- en: However, there is an exception when there are cointegration relationships between
    the outcome and one or more input variables. To understand the concept of cointegration,
    let's first remember that the residuals of a regression model are a linear combination
    of the inputs and the output series.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，当结果与一个或多个输入变量之间存在协整关系时，就会有一个例外。要理解协整的概念，首先要记住回归模型的残差是输入和输出系列的线性组合。
- en: 'Usually, the residuals of the regression of one integrated time series on one
    or more such series yields non-stationary residuals that are also integrated,
    and thus behave like a random walk. However, for some time series, this is not
    the case: the regression produces coefficients that yield a linear combination
    of the time series in the form of the residuals that are stationary, even though
    the individual series are not. Such time series are *cointegrated*.'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，一个积分时间序列对一个或多个这样的系列的回归产生的残差是非平稳的，也是积分的，因此表现得像一个随机游走。然而，对于一些时间序列，情况并非如此：回归产生的系数产生了时间序列的线性组合，形式上是平稳的残差，尽管个别系列不是。这样的时间序列是协整的。
- en: A non-technical example is that of a drunken man on a random walk accompanied
    by his dog (on a leash). Both trajectories are non-stationary but cointegrated
    because the dog will occasionally revert to his owner. In the trading context,
    arbitrage constraints imply cointegration between spot and futures prices.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 一个非技术的例子是一个醉酒的人在随机行走，带着他的狗（牵着绳子）。两者轨迹都是非平稳的，但协整，因为狗偶尔会回到主人身边。在交易背景下，套利约束意味着现货和期货价格之间存在协整。
- en: In other words, a **linear combination of two or more cointegrated series has
    a stable mean** to which this linear combination reverts. This also applies when
    the individual series are integrated of a higher order and the linear combination
    reduces the overall order of integration.
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，两个或更多协整系列的线性组合具有稳定的均值，这个线性组合会回归到这个稳定的均值。当个别系列是更高阶的积分时，线性组合减少了整体的积分阶数，这也适用。
- en: '**Cointegration differs from correlation**: two series can be highly correlated
    but need not be cointegrated. For example, if two growing series are constant
    multiples of each other, their correlation will be high, but any linear combination
    will also grow rather than revert to a stable mean.'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 协整与相关性不同：两个系列可以高度相关，但不一定是协整的。例如，如果两个增长系列是彼此的常数倍数，它们的相关性将很高，但任何线性组合也会增长而不是回归到稳定的均值。
- en: 'Cointegration is very useful: if two or more asset price series tend to revert
    to a common mean, we can leverage deviations from the trend because they should
    imply future price moves in the opposite direction. The mathematics behind cointegration
    is more involved, so we will only focus on the practical aspects; for an in-depth
    treatment, see Lütkepohl (2005).'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 协整非常有用：如果两个或更多资产价格系列倾向于回归到一个共同的均值，我们可以利用趋势的偏离，因为它们应该意味着未来价格的移动方向相反。协整背后的数学更复杂，因此我们只关注实际方面；要进行深入的处理，请参阅Lütkepohl（2005）。
- en: In this section, we will address how we can identify pairs with such a long-term
    stationary relationship, estimate the expected time for any disequilibrium to
    correct, and how to utilize these tools to implement and backtest a long-short
    pairs trading strategy.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将讨论如何识别具有长期稳定关系的配对，估计任何失衡纠正的预期时间，以及如何利用这些工具来实施和回测一个多空配对交易策略。
- en: 'There are two approaches to testing for cointegration:'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 有两种方法可以测试协整性：
- en: The Engle-Granger two-step method
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Engle-Granger两步法
- en: The Johansen test
  id: totrans-272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 约翰逊检验
- en: We'll discuss each in turn before we show how they help identify cointegrated
    securities that tend to revert to a common trend, a fact that we can leverage
    for a statistical arbitrage strategy.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 在展示它们如何帮助识别倾向于回归到共同趋势的协整证券之前，我们将依次讨论每一种方法，这是我们可以利用的事实，用于统计套利策略。
- en: The Engle-Granger two-step method
  id: totrans-274
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Engle-Granger两步法
- en: 'The **Engle-Granger method** is used to identify cointegration relationships
    between two series. It involves both of the following:'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: Engle-Granger方法用于识别两个系列之间的协整关系。它包括以下两个方面：
- en: Regressing one series on another to estimate the stationary long-term relationship
  id: totrans-276
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对另一个系列进行回归以估计长期稳定关系
- en: Applying an ADF unit-root test to the regression residual
  id: totrans-277
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将ADF单位根检验应用于回归残差
- en: The null hypothesis is that the residuals have a unit root and are integrated;
    if we can reject it, then we assume that the residuals are stationary and, thus,
    the series are cointegrated (Engle and Granger 1987).
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 零假设是残差具有单位根并且是积分的；如果我们能够拒绝它，那么我们假设残差是平稳的，因此，系列是协整的（Engle and Granger 1987）。
- en: A key benefit of this approach is that the regression coefficient represents
    the multiplier that renders the combination stationary, that is, mean-reverting.
    Unfortunately, the test results will differ, depending on which variable we consider
    independent, so that we try both ways and then pick the relation with the more
    negative test statistic that has the lower p-value.
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 这种方法的一个关键优点是回归系数代表了使组合平稳的乘数，也就是说，均值回归。不幸的是，测试结果会有所不同，取决于我们考虑哪个变量是独立的，因此我们尝试两种方式，然后选择具有更负的检验统计量和更低p值的关系。
- en: Another downside is that this test is limited to pairwise relationships. The
    more complex Johansen procedure can identify significant cointegration among up
    to a dozen time series.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个缺点是这个测试局限于成对关系。更复杂的约翰逊程序可以识别多达十几个时间序列之间的显著协整。
- en: The Johansen likelihood-ratio test
  id: totrans-281
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 约翰逊似然比检验
- en: 'The **Johansen procedure**, in contrast, tests the restrictions imposed by
    cointegration on a VAR model, as discussed in the previous section. More specifically,
    after subtracting the target vector from both sides of a generic VAR(*p*) model,
    we obtain the **error correction model** (**ECM**) formulation:'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 相比之下，约翰逊程序测试了协整对VAR模型施加的限制，如前一节所讨论的。更具体地说，在从通用VAR（p）模型的两侧减去目标向量之后，我们得到了误差修正模型（ECM）的公式：
- en: '![](img/B15439_09_054.png)'
  id: totrans-283
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_09_054.png)'
- en: The resulting modified VAR(*p*) equation has only one vector term in levels
    (*y*[t][-1]) that is not expressed as a difference using the ![](img/B15439_09_055.png)
    operator. The nature of cointegration depends on the rank of the coefficient matrix
    ![](img/B15439_09_056.png) of this term (Johansen 1991).
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 由此产生的修改后的VAR（*p*）方程只有一个在水平上的向量项（*y*[t][-1]），它不是使用![](img/B15439_09_055.png)运算符表示的差异。协整的性质取决于这个项的系数矩阵![](img/B15439_09_056.png)的秩（约翰森1991）。
- en: While this equation appears structurally similar to the ADF test setup, there
    are now several potential constellations of common trends because there are multiple
    series involved. To identify the number of cointegration relationships, the Johansen
    test successively tests for an increasing rank of ![](img/B15439_09_057.png),
    starting at 0 (no cointegration). We will explore the application to the case
    of two series in the following section.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然这个方程在结构上看起来与ADF测试设置相似，但由于涉及多个系列，现在存在多种潜在的共同趋势。为了确定协整关系的数量，约翰森测试依次测试递增秩的![](img/B15439_09_057.png)，从0开始（没有协整）。我们将在下一节探讨两个系列的应用。
- en: Gonzalo and Lee (1998) discuss practical challenges due to misspecified model
    dynamics and other implementation aspects, including how to combine both test
    procedures that we will rely on for our sample statistical arbitrage strategy
    in the next section.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 冈萨洛和李（1998年）讨论了由于错误指定的模型动态和其他实施方面的实际挑战，包括如何结合我们将在下一节中依赖的两种测试程序，用于我们的样本统计套利策略。
- en: Statistical arbitrage with cointegration
  id: totrans-287
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 具有协整的统计套利
- en: Statistical arbitrage refers to strategies that employ some statistical model
    or method to take advantage of what appears to be relative mispricing of assets,
    while maintaining a level of market neutrality.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 统计套利是指利用某种统计模型或方法来利用资产的相对错误定价，同时保持一定的市场中性水平的策略。
- en: '**Pairs trading** is a conceptually straightforward strategy that has been
    employed by algorithmic traders since at least the mid-eighties (Gatev, Goetzmann,
    and Rouwenhorst 2006). The goal is to find two assets whose prices have historically
    moved together, track the spread (the difference between their prices), and, once
    the spread widens, buy the loser that has dropped below the common trend and short
    the winner. If the relationship persists, the long and/or the short leg will deliver
    profits as prices converge and the positions are closed.'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: '**配对交易**是一个概念上简单的策略，自至少上世纪八十年代中期以来就被算法交易员采用（Gatev，Goetzmann和Rouwenhorst 2006）。其目标是找到两个价格历史上移动在一起的资产，跟踪价差（它们价格之间的差异），一旦价差扩大，买入跌破共同趋势的失败者并卖空赢家。如果关系持续存在，长期和/或短期将在价格收敛时交付利润，并且头寸被平仓。'
- en: This approach extends to a multivariate context by forming baskets from multiple
    securities and trading one asset against a basket of two baskets against each
    other.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 这种方法通过从多个证券形成篮子，并将一个资产交易对抗两个篮子相互交易来扩展到多元情境。
- en: 'In practice, the strategy requires two steps:'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 在实践中，该策略需要两个步骤：
- en: '**Formation phase**: Identify securities that have a long-term mean-reverting
    relationship. Ideally, the spread should have a high variance to allow for frequent
    profitable trades while reliably reverting to the common trend.'
  id: totrans-292
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**形成阶段**：确定具有长期均值回归关系的证券。理想情况下，价差应该具有较高的方差，以便进行频繁的盈利交易，同时可靠地回归到共同趋势。'
- en: '**Trading phase**: Trigger entry and exit trading rules as price movements
    cause the spread to diverge and converge.'
  id: totrans-293
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**交易阶段**：当价格波动导致价差发散和收敛时触发入场和出场交易规则。'
- en: Several approaches to the formation and trading phases have emerged from increasingly
    active research in this area, across multiple asset classes, over the last several
    years. The next subsection outlines the key differences before we dive into an
    example application.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一领域的日益活跃的研究中，过去几年来出现了多种资产类别的形成和交易阶段的不同方法。下一小节概述了在我们深入研究示例应用之前的主要区别。
- en: How to select and trade comoving asset pairs
  id: totrans-295
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何选择和交易共同移动的资产对
- en: 'A recent comprehensive survey of pairs trading strategies (Krauss 2017) identified
    four different methodologies, plus a number of other more recent approaches, including
    ML-based forecasts:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 最近对配对交易策略的全面调查（Krauss 2017）确定了四种不同的方法，以及一些更近期的方法，包括基于机器学习的预测：
- en: '**Distance approach**: The oldest and most-studied method identifies candidate
    pairs with distance metrics like correlation and uses non-parametric thresholds
    like Bollinger Bands to trigger entry and exit trades. Its computational simplicity
    allows for large-scale applications with demonstrated profitability across markets
    and asset classes for extended periods of time since Gatev, et al. (2006). However,
    performance has decayed more recently.'
  id: totrans-297
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**距离方法**：最古老且最研究的方法使用距离度量（如相关性）识别候选对，并使用诸如布林带之类的非参数阈值来触发入场和出场交易。其计算简单性允许在Gatev等人（2006年）以来的较长时期内跨市场和资产类别进行大规模应用，并证明了盈利能力。然而，最近的表现有所下降。'
- en: '**Cointegration approach**: As outlined previously, this approach relies on
    an econometric model of a long-term relationship among two or more variables,
    and allows for statistical tests that promise more reliability than simple distance
    metrics. Examples in this category use the Engle-Granger and Johansen procedures
    to identify pairs and baskets of securities, as well as simpler heuristics that
    aim to capture the concept (Vidyamurthy 2004). Trading rules often resemble the
    simple thresholds used with distance metrics.'
  id: totrans-298
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**协整方法**：如前所述，这种方法依赖于两个或更多变量之间的长期关系的计量模型，并允许进行比简单距离度量更可靠的统计测试。该类别中的例子使用Engle-Granger和Johansen程序来识别证券的配对和篮子，以及更简单的试图捕捉这一概念的启发式方法（Vidyamurthy
    2004）。交易规则通常类似于与距离度量一起使用的简单阈值。'
- en: '**Time-series approach**: With a focus on the trading phase, strategies in
    this category aim to model the spread as a mean-reverting stochastic process and
    optimize entry and exit rules accordingly (Elliott, Hoek, and Malcolm 2005). It
    assumes promising pairs have already been identified.'
  id: totrans-299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 时间序列方法：这一类策略侧重于交易阶段，旨在将差价建模为均值回归的随机过程，并相应地优化入场和出场规则（Elliott, Hoek, and Malcolm
    2005）。它假设有希望的配对已经被识别出来。
- en: '**Stochastic control approach**: Similar to the time-series approach, the goal
    is to optimize trading rules using stochastic control theory to find value and
    policy functions to arrive at an optimal portfolio (Liu and Timmermann 2013).
    We will address this type of approach in *Chapter 21*, *Generative Adversarial
    Networks for Synthetic Time-Series Data*.'
  id: totrans-300
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 随机控制方法：与时间序列方法类似，其目标是使用随机控制理论优化交易规则，以找到价值和政策函数，从而得出最佳投资组合（Liu and Timmermann
    2013）。我们将在*第21章*，*用于合成时间序列数据的生成对抗网络*中讨论这种方法。
- en: '**Other approaches**: Besides pair identification based on unsupervised learning
    like principal component analysis (see *Chapter 13*, *Data-Driven Risk Factors
    and Asset Allocation with Unsupervised Learning*) and statistical models like
    copulas (Patton 2012), machine learning has become popular more recently to identify
    pairs based on their relative price or return forecasts (Huck 2019). We will cover
    several ML algorithms that can be used for this purpose and illustrate corresponding
    multivariate pairs trading strategies in the coming chapters.'
  id: totrans-301
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 其他方法：除了基于无监督学习的配对识别，如主成分分析（见*第13章*，*使用无监督学习的数据驱动风险因子和资产配置*）和统计模型，如copulas（Patton
    2012），机器学习最近变得更加流行，用于基于相对价格或收益预测识别配对（Huck 2019）。我们将在接下来的章节中介绍几种可用于此目的的ML算法，并说明相应的多变量配对交易策略。
- en: 'This summary of the various approaches offers barely a glimpse at the flexibility
    afforded by the design of a pairs trading strategy. In addition to higher-level
    questions about pair selection and trading rule logic, there are **numerous parameters**
    that we need **to define for implementation**. These parameters include the following:'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 这些方法的总结仅仅是对配对交易策略设计所提供的灵活性的一瞥。除了有关配对选择和交易规则逻辑的高层次问题之外，我们还需要为实施定义许多参数。
- en: Investment universe to screen for potential pairs or baskets
  id: totrans-303
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用于筛选潜在配对或篮子的投资范围
- en: Length of the formation period
  id: totrans-304
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 形成期的长度
- en: Strength of the relationship used to pick tradeable candidates
  id: totrans-305
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用于选择可交易候选者的关系强度
- en: Degree of deviation from and convergence to their common means to trigger entry
    or exit trades or to adjust existing positions as spreads fluctuate
  id: totrans-306
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从它们的共同均值的偏离程度和收敛程度来触发入场或出场交易，或者在价差波动时调整现有头寸
- en: Pairs trading in practice
  id: totrans-307
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 实践中的配对交易
- en: 'The **distance approach** identifies pairs using the correlation of (normalized)
    asset prices or their returns, and is simple and orders of magnitude less computationally
    intensive than cointegration tests. The notebook `cointegration_test` illustrates
    this for a sample of ~150 stocks with 4 years of daily data: it takes ~30ms to
    compute the correlation with the returns of an ETF, compared to 18 seconds for
    a suite of cointegration tests (using statsmodels) – 600x slower.'
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 距离方法使用（标准化的）资产价格或其收益的相关性来识别配对，简单且计算成本远低于协整性测试。笔记本`cointegration_test`为具有4年每日数据的约150支股票的样本说明了这一点：与ETF的收益相关性计算需要约30毫秒，而一套协整性测试需要18秒（使用statsmodels）-慢了600倍。
- en: The **speed advantage** is particularly valuable. This is because the number
    of potential pairs is the product of the number of candidates to be considered
    on either side so that evaluating combinations of 100 stocks and 100 ETFs requires
    comparing 10,000 tests (we'll discuss the challenge of multiple testing bias later).
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 速度优势尤为宝贵。这是因为潜在配对的数量是每一侧要考虑的候选者数量的乘积，因此评估100支股票和100个ETF的组合需要比较10,000次测试（我们将在后面讨论多重检验偏差的挑战）。
- en: 'On the other hand, distance metrics do not necessarily select the most profitable
    pairs: correlation is maximized for perfect co-movement, which, in turn, eliminates
    actual trading opportunities. Empirical studies confirm that the volatility of
    the price spread of cointegrated pairs is almost twice as high as the volatility
    of the price spread of distance pairs (Huck and Afawubo 2015).'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，距离度量不一定选择最有利可交易的配对：相关性在完美共同运动时最大化，这反过来消除了实际的交易机会。实证研究证实，协整配对的价格差价波动几乎是距离配对价格差价波动的两倍高（Huck
    and Afawubo 2015）。
- en: 'To balance the **tradeoff between computational cost and the quality of the
    resulting pairs**, Krauss (2017) recommends a procedure that combines both approaches
    based on his literature review:'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 为了平衡计算成本和所得配对质量之间的权衡，Krauss（2017）建议根据他的文献综述结合两种方法的程序：
- en: Select pairs with a stable spread that shows little drift to reduce the number
    of candidates
  id: totrans-312
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择具有稳定价差且显示很少漂移的配对，以减少候选者数量
- en: Test the remaining pairs with the highest spread variance for cointegration
  id: totrans-313
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用最高差价方差测试剩余的配对协整性
- en: This process aims to select cointegrated pairs with lower divergence risk while
    ensuring more volatile spreads that, in turn, generate higher profit opportunities.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 这个过程旨在选择协整配对，降低分歧风险，同时确保更加波动的价差，从而产生更高的利润机会。
- en: 'A large number of tests introduce **data snooping bias**, as discussed in *Chapter
    6*, *The Machine Learning Process*: multiple testing is likely to increase the
    number of false positives that mistakenly reject the null hypothesis of no cointegration.
    While statistical significance may not be necessary for profitable trading (Chan
    2008), a study of commodity pairs (Cummins and Bucca 2012) shows that controlling
    the familywise error rate to improve the tests'' power, according to Romano and
    Wolf (2010), can lead to better performance.'
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 大量测试引入了数据窥探偏差，如*第6章*“机器学习过程”中所讨论的：多重测试可能会增加错误拒绝无协整性的零假设的假阳性数量。虽然统计显著性对于盈利交易可能并非必要（Chan
    2008），但商品对的研究（Cummins和Bucca 2012）表明，根据Romano和Wolf（2010）的说法，控制家族错误率以提高测试的能力可以带来更好的表现。
- en: In the following subsection, we'll take a closer look at how predictive various
    heuristics for the degree of comovement of asset prices are for the result of
    cointegration tests.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的小节中，我们将更仔细地研究资产价格共同变动程度的各种启发式方法对协整性测试结果的预测能力。
- en: The example code uses a sample of 172 stocks and 138 ETFs traded on the NYSE
    and NASDAQ, with daily data from 2010 - 2019 provided by Stooq.
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 示例代码使用了在纽约证券交易所和纳斯达克交易的172只股票和138只ETF的样本，数据来自Stooq提供的2010年至2019年的每日数据。
- en: The securities represent the largest average dollar volume over the sample period
    in their respective class; highly correlated and stationary assets have been removed.
    See the notebook `create_datasets` in the `data` folder of the GitHub repository
    for instructions on how to obtain the data, and the notebook `cointegration_tests`
    for the relevant code and additional preprocessing and exploratory details.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 这些证券代表了它们各自类别在样本期间的最大平均美元交易量；高度相关和平稳的资产已被移除。有关如何获取数据的说明，请参阅GitHub存储库的`data`文件夹中的笔记本`create_datasets`，以及相关代码和其他预处理和探索细节的笔记本`cointegration_tests`。
- en: Distance-based heuristics to find cointegrated pairs
  id: totrans-319
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 基于距离的启发式方法来寻找协整对
- en: '`compute_pair_metrics()` computes the following distance metrics for over 23,000
    pairs of stocks and **Exchange Traded Funds** (**ETFs**) for 2010-14 and 2015-19:'
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: '`compute_pair_metrics()`计算了2010-14年和2015-19年超过23,000对股票和交易所交易基金（ETFs）的以下距离度量：'
- en: The **drift of the spread**, defined as a linear regression of a time trend
    on the spread
  id: totrans-321
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 价差的漂移，定义为时间趋势对价差的线性回归
- en: The **spread's volatility**
  id: totrans-322
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 价差的波动性
- en: The **correlations** between the normalized price series and between their returns
  id: totrans-323
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 标准化价格序列之间的相关性和它们的回报之间的相关性
- en: Low drift and volatility, as well as high correlation, are simple proxies for
    cointegration.
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 低漂移和波动性，以及高相关性，是协整的简单代理。
- en: To evaluate the predictive power of these heuristics, we also run **Engle-Granger
    and Johansen cointegration** tests using statsmodels for the preceding pairs.
    This takes place in the loop in the second half of `compute_pair_metrics()`.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 为了评估这些启发式方法的预测能力，我们还使用statsmodels对前述对运行Engle-Granger和Johansen协整性测试。这发生在`compute_pair_metrics()`的后半部分的循环中。
- en: 'We first estimate the optimal number of lags that we need to specify for the
    Johansen test. For both tests, we assume that the cointegrated series (the spread)
    may have an intercept different from zero but no trend:'
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先估计了我们需要为Johansen测试指定的滞后期的最佳数量。对于两个测试，我们假设协整序列（价差）可能具有与零不同的截距，但没有趋势：
- en: '[PRE12]'
  id: totrans-327
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: To check for the **significance of the cointegration tests**, we compare the
    Johansen trace statistic for rank 0 and 1 to their respective critical values
    and obtain the Engle-Granger p-value.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 为了检查协整性测试的显著性，我们将Johansen迹统计量的秩0和1与它们各自的临界值进行比较，并获得Engle-Granger的p值。
- en: 'We follow the recommendation by Gonzalo and Lee (1998), mentioned at the end
    of the previous section, to apply both tests and accept pairs where they agree.
    The authors suggest additional due diligence in case of disagreement, which we
    are going to skip:'
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 我们遵循Gonzalo和Lee（1998）在前一节末尾提到的建议，应用两个测试并接受它们一致的交易对。作者建议在出现分歧时进行额外的尽职调查，而我们将跳过：
- en: '[PRE13]'
  id: totrans-330
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: For the over 46,000 pairs across both sample periods, the Johansen test considers
    3.2 percent of the relationships as significant, while the Engle-Granger considers
    6.5 percent. They agree on 366 pairs (0.79 percent).
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 在两个样本期间的超过46,000对中，Johansen测试认为3.2%的关系是显著的，而Engle-Granger认为6.5%的关系是显著的。它们在366对（0.79%）上达成一致。
- en: How well do the heuristics predict significant cointegration?
  id: totrans-332
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 这些启发式方法对显著协整性的预测有多好？
- en: 'When we compare the distributions of the heuristics for series that are cointegrated
    according to both tests with the remainder that is not, volatility and drift are
    indeed lower (in absolute terms). *Figure 9.14* shows that the picture is less
    clear for the two correlation measures:'
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们比较根据两个测试都协整的系列和未协整的系列的启发式分布时，波动性和漂移确实较低（绝对值）。*图9.14*显示，对于两个相关性度量，情况并不那么清晰：
- en: '![](img/15439_09_14.png)'
  id: totrans-334
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15439_09_14.png)'
- en: 'Figure 9.14: The distribution of heuristics, broken down by the significance
    of both cointegration tests'
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.14：根据两个协整性测试的显著性分解的启发式分布
- en: To evaluate the predictive accuracy of the heuristics, we first run a logistic
    regression model with these features to predict significant cointegration. It
    achieves an **area-under-the-curve** (**AUC**) cross-validation score of 0.815;
    excluding the correlation metrics, it still scores 0.804\. A decision tree does
    slightly better at AUC=0.821, with or without the correlation features.
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 为了评估这些启发式方法的预测准确性，我们首先运行一个逻辑回归模型，使用这些特征来预测显著的协整性。它获得了0.815的AUC交叉验证分数；排除相关性指标后，分数仍为0.804。决策树在AUC=0.821时稍微更好，无论是否包括相关性特征。
- en: 'Not least due to the strong class imbalance, there are large numbers of false
    positives: correctly identifying 80 percent of the 366 cointegrated pairs implies
    over 16,500 false positives, but eliminates almost 30,000 of the candidates. See
    the notebook `cointegration_tests` for additional detail.'
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: 由于类别不平衡严重，存在大量的假阳性：正确识别366个协整货币对的80%意味着有超过16,500个假阳性，但也消除了近30,000个候选货币对。有关更多细节，请参阅笔记本`cointegration_tests`。
- en: The **key takeaway** is that distance heuristics can help screen a large universe
    more efficiently, but this comes at a cost of missing some cointegrated pairs
    and still requires substantial testing.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: '**关键要点**是距离启发式方法可以帮助更有效地筛选大量的货币对，但这会导致错过一些协整的货币对，并且仍然需要大量的测试。'
- en: Preparing the strategy backtest
  id: totrans-339
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备策略回测
- en: In this section, we are going to implement a statistical arbitrage strategy
    based on cointegration for the sample of stocks and ETFs and the 2017-2019 period.
    Some aspects are simplified to streamline the presentation. See the notebook `statistical_arbitrage_with_cointegrated_pairs`
    for the code examples and additional detail.
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将基于协整实施统计套利策略，针对股票和ETF的样本以及2017-2019年的期间。为简化演示，某些方面进行了简化。有关代码示例和更多细节，请参阅笔记本`statistical_arbitrage_with_cointegrated_pairs`。
- en: We first generate and store the cointegration tests for all candidate pairs
    and the resulting trading signals. Then, we backtest a strategy based on these
    signals, given the computational intensity of the process.
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先生成并存储所有候选货币对的协整检验和相应的交易信号。然后，我们基于这些信号进行策略回测，考虑到该过程的计算强度。
- en: Precomputing the cointegration tests
  id: totrans-342
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 预先计算协整检验
- en: First, we run quarterly cointegration tests over a 2-year lookback period on
    each of the 23,000 potential pairs, Then, we select pairs where both the Johansen
    and the Engle-Granger tests agree for trading. We should exclude assets that are
    stationary during the lookback period, but we eliminated assets that are stationary
    for the entire period, so we skip this step to simplify it.
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们在2年的回顾期内对23,000个潜在货币对进行季度协整检验，然后选择约翰逊和恩格尔-格兰杰检验都同意进行交易的货币对。我们应该排除在回顾期间为平稳的资产，但我们已经排除了整个期间都为平稳的资产，因此我们跳过这一步以简化流程。
- en: This procedure follows the steps outlined previously; please see the notebook
    for details.
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 此过程遵循先前概述的步骤；有关详细信息，请参阅笔记本。
- en: '*Figure 9.15* shows the original stock and ETF series of the two different
    pairs selected for trading; note the clear presence of a common trend over the
    sample period:'
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: '*图9.15*显示了选定进行交易的两个不同货币对的原始股票和ETF系列；请注意样本期间共同趋势的明显存在：'
- en: '![](img/15439_09_15.png)'
  id: totrans-346
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15439_09_15.png)'
- en: 'Figure 9.15: Price series for two selected pairs over the sample period'
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.15：两个选定货币对的价格系列在样本期间
- en: Getting entry and exit trades
  id: totrans-348
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 获取做多和做空交易
- en: Now, we can compute the spread for each candidate pair based on a rolling hedge
    ratio. We also calculate a **Bollinger Band** because we will consider moves of
    the spread larger than two rolling standard deviations away from its moving average
    as **long and short entry signals**, and crossings of the moving average in reverse
    as exit signals.
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以基于滚动对冲比率计算每个候选货币对的价差。我们还计算了一个**布林带**，因为我们将考虑价差大于其移动平均值两倍滚动标准差的变化作为**做多和做空的入场信号**，并且移动平均线的交叉作为退出信号。
- en: Smoothing prices with the Kalman filter
  id: totrans-350
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 使用卡尔曼滤波器平滑价格
- en: 'To this end, we first apply a rolling **Kalman filter** (**KF**) to remove
    some noise, as demonstrated in *Chapter 4*, *Financial Feature Engineering – How
    to Research Alpha Factors*:'
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 为此，我们首先应用滚动**卡尔曼滤波器**（**KF**）来去除一些噪音，如*第4章*，*金融特征工程-如何研究Alpha因子*中所示：
- en: '[PRE14]'
  id: totrans-352
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Computing the rolling hedge ratio using the Kalman filter
  id: totrans-353
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 使用卡尔曼滤波器计算滚动对冲比率
- en: 'To obtain a dynamic hedge ratio, we use the KF for rolling linear regression,
    as follows:'
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: 为了获得动态对冲比率，我们使用KF进行滚动线性回归，如下所示：
- en: '[PRE15]'
  id: totrans-355
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Estimating the half-life of mean reversion
  id: totrans-356
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 估计均值回归的半衰期
- en: 'If we view the spread as a mean-reverting stochastic process in continuous
    time, we can model it as an Ornstein-Uhlenbeck process. The benefit of this perspective
    is that we gain a formula for the half-life of mean reversion, as an approximation
    of the time required for the spread to converge again after a deviation (see *Chapter
    2*, *Market and Fundamental Data – Sources and Techniques*, in Chan 2013 for details):'
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们将价差视为连续时间的均值回归随机过程，我们可以将其建模为奥恩斯坦-乌伦贝克过程。这种视角的好处在于，我们获得了均值回归的半衰期的公式，作为偏离后价差再次收敛所需的时间的近似值（有关详细信息，请参见*第2章*，*市场和基本数据-来源和技术*，Chan
    2013）：
- en: '[PRE16]'
  id: totrans-358
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Computing spread and Bollinger Bands
  id: totrans-359
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 计算价差和布林带
- en: 'The following function orchestrates the preceding computations and expresses
    the spread as a z-score that captures deviations from the moving average with
    a window equal to two half-lives in terms of the rolling standard deviations:'
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 以下函数编排了前述计算，并将价差表示为z分数，以捕捉与滚动标准差的两倍半衰期相等的窗口的偏差：
- en: '[PRE17]'
  id: totrans-361
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Getting entry and exit dates for long and short positions
  id: totrans-362
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 获取做多和做空头寸的入场和退出日期
- en: 'Finally, we use the set of z-scores to derive trading signals:'
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们使用z分数集来生成交易信号：
- en: We enter a long (short) position if the z-score is below (above) two, which
    implies the spread has moved two rolling standard deviations below (above) the
    moving average
  id: totrans-364
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果z分数低于（高于）两个，则我们进入做多（做空）头寸，这意味着价差已经移动到移动平均线下方（上方）两个滚动标准差。
- en: We exit trades when the spread crosses the moving average again
  id: totrans-365
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当价差再次穿过移动平均线时，我们退出交易
- en: We derive rules on a quarterly basis for the set of pairs that passed the cointegration
    tests during the prior lookback period but allow pairs to exit during the subsequent
    3 months.
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 我们每季度制定规则，用于通过协整检验的一组货币对在先前回顾期间通过，但允许在随后的3个月内退出。
- en: 'We again simplify this by dropping pairs that do not close during this 6-month
    period. Alternatively, we could have handled this using the stop-loss risk management
    that we included in the strategy (see the next section on backtesting):'
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过放弃在这6个月期间未关闭的配对来简化这一过程。或者，我们可以使用我们在策略中包含的止损风险管理来处理这个问题（请参阅下一节关于回测的内容）：
- en: '[PRE18]'
  id: totrans-368
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Backtesting the strategy using backtrader
  id: totrans-369
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用backtrader回测策略
- en: Now, we are ready to formulate our strategy on our backtesting platform, execute
    it, and evaluate the results. To do so, we need to track our pairs, in addition
    to individual portfolio positions, and monitor the spread of active and inactive
    pairs to apply our trading rules.
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们准备在我们的回测平台上制定我们的策略，执行它，并评估结果。为此，我们需要跟踪我们的配对，以及单独的投资组合头寸，并监控活跃和非活跃配对的价差，以应用我们的交易规则。
- en: Tracking pairs with a custom DataClass
  id: totrans-371
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用自定义DataClass跟踪配对
- en: 'To account for active pairs, we define a `dataclass` (introduced in Python
    3.7—see the Python documentation for details). This data structure, called `Pair`,
    allows us to store the pair components, their number of shares, and the hedge
    ratio, and compute the current spread and the return, among other things. See
    a simplified version in the following code:'
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 为了考虑活跃的配对，我们定义了一个`dataclass`（在Python 3.7中引入-有关详细信息，请参阅Python文档）。这个数据结构称为`Pair`，允许我们存储配对组件、它们的股票数量和对冲比率，并计算当前价差和回报等。请参见以下代码中的简化版本：
- en: '[PRE19]'
  id: totrans-373
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Running and evaluating the strategy
  id: totrans-374
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 运行和评估策略
- en: 'Key implementation aspects include:'
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: 关键的实施方面包括：
- en: The daily exit from pairs that have either triggered the exit rule or exceeded
    a given negative return
  id: totrans-376
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每日退出那些触发退出规则或超过给定负回报的配对
- en: The opening of new long and short positions for pairs whose spreads triggered
    entry signals
  id: totrans-377
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于触发进入信号的价差的配对，开设新的做多和做空头寸
- en: In addition, we adjust positions to account for the varying number of pairs
  id: totrans-378
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 此外，我们调整头寸以考虑不同数量的配对
- en: The code for the strategy itself takes up too much space to display here; see
    the notebook `pairs_trading_backtest` for details.
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 策略本身的代码占用了太多的空间，无法在此显示；有关详细信息，请参阅笔记本`pairs_trading_backtest`。
- en: '*Figure 9.16* shows that, at least for the 2017-2019 period, this simplified
    strategy had its moments (note that we availed ourselves of some lookahead bias
    and ignored transaction costs).'
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: '*图9.16*显示，至少在2017-2019年期间，这个简化的策略有它的时刻（请注意，我们利用了一些前瞻性偏见，并忽略了交易成本）。'
- en: 'Under these lax assumptions, it underperformed the S&P 500 at the beginning
    and end of the period and was otherwise roughly in line (left panel). It yields
    an alpha of 0.08 and a negative beta of -0.14 (right panel), with an average Sharpe
    ratio of 0.75 and a Sortino ratio of 1.05 (central panel):'
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: 在这些宽松的假设下，它在期初和期末表现不佳，而在其他时候大致持平（左图）。它产生了0.08的alpha和-0.14的负beta（右图），平均夏普比率为0.75，Sortino比率为1.05（中央图）：
- en: '![](img/15439_09_16.png)'
  id: totrans-382
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15439_09_16.png)'
- en: 'Figure 9.16: Strategy performance metrics'
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.16：策略绩效指标
- en: While we should take these performance metrics with a grain of salt, the strategy
    demonstrates the anatomy of a statistical arbitrage based on cointegration in
    the form of pairs trading. Let's take a look at a few steps you could take to
    build on this framework to produce better performance.
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然我们应该对这些绩效指标持保留态度，但这个策略展示了基于协整的统计套利的解剖学，以配对交易的形式。让我们看看您可以采取哪些步骤来在这个框架上取得更好的绩效。
- en: Extensions – how to do better
  id: totrans-385
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 扩展-如何做得更好
- en: Cointegration is a very useful concept to identify pairs or groups of stocks
    that tend to move in unison. Compared to the statistical sophistication of cointegration,
    we used very simple and static trading rules; the computation on a quarterly basis
    also distorts the strategy, as the patterns of long and short holdings show (see
    notebook).
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: 协整是一个非常有用的概念，可以识别倾向于一起移动的股票配对或股票组。与协整的统计复杂性相比，我们使用了非常简单和静态的交易规则；每季度的计算也扭曲了策略，正如长期和短期持仓的模式所示（请参阅笔记本）。
- en: To be successful, you will, at a minimum, need to screen a larger universe and
    optimize several of the parameters, including the trading rules. Moreover, risk
    management should account for concentrated positions that arise when certain assets
    appear relatively often on the same side of a traded pair.
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: 要取得成功，您至少需要筛选更大的投资范围，并优化其中的几个参数，包括交易规则。此外，风险管理应考虑到当某些资产相对频繁地出现在同一交易对的一侧时产生的集中头寸。
- en: You could also operate with baskets as opposed to individual pairs; however,
    to address the growing number of candidates, you would likely need to constrain
    the composition of the baskets.
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 您也可以使用篮子而不是单独的配对进行操作；然而，为了解决不断增加的候选人数量，您可能需要限制篮子的组成。
- en: As mentioned in the *Pairs trading – statistical arbitrage with cointegration*
    section, there are alternatives that aim to predict price movements. In the following
    chapters, we will explore various machine learning models that aim to predict
    the absolute size or the direction of price movements for a given investment universe
    and horizon. Using these forecasts as long and short entry signals is a natural
    extension or alternative to the pairs trading framework that we studied in this
    section.
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: 如*配对交易-协整统计套利*部分所述，有一些旨在预测价格走势的替代方案。在接下来的章节中，我们将探讨各种机器学习模型，旨在预测给定投资范围和时间跨度的价格走势的绝对大小或方向。将这些预测作为做多和做空的进入信号是对我们在本节中研究的配对交易框架的自然扩展或替代方案。
- en: Summary
  id: totrans-390
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we explored linear time-series models for the univariate case
    of individual series, as well as multivariate models for several interacting series.
    We encountered applications that predict macro fundamentals, models that forecast
    asset or portfolio volatility with widespread use in risk management, and multivariate
    VAR models that capture the dynamics of multiple macro series. We also looked
    at the concept of cointegration, which underpins the popular pair-trading strategy.
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们探讨了用于单变量时间序列模型的线性模型，以及用于多个交互系列的多变量模型。我们遇到了预测宏观基本面的应用程序，用于风险管理中广泛使用的预测资产或投资组合波动性的模型，以及捕捉多个宏观系列动态的多变量VAR模型。我们还研究了协整的概念，这是流行的配对交易策略的基础。
- en: Similar to *Chapter 7*, *Linear Models – From Risk Factors to Return Forecasts*,
    we saw how linear models impose a lot of structure, that is, they make strong
    assumptions that potentially require transformations and extensive testing to
    verify that these assumptions are met. If they are, model-training and interpretation
    are straightforward, and the models provide a good baseline that more complex
    models may be able to improve on. In the next two chapters, we will see two examples
    of this, namely random forests and gradient boosting models, and we will encounter
    several more in *Part 4*, which is on deep learning.
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: 与*第7章* *线性模型-从风险因素到收益预测*类似，我们看到线性模型施加了很多结构，即它们做出了强烈的假设，可能需要进行转换和广泛的测试来验证这些假设是否成立。如果它们成立，模型训练和解释就很简单，而且这些模型提供了一个良好的基准，更复杂的模型可能能够改进。在接下来的两章中，我们将看到两个例子，即随机森林和梯度提升模型，我们还将在*第4部分*中遇到更多的例子，这部分是关于深度学习的。
