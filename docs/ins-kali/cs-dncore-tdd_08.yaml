- en: Creating Continuous Integration Build Processes
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建持续集成构建流程
- en: Continuous feedback, frequent integration, and timely deployment, which all
    result from the practice of continuous integration, can greatly reduce the risks
    associated with the software development process. A development team can improve
    productivity, reduce the amount of time required to deploy, and benefit tremendously
    from CI.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 持续反馈、频繁集成和及时部署，这些都是持续集成实践带来的结果，可以极大地减少与软件开发过程相关的风险。开发团队可以提高生产率，减少部署所需的时间，并从持续集成中获得巨大的好处。
- en: In [Chapter 7](499224f3-b0cc-4ba3-87ef-a7c92b85070d.xhtml), *Continuous Integration
    and Project Hosting*, we set up TeamCity, a robust continuous integration tool,
    that simplifies and automates the process of managing source code check-ins and
    changes, testing, building, and deploying the software project. We walked through
    the creation of build steps in TeamCity and connected it to our `LoanApplication`
    project in GitHub. TeamCity has in-built features that allow it to connect to
    software projects hosted on GitHub or Bitbucket.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第7章](499224f3-b0cc-4ba3-87ef-a7c92b85070d.xhtml)中，*持续集成和项目托管*，我们设置了TeamCity，一个强大的持续集成工具，简化和自动化了管理源代码检入和更改、测试、构建和部署软件项目的过程。我们演示了在TeamCity中创建构建步骤，并将其连接到我们在GitHub上的`LoanApplication`项目。TeamCity具有内置功能，可以连接到托管在GitHub或Bitbucket上的软件项目。
- en: The CI process brings many different steps together into an easily repeatable
    process. These steps vary based on the software project type, but there are steps
    that are common and applicable to most projects. These steps can be automated
    using a build automation system.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: CI流程将许多不同的步骤整合成一个易于重复的过程。这些步骤根据软件项目类型而有所不同，但有一些步骤是常见的，并适用于大多数项目。可以使用构建自动化系统自动化这些步骤。
- en: 'In this chapter, we will configure TeamCity to use a cross-platform build-automation
    system, called **Cake**, to clean, build, and restore package dependencies, and
    test the `LoanApplication` solution. Later in the chapter, we will explore the
    build-step creation with a Cake task in **Visual Studio Team Services**. We will
    cover the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将配置TeamCity使用名为**Cake**的跨平台构建自动化系统，来清理、构建、恢复软件包依赖，并测试`LoanApplication`解决方案。本章后面，我们将探讨在**Visual
    Studio Team Services**中使用Cake任务创建构建步骤。我们将涵盖以下主题：
- en: Installing the Cake Bootstrapper
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装Cake引导程序
- en: Writing build scripts in C#
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用C#编写构建脚本
- en: Cake extension for Visual Studio
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Visual Studio的Cake扩展
- en: Using Cake tasks to build steps
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Cake任务创建构建步骤
- en: CI with Visual Studio Team Services
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Visual Studio Team Services进行CI
- en: Installing the Cake Bootstrapper
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装Cake引导程序
- en: '**Cake** is a cross-platform build-automation framework. It is a build-automation
    framework for compiling codes, running tests, copying files and folders, as well
    as running build-related tasks. Cake is open source with the source code hosted
    on GitHub.'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '**Cake**是一个跨平台的构建自动化框架。它是一个用于编译代码、运行测试、复制文件和文件夹，以及运行与构建相关任务的构建自动化框架。Cake是开源的，源代码托管在GitHub上。'
- en: Cake has the feature to make working with file system paths easy and has functionality
    for manipulating XML, starting processes, I/O operations, and parsing Visual Studio
    Solutions. Using Cake build-related activities can be automated using C# domain-specific
    language.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: Cake具有使文件系统路径操作变得简单的功能，并具有操作XML、启动进程、I/O操作和解析Visual Studio解决方案的功能。可以使用C#领域特定语言自动化Cake构建相关活动。
- en: It employs a dependency-based programming model for build automation, through
    which tasks are declared alongside dependencies between the tasks. The dependency-based
    model is ideal and suitable for build automation because the majority of automation
    build steps are idempotent.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 它采用基于依赖的编程模型进行构建自动化，通过该模型，在任务之间声明依赖关系。基于依赖的模型非常适合构建自动化，因为大多数自动化构建步骤都是幂等的。
- en: Cake is truly cross-platform; its NuGet package, Cake.CoreCLR, allows it to
    run on Windows, Linux, and Mac using .NET Core. It has a NuGet package that can
    be used to run on Windows relying on .NET Framework 4.6.1\. Also, it can use the
    Mono framework to run on Linux and Max, with Mono Version 4.4.2 recommended.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: Cake真正实现了跨平台；其NuGet包Cake.CoreCLR允许它在Windows、Linux和Mac上使用.NET Core运行。它有一个NuGet包，可以在Windows上依赖.NET
    Framework 4.6.1运行。此外，它可以使用Mono框架在Linux和Max上运行，建议使用Mono版本4.4.2。
- en: Irrespective of the CI tool being used, Cake has consistent behavior across
    all supported tools. It has wide support for most tools used during builds, which
    include **MSBuild**, **ILMerge**, **Wix**, and **Signtool**.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 无论使用哪种CI工具，Cake在所有支持的工具中都具有一致的行为。它广泛支持大多数构建过程中使用的工具，包括**MSBuild**、**ILMerge**、**Wix**和**Signtool**。
- en: Installation
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装
- en: 'In order to use the Cake Bootstrapper, Cake needs to be installed. The easy
    approach to install Cake and test run the installation is to clone or download
    a `.zip` file, which is the Cake build example repository located at: [https://github.com/cake-build/example](https://github.com/cake-build/example).
    The example repository contains a simple project and all the files necessary to
    run the Cake script.'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使用Cake引导程序，需要安装Cake。安装Cake并测试运行的简单方法是克隆或下载一个`.zip`文件，即位于[https://github.com/cake-build/example](https://github.com/cake-build/example)的Cake构建示例存储库。示例存储库包含一个简单的项目和运行Cake脚本所需的所有文件。
- en: In the example repository, there are certain files of interest—`build.ps1` and
    `build.sh`. They are the bootstrapper scripts that ensure that the needed dependencies
    by Cake together with Cake and the necessary files are installed. These scripts
    make invoking Cake easier. The `build.cake` file is the build script; the build
    script can be renamed, but the bootstrapper will locate the `build.cake` file
    by default. The `tools.config`/`packages.config` file is the package configuration
    that instructs the bootstrapper script which NuGet packages to install in the
    `tools` folder.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在示例存储库中，有一些感兴趣的文件——`build.ps1`和`build.sh`。它们是引导程序脚本，确保Cake所需的依赖项与Cake和必要的文件一起安装。这些脚本使调用Cake变得更容易。`build.cake`文件是构建脚本；构建脚本可以重命名，但引导程序将默认定位`build.cake`文件。`tools.config`/`packages.config`文件是包配置，指示引导程序脚本在`tools`文件夹中安装哪些NuGet包。
- en: Extract the downloaded example repository archive file. On Windows, open a PowerShell
    prompt and execute the bootstrapper script by running `.\build.ps1`. On Linux
    and Mac, open the terminal and run `.\build.sh`. The bootstrapper script will
    detect that Cake is not installed on the computer and automatically download it
    from NuGet.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 解压下载的示例存储库存档文件。在Windows上，打开PowerShell提示符并通过运行`.\build.ps1`执行引导程序脚本。在Linux和Mac上，打开终端并运行`.\build.sh`。引导程序脚本将检测到计算机上未安装Cake，并自动从NuGet下载它。
- en: 'Based on the bootstrapper script execution, upon completion of Cake download,
    the downloaded sample `build.cake` script will run, which will clean up the output
    directory, and restore referenced NuGet packages before building the project.
    When the `build.cake` file runs, it should clean the test project, restore the
    NuGet packages, and run the unit tests in the project. The `Run Settings` and
    `Test Run Summary` will be presented as shown in the following screenshot:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 根据引导程序脚本的执行，在Cake下载完成后，将运行下载的示例`build.cake`脚本，该脚本将清理输出目录，并在构建项目之前恢复引用的NuGet包。运行`build.cake`文件时，它应该清理测试项目，恢复NuGet包，并运行项目中的单元测试。`运行设置`和`测试运行摘要`将如下截图所示呈现：
- en: '![](img/e9b68fa6-ed2f-4c07-9fa0-ec76e1c8f5a3.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e9b68fa6-ed2f-4c07-9fa0-ec76e1c8f5a3.png)'
- en: The Cake Bootstrapper can be installed by downloading it from the *Cake Resources*
    repository hosted on GitHub ([https://github.com/cake-build/resources](https://github.com/cake-build/resources)),
    which contains configuration files and bootstrappers. The bootstrapper will download
    Cake and the necessary tools required by the build script, thereby avoiding storing
    binaries in the source code repository.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 蛋糕引导程序可以通过从托管在GitHub上的*Cake资源*存储库（[https://github.com/cake-build/resources](https://github.com/cake-build/resources)）下载并安装，其中包含配置文件和引导程序。引导程序将下载Cake和构建脚本所需的必要工具，从而避免在源代码存储库中存储二进制文件。
- en: PowerShell security
  id: totrans-23
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PowerShell安全
- en: Often, PowerShell can prevent the running of the `build.ps1` file. You can get
    an error on the PowerShell screen that `build.ps1` cannot be loaded because running
    scripts is disabled on the system. This restriction in running the file is due
    to the default security settings available in PowerShell.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，PowerShell可能会阻止运行`build.ps1`文件。您可能会在PowerShell屏幕上收到错误消息，指出由于系统上禁用了运行脚本，无法加载`build.ps1`。由于PowerShell中默认的安全设置，对文件的运行限制。
- en: 'Open the PowerShell window and change the directory to the folder of the Cake
    build example repository that was downloaded earlier, and run the `.\build.ps1` command.
    If the execution policy on the system has not been changed from the default, this
    should give you the following error:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 打开PowerShell窗口，将目录更改为之前下载的Cake构建示例存储库的文件夹，并运行`.\build.ps1`命令。如果系统上的执行策略未从默认值更改，这应该会给您以下错误：
- en: '![](img/08df4a59-479c-4116-b56b-2ac333187ca5.png)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![](img/08df4a59-479c-4116-b56b-2ac333187ca5.png)'
- en: 'To view the current execution policy configurations on the system, run the
    `Get-ExecutionPolicy -List` command on the PowerShell screen; this command will
    present a table with the available scopes and execution policies, like in the
    following screen. Based on the way you run PowerShell, you might have different
    settings on your instance:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看系统上当前的执行策略配置，请在PowerShell屏幕上运行`Get-ExecutionPolicy -List`命令；此命令将呈现一个包含可用范围和执行策略的表格，就像以下屏幕上显示的那样。根据您运行PowerShell的方式，您的实例可能具有不同的设置：
- en: '![](img/3b30ec57-3e5b-4581-b016-e25dc5028bdd.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3b30ec57-3e5b-4581-b016-e25dc5028bdd.png)'
- en: 'To change the execution policy to allow the scripts to run subsequently, run
    the `Set-ExecutionPolicy RemoteSigned -Scope Process` command, which is intended
    to change the process scope from undefined to `RemoteSigned`. Running the command
    will display a warning with a prompt on the PowerShell screen stating your PC
    might be exposed to security risks. Type *Y* for Yes and press *Enter*. The following
    screenshot shows what is displayed on the PowerShell screen when the command is
    run:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 要更改执行策略以允许随后运行脚本，运行`Set-ExecutionPolicy RemoteSigned -Scope Process`命令，该命令旨在将进程范围从未定义更改为`RemoteSigned`。运行该命令将在PowerShell屏幕上显示一个警告并提示您的PC可能会面临安全风险。输入*Y*以确认并按*Enter*。运行命令时，PowerShell屏幕上显示的内容如下截图所示：
- en: '![](img/46d76460-53de-4899-90e8-9fd74d557941.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![](img/46d76460-53de-4899-90e8-9fd74d557941.png)'
- en: This will change the execution policy of the PC and allow PowerShell scripts
    to be run.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 这将更改PC的执行策略并允许运行PowerShell脚本。
- en: Cake Bootstrapper installation steps
  id: totrans-32
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 蛋糕引导程序安装步骤
- en: The steps to install Cake Bootstrapper are similar for the platforms with little
    differences. Perform the following steps to set up the boostrapper.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 安装Cake引导程序的步骤对于不同平台是相似的，只有一些小的差异。执行以下步骤设置引导程序。
- en: Step 1
  id: totrans-34
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤1
- en: Navigate to the Cake resource repository to download the boostrapper. For Windows,
    download the PowerShell `build.ps1` file and for Mac and Linux, download the `build.sh`
    bash file.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 导航到Cake资源存储库以下载引导程序。对于Windows，下载PowerShell `build.ps1`文件，对于Mac和Linux，下载`build.sh`
    bash文件。
- en: 'On Windows, open a new PowerShell window and run the following command:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 在Windows上，打开一个新的PowerShell窗口并运行以下命令：
- en: '[PRE0]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'On Mac, run the following command from a new shell window:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 在Mac上，从新的shell窗口运行以下命令：
- en: '[PRE1]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'On Linux, open a new shell to run the following command:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 在Linux上，打开一个新的shell来运行以下命令：
- en: '[PRE2]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Step 2
  id: totrans-42
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤2
- en: 'Create a Cake script to test the installation. Create a `build.cake` file;
    which should be placed in the same location as the `build.sh` file:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个Cake脚本来测试安装。创建一个`build.cake`文件；应该放在与`build.sh`文件相同的位置：
- en: '[PRE3]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Step 3
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤3
- en: The Cake script created in *Step 2* can now be run by invoking the Cake Bootstrapper.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 现在可以通过调用Cake引导程序来运行*步骤2*中创建的Cake脚本。
- en: On Windows, you need to instruct PowerShell to allow running scripts, this is
    done by changing the Windows PowerShell script execution policy. The PowerShell
    script execution can fail due to the execution policy.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在Windows上，您需要指示PowerShell允许运行脚本，方法是更改Windows PowerShell脚本执行策略。由于执行策略，PowerShell脚本执行可能会失败。
- en: 'To execute the Cake script, run the following command:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行Cake脚本，请运行以下命令：
- en: '[PRE4]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'On Linux or Mac, you should run the following command to give the current owner
    permission to execute the script:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 在Linux或Mac上，您应该运行以下命令，以授予当前所有者执行脚本的权限：
- en: '[PRE5]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Once the command has been run, the bootstrapper can be invoked to run the Cake
    script created in *Step 2*:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 运行命令后，可以调用引导程序来运行*步骤2*中创建的Cake脚本：
- en: '[PRE6]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Writing build scripts in C#
  id: totrans-54
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用C#编写构建脚本
- en: Automating the build and deployment tasks using Cake allows you to avoid issues
    and headaches associated with project deployments. A build script usually contains
    the steps and logic required to build and deploy the source code alongside configuration
    files and other artifacts of a project.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Cake自动化构建和部署任务可以避免与项目部署相关的问题和头痛。构建脚本通常包含构建和部署源代码以及配置文件和项目的其他工件所需的步骤和逻辑。
- en: Using the sample `build.cake` file available on the Cake resource repository
    can be a starting point for writing a build script for a project. However, to
    achieve more, we will walk through some basic Cake concepts that can facilitate
    writing robust scripts for automating build and deployment tasks.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Cake资源库上可用的示例`build.cake`文件可以作为编写项目的构建脚本的起点。但是，为了实现更多功能，我们将介绍一些基本的Cake概念，以便编写用于自动化构建和部署任务的健壮脚本。
- en: Task
  id: totrans-57
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 任务
- en: At the core of the build automation with Cake is the task. A **task** in Cake
    is a simple unit of work that is used to carry out a specific action or activity
    in a desired defined order. Tasks in Cake can have specified criteria, associated
    dependencies, and error handling.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 在Cake的构建自动化的核心是任务。Cake中的**任务**是用于按照所需的顺序执行特定操作或活动的简单工作单元。Cake中的任务可以具有指定的条件、相关依赖项和错误处理。
- en: 'A task can be defined by using the `Task` method, with the task name or caption
    passed into it as an argument:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用`Task`方法来定义任务，将任务名称或标题作为参数传递给它：
- en: '[PRE7]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'For example, the `build` task in the following snippet cleans the `debugFolder`
    folder to delete the contents. When the task is run, the `CleanDirectory` method
    will be invoked:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，以下代码片段中的`build`任务会清理`debugFolder`文件夹以删除其中的内容。运行任务时，将调用`CleanDirectory`方法：
- en: '[PRE8]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Cake allows you to use C# to use the async and await features in a task to create
    asynchronous tasks. Essentially, a task itself will run synchronously with a single
    thread, but the code contained in a task can benefit from the asynchronous programming
    features and utilize asynchronous APIs.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: Cake允许您使用C#在任务中使用异步和等待功能来创建异步任务。实质上，任务本身将以单个线程同步运行，但任务中包含的代码可以受益于异步编程功能并利用异步API。
- en: 'Cake has the `DoesForEach` method that can be used to add a collection of items
    or a delegate that yields a collection of items as actions to a task. When a delegate
    is added to a task, the delegate will be executed after the task is executed:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: Cake具有`DoesForEach`方法，可用于将一系列项目或产生一系列项目的委托作为任务的操作添加。当将委托添加到任务时，委托将在任务执行后执行：
- en: '[PRE9]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Define `DoesForEach` by chaining it to the `Task` method, as in the following
    snippet:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 通过将`DoesForEach`链接到`Task`方法来定义`DoesForEach`，如以下代码片段所示：
- en: '[PRE10]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: TaskSetup and TaskTeardown
  id: totrans-68
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: TaskSetup和TaskTeardown
- en: '`TaskSetup` and `TaskTeardown` are used to wrap code to execute actions that
    you want the build to perform before and after the execution of each task. These
    methods are especially useful when performing actions such as configuration initializations
    and custom logging:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '`TaskSetup`和`TaskTeardown`用于包装要在执行每个任务之前和之后执行的构建操作。当执行诸如配置初始化和自定义日志记录等操作时，这些方法尤其有用：'
- en: '[PRE11]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Similar to `TaskSetup` and `TaskTeardown` for task, Cake has the `Setup` and
    `Teardown` methods that can be used to execute actions that are intended to run
    before the first task and after the last task, respectively. These methods are
    useful in a build automation, with a good use case being, for example, when you
    intend to start up some server and services before running tasks and for the cleanup
    activities afterwards. The `Setup` or `Teardown` methods are to be called before
    `RunTarget` to ensure they work correctly:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 与任务的`TaskSetup`和`TaskTeardown`类似，Cake具有`Setup`和`Teardown`方法，可用于在第一个任务之前和最后一个任务之后执行操作。这些方法在构建自动化中非常有用，例如，当您打算在运行任务之前启动一些服务器和服务以及在运行任务后进行清理活动时。应在`RunTarget`之前调用`Setup`或`Teardown`方法以确保它们正常工作：
- en: '[PRE12]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Configuration and preprocessor directives
  id: totrans-73
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置和预处理指令
- en: Cake operations can be controlled through the use of environment variables,
    configuration files, and by passing arguments into the Cake executable file. This
    is based on a specified priority in which the configuration file overrides the
    environment variables and arguments passed into Cake, and then overrides entries
    defined in both environment variables and the configuration file.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: Cake操作可以通过使用环境变量、配置文件和将参数传递到Cake可执行文件来进行控制。这是基于指定的优先级，配置文件会覆盖环境变量和传递给Cake的参数，然后覆盖在环境变量和配置文件中定义的条目。
- en: For example, if you intend to specify the tool path, which is the directory
    that cake checks when restoring tools, you can create the `CAKE_PATHS_TOOLS` environment
    variable name and set the value to the Cake tools folder path.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果您打算指定工具路径，即cake在恢复工具时检查的目录，您可以创建`CAKE_PATHS_TOOLS`环境变量名称，并将值设置为Cake工具文件夹路径。
- en: 'When using configuration file, the file should be placed in the same directory
    as the `build.cake` file. The Cake tools path can be specified in the configuration
    file, like in the following snippet, which overrides whatever is set in the environment
    variable:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用配置文件时，文件应放置在与`build.cake`文件相同的目录中。可以在配置文件中指定Cake工具路径，就像在以下代码片段中一样，它会覆盖环境变量中设置的任何内容：
- en: '[PRE13]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The Cake tools path can be passed directly into Cake, which will override what
    is set in both the environment variable and configuration file:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: Cake工具路径可以直接传递给Cake，这将覆盖环境变量和配置文件中设置的内容：
- en: '[PRE14]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Cake has values that are used by default for the configuration entries, if
    they are not overridden using any of the methods for configuring Cake. The available
    configuration entries are shown here with their default values and how to configure
    them using the configuration methods:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: Cake具有默认用于配置条目的值，如果它们没有使用任何配置Cake的方法进行覆盖。这里显示了可用的配置条目及其默认值，以及如何使用配置方法进行配置：
- en: '![](img/b93d2441-cac2-4442-87b4-81d5c56b2bcb.png)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b93d2441-cac2-4442-87b4-81d5c56b2bcb.png)'
- en: '*Preprocessor directives* are used in Cake to reference assemblies, namespaces,
    and scripts. The preprocessor line directives run before the script is executed.'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '*预处理器指令*用于在Cake中引用程序集、命名空间和脚本。预处理器行指令在脚本执行之前运行。'
- en: Dependencies
  id: totrans-83
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 依赖关系
- en: 'Often, you will create tasks whose execution will depend on the completion
    of other tasks; to achieve this, you use the `IsDependentOn` and `IsDependeeOf`
    methods. To create a task that is dependent on another task, use the `IsDependentOn`
    method. In the following build script, Cake will execute `Task1` before `Task2`
    is executed:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，您将创建依赖于其他任务完成的任务；为了实现这一点，您可以使用`IsDependentOn`和`IsDependeeOf`方法。要创建依赖于另一个任务的任务，请使用`IsDependentOn`方法。在以下构建脚本中，Cake将在执行`Task2`之前执行`Task1`：
- en: '[PRE15]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Using the `IsDependeeOf` method, you can define task dependencies with reversed
    relationships. This implies that where the tasks that depend on a task are defined
    in that task. The preceding build script can be refactored to use the reversed
    relationship:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`IsDependeeOf`方法，您可以定义具有相反关系的任务依赖关系。这意味着依赖于任务的任务在该任务中定义。前面的构建脚本可以重构为使用反向关系：
- en: '[PRE16]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Criteria
  id: totrans-88
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 标准
- en: When criteria is used in the Cake script, it allows you to control the flow
    of the execution of the build script. A **criteria** is a predicate that must
    be fulfilled for the task to execute. The criteria does not affect the execution
    of the succeeding task. Criteria is used to control task execution based on specified
    configurations, environmental states, repository branches, and any other desired
    options.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 在Cake脚本中使用标准允许您控制构建脚本的执行流程。**标准**是必须满足才能执行任务的谓词。标准不会影响后续任务的执行。标准用于根据指定的配置、环境状态、存储库分支和任何其他所需选项来控制任务执行。
- en: 'In the simplest form, you can use the `WithCriteria` method to specify the
    criteria of the execution of a particular task. For example, if you want to clean
    the `debugFolder` folder only in the afternoon, you can specify the criteria as
    in the following script:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 最简单的形式是使用`WithCriteria`方法来指定特定任务的执行标准。例如，如果您只想在下午清理`debugFolder`文件夹，可以在以下脚本中指定标准：
- en: '[PRE17]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'You can have a task whose execution is dependent on another task; in the following
    script, the criteria for the `CleanFolder` task will be set when the task is created,
    while the criteria for the `ProcessCsv` task evaluation will be done during task
    execution:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以有一个任务的执行取决于另一个任务；在以下脚本中，`CleanFolder`任务的标准将在创建任务时设置，而`ProcessCsv`任务评估的标准将在任务执行期间进行：
- en: '[PRE18]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'A more useful use case will be to write a Cake script with criteria that checks
    a local build and executes some actions that will clean, build, and deploy a project.
    Four tasks will be defined, one for each of the actions to be performed and the
    fourth to chain the actions together:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 一个更有用的用例是编写一个带有标准的Cake脚本，检查本地构建并执行一些操作，以清理、构建和部署项目。将定义四个任务，每个任务执行一个要执行的操作，第四个任务将链接这些操作在一起：
- en: '[PRE19]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Cake's error handling and finally block
  id: totrans-96
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Cake的错误处理和最终块
- en: Cake has error handling techniques that you can use to recover from errors or
    graciously handle exceptions whenever they occur during the build process. Sometimes
    build steps call external services or processes; invocation of these external
    dependencies might cause errors that can cause the overall build to fail. A robust
    build should handle such exceptions without stopping the entire build process.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: Cake具有错误处理技术，您可以使用这些技术从错误中恢复，或者在构建过程中发生异常时优雅地处理异常。有时，构建步骤调用外部服务或进程；调用这些外部依赖项可能会导致错误，从而导致整个构建失败。强大的构建应该在不停止整个构建过程的情况下处理这些异常。
- en: 'The `OnError` method is a task extension that is used when you need to act
    on an exception generated in the build. Instead of forcefully terminating the
    script, you can write code to handle the error in the `OnError` method:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '`OnError`方法是一个任务扩展，用于在构建中生成异常时执行操作。您可以在`OnError`方法中编写代码来处理错误，而不是强制终止脚本：'
- en: '[PRE20]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Sometimes you might want to ignore the error thrown and just continue the execution
    of a task that generates the exception; you can use the `ContinueOnError` task
    extension to achieve this. When using the `ContinueOnError` method, you cannot
    use the `OnError` method with it:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，您可能希望忽略抛出的错误并继续执行生成异常的任务；您可以使用`ContinueOnError`任务扩展来实现这一点。使用`ContinueOnError`方法时，您不能与之一起使用`OnError`方法：
- en: '[PRE21]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'If you wish to report the exception generated in a task, and still allow the
    exception to propagate and take its course, use the `ReportError` method. If,
    for any reason, an exception is thrown inside the `ReportError` method, it is
    swallowed:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望报告任务中生成的异常，并仍然允许异常传播并采取其课程，请使用`ReportError`方法。如果由于任何原因，在`ReportError`方法内引发异常，则会被吞噬：
- en: '[PRE22]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Also, you can use the `DeferOnError` method to defer any thrown exception till
    the task being executed is completed. This will ensure that the task executes
    all actions specified in it before the exception is thrown and the script fails:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您可以使用`DeferOnError`方法将任何抛出的异常推迟到执行的任务完成。这将确保任务在抛出异常并使脚本失败之前执行其指定的所有操作：
- en: '[PRE23]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Lastly, you can use the `Finally` method to execute any action, irrespective
    of the outcome of the task''s execution:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，您可以使用`Finally`方法执行任何操作，而不管任务执行的结果如何：
- en: '[PRE24]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: LoanApplication build script
  id: totrans-108
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: LoanApplication构建脚本
- en: To demonstrate the power of Cake, let's write a Cake script to build the `LoanApplication`
    project. The Cake script will clean the project folder, restore all package references,
    build the entire solution, and run unit test projects in the solution.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 为了展示Cake的强大功能，让我们编写一个Cake脚本来构建`LoanApplication`项目。Cake脚本将清理项目文件夹，还原所有包引用，构建整个解决方案，并运行解决方案中的单元测试项目。
- en: 'The following script sets arguments to be used throughout the script, defines
    the directories and the tasks to clean the `bin` folder of the `LoanApplication.Core`
    project, and restores packages using the `DotNetCoreRestore` method. NuGet packages
    can be restored by using the `DotNetCoreRestore` method, which in turn uses the
    `dotnet restore` command:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 以下脚本设置要在整个脚本中使用的参数，定义目录和任务以清理`LoanApplication.Core`项目的`bin`文件夹，并使用`DotNetCoreRestore`方法恢复包。可以使用`DotNetCoreRestore`方法来还原NuGet包，该方法又使用`dotnet
    restore`命令：
- en: '[PRE25]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'The later portion of the script contains tasks to build the entire solution
    using the `DotNetCoreBuild` method, which builds the solution using the `dotnet
    build` command, using settings provided in the `DotNetCoreBuildSettings` object.
    The test projects are executed using the `DotNetCoreTest` method, which runs the
    tests in all the test projects in the solution using `dotnet test` and the settings
    provided in the `DotNetCoreTestSettings` object:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本的后部分包含使用`DotNetCoreBuild`方法构建整个解决方案的任务，该方法使用`DotNetCoreBuildSettings`对象中提供的设置使用`dotnet
    build`命令构建解决方案。使用`DotNetCoreTest`方法执行测试项目，该方法使用`DotNetCoreTestSettings`对象中提供的设置在解决方案中的所有测试项目中运行测试使用`dotnet
    test`：
- en: '[PRE26]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'The Cake Bootstrapper can be used to run the Cake `build` file by invoking
    the bootstrapper from the PowerShell window. When the bootstrapper is invoked,
    Cake will use the task definition available in the `build` file to commence execution
    of the defined build tasks. When the execution begins, the progress and status
    of the execution is presented in the PowerShell window:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: Cake Bootstrapper可用于通过从PowerShell窗口调用引导程序来运行Cake `build`文件。当调用引导程序时，Cake将使用`build`文件中可用的任务定义来开始执行定义的构建任务。执行开始时，执行的进度和状态将显示在PowerShell窗口中：
- en: '![](img/f8e37ddb-c164-41c2-abe8-970cd23436d6.png)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f8e37ddb-c164-41c2-abe8-970cd23436d6.png)'
- en: 'The progress of the execution of each task will be displayed on the PowerShell
    window with all the activities that Cake is currently undergoing. When the build
    execution completes, the duration of the execution of each task in the script
    will be displayed along with the total execution time of all the tasks:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '每个任务的执行进度将显示在PowerShell窗口中，显示Cake当前正在进行的所有活动。当构建执行完成时，将显示脚本中每个任务的执行持续时间，以及所有任务的总执行时间： '
- en: '![](img/f3ff87ae-4cca-4ff6-af6d-349cca93578a.png)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f3ff87ae-4cca-4ff6-af6d-349cca93578a.png)'
- en: Cake Extension for Visual Studio
  id: totrans-118
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Visual Studio的Cake扩展
- en: The **Cake Extension for Visual Studio Add-in** brings language support for
    Cake build scripts to Visual Studio. The extension supports new templates, a task
    runner explorer, and the ability to bootstrap Cake files. **Cake Extension** for
    Visual Studio can be downloaded at **Visual Studio Market Place** ([https://marketplace.visualstudio.com/items?itemName=vs-publisher-1392591.CakeforVisualStudio](https://marketplace.visualstudio.com/items?itemName=vs-publisher-1392591.CakeforVisualStudio)).
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: '**Visual Studio的Cake扩展**为Visual Studio带来了对Cake构建脚本的语言支持。该扩展支持新模板、任务运行器资源管理器以及引导Cake文件的功能。可以在**Visual
    Studio Market Place**下载**Visual Studio的Cake扩展**（[https://marketplace.visualstudio.com/items?itemName=vs-publisher-1392591.CakeforVisualStudio](https://marketplace.visualstudio.com/items?itemName=vs-publisher-1392591.CakeforVisualStudio)）。'
- en: 'The `.vsix` file downloaded from the marketplace is essentially a `.zip` file.
    This file contains the contents of the Cake extensions to be installed in Visual
    Studio. When the downloaded `.vsix` file is run, it will install Cake support
    for Visual Studio 2015 and 2017:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 从市场下载的`.vsix`文件本质上是一个`.zip`文件。该文件包含要安装在Visual Studio中的Cake扩展的内容。运行下载的`.vsix`文件时，它将为Visual
    Studio 2015和2017安装Cake支持：
- en: '![](img/44266f77-d110-417f-802c-419f313badbc.png)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![](img/44266f77-d110-417f-802c-419f313badbc.png)'
- en: Cake templates
  id: totrans-122
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Cake模板
- en: 'After installing the extension, a **Cake template** will be added to the available
    options in Visual Studio when creating new projects. The extension will add four
    different Cake project templates types:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 安装扩展后，在创建新项目时，Visual Studio的可用选项中将添加一个**Cake模板**。该扩展将添加四种不同的Cake项目模板类型：
- en: '**Cake Addin**: This is a project template for creating Cake Addin'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Cake Addin**：用于创建Cake Addin的项目模板'
- en: '**Cake Addin Unit Test Project**: This is the project template for creating
    unit tests for Cake Addin and it includes samples that serve as guidelines'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Cake Addin Unit Test Project**：用于为Cake Addin创建单元测试的项目模板，其中包括作为指南的示例'
- en: '**Cake Addin Unit Test Project (empty)**: This is the project template for
    creating unit tests for Cake Addin but without the sample included'
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Cake Addin Unit Test Project (empty)**：用于为Cake Addin创建单元测试的项目模板，但不包括示例'
- en: '**Cake Module**: This template is used to create the Cake module and it comes
    with samples'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Cake Module**：此模板用于创建Cake模块，并附带示例'
- en: 'The following image shows the different Cake project templates:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图片显示了不同的Cake项目模板：
- en: '![](img/420aa26e-2963-4359-9099-9b91652d4bd4.png)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![](img/420aa26e-2963-4359-9099-9b91652d4bd4.png)'
- en: Task Runner Explorer
  id: totrans-130
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 任务运行器资源管理器
- en: In a Visual Studio solution that uses a Cake script for build automation, the
    Cake task runner will be triggered when the `build.cake` file is discovered. Cake
    Extension activates the **Task Runner Explorer** integration, which allows you
    to run Cake tasks with the bindings included directly in Visual Studio.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用Cake脚本进行构建自动化的Visual Studio解决方案中，当发现`build.cake`文件时，Cake任务运行器将被触发。Cake扩展激活了**任务运行器资源管理器**集成，允许您在Visual
    Studio中直接运行包含的绑定的Cake任务。
- en: 'To open the Task Runner Explorer, right-click the Cake Script (`build.cake`
    file) and select Task Runner Explorer from the displayed context menu; it should
    open the Task Runner Explorer with all the tasks available in the Cake script
    listed in the window:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 要打开任务运行器资源管理器，请右键单击Cake脚本（`build.cake`文件）并从显示的上下文菜单中选择任务运行器资源管理器；它应该打开任务运行器资源管理器，并在窗口中列出Cake脚本中的所有任务：
- en: '![](img/90fca57a-1b4f-4e76-9030-19108af3d10f.png)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![](img/90fca57a-1b4f-4e76-9030-19108af3d10f.png)'
- en: 'Sometimes, Task Runner Explorer might not be displayed in the context menu
    when you right-click the Cake Script. If so, click on View menu, select Other
    Windows, and select Task Runner Explorer to bring it up:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，当右键单击Cake脚本时，任务运行器资源管理器可能不会显示在上下文菜单中。如果是这样，请单击“查看”菜单，选择“其他窗口”，然后选择“任务运行器资源管理器”以打开它：
- en: '![](img/8e34532d-c3e6-44fb-b723-90f17796f45a.png)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8e34532d-c3e6-44fb-b723-90f17796f45a.png)'
- en: 'As a result of the Cake Extension installation, the Build menu of Visual Studio
    will now have an entry for Cake Build, which can be used to install the Cake config
    file, PowerShell bootstrapper, and Bash bootstrapper if they are not already configured
    in the solution:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 通过安装Cake扩展，Visual Studio的构建菜单现在将包含一个Cake构建的条目，可以用来安装Cake配置文件、PowerShell引导程序和Bash引导程序，如果它们在解决方案中尚未配置的话：
- en: '![](img/2f14889e-ae82-4070-814c-8b7b4d65276e.png)'
  id: totrans-137
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2f14889e-ae82-4070-814c-8b7b4d65276e.png)'
- en: 'You can now execute each task directly from Task Runner Explorer by double-clicking
    it or through right-clicking it and selecting Run. The progress of the task execution
    will be displayed on Task Runner Explorer:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您可以通过双击或右键单击并选择运行，直接从任务运行器资源管理器中执行每个任务。任务执行的进度将显示在任务运行器资源管理器上：
- en: '![](img/5eee7748-df49-4e1b-af88-28164eb99a52.png)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5eee7748-df49-4e1b-af88-28164eb99a52.png)'
- en: Syntax highlighting
  id: totrans-140
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 语法高亮显示
- en: Cake extension adds a syntax highlighting feature to Visual Studio. This is
    a common feature of IDEs, where source code are presented in different formats,
    colors, and fonts. The source code highlighting is done based on defined groups,
    categories, and sections.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: Cake扩展为Visual Studio添加了语法高亮显示功能。这是IDE的常见功能，其中源代码以不同的格式、颜色和字体呈现。源代码高亮显示是基于定义的组、类别和部分进行的。
- en: After the installation of the extension, any file with the `.cake` extension
    can be opened in Visual Studio with complete task and syntax highlighting. There
    is currently no IntelliSense support for the `.cake` script files in Visual Studio;
    this feature is expected to come later.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 安装扩展后，任何带有`.cake`扩展名的文件都可以在Visual Studio中打开，并具有完整的任务和语法高亮显示。目前，Visual Studio中的`.cake`脚本文件没有IntelliSense支持；预计这个功能将在以后推出。
- en: 'The following screenshot shows the syntax highlighting of a `build.cake` file
    in Visual Studio:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了在Visual Studio中对`build.cake`文件进行的语法高亮显示：
- en: '![](img/91d2d1b8-f0c5-4f95-9dfb-35315eea0dde.png)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![](img/91d2d1b8-f0c5-4f95-9dfb-35315eea0dde.png)'
- en: Using Cake tasks to build steps
  id: totrans-145
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Cake任务来构建步骤
- en: Using Task Runner Explorer to run build tasks written in Cake scripts is easier
    and more convenient. This is usually done through Cake Extension for Visual Studio
    or by directly invoking the Cake bootstrapper file. However, there is an alternative
    that is more efficient, which is to run the Cake build script using the TeamCity
    CI tool.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 使用任务运行器资源管理器来运行用Cake脚本编写的构建任务更加简单和方便。这通常是通过Visual Studio的Cake扩展或直接调用Cake引导文件来完成的。然而，还有一种更有效的替代方法，那就是使用TeamCity
    CI工具来运行Cake构建脚本。
- en: 'The TeamCity build steps can be used to execute Cake scripts as part of the
    build steps execution processes. Let''s create a build step that executes the
    Cake script for the `LoanApplication` project by following these steps:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: TeamCity构建步骤可用于执行Cake脚本作为构建步骤执行过程的一部分。让我们按照以下步骤为`LoanApplication`项目创建执行Cake脚本的构建步骤：
- en: Click on Add Build Step to open a New Build Step window.
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 单击添加构建步骤以打开新的构建步骤窗口。
- en: In the Runner type, select PowerShell, since the Cake bootstrapper file will
    be invoked by PowerShell.
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在运行器类型中，选择PowerShell，因为Cake引导文件将由PowerShell调用。
- en: Give the build step a descriptive name in the text field.
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在文本字段中为构建步骤命名。
- en: In the Script option, select File. This is because it is a `.ps1` file that
    will be invoked and not a direct PowerShell script.
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在脚本选项中，选择文件。这是因为它是一个`.ps1`文件，将被调用，而不是一个直接的PowerShell脚本。
- en: To select the Script file, click on the tree icon; this will load the available
    files and folders available in the project hosted on GitHub. Select the `build.ps1`
    file in the list of displayed files.
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要选择脚本文件，请单击树图标；这将加载GitHub上托管的项目中可用的文件和文件夹。在显示的文件列表中选择`build.ps1`文件。
- en: 'Click on the Save button to save the changes and create the build step:'
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 单击保存按钮以保存更改并创建构建步骤：
- en: '![](img/55758bfb-c70e-49d9-b120-f950f7425b29.png)'
  id: totrans-154
  prefs: []
  type: TYPE_IMG
  zh: '![](img/55758bfb-c70e-49d9-b120-f950f7425b29.png)'
- en: 'The new build step should appear in the list of available build steps configured
    for the project in TeamCity. In the Parameters Description tab, information about
    the build step will be displayed showing the runner type and PowerShell file to
    be executed, as seen in the following screenshot:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 新的构建步骤应该出现在TeamCity项目中配置的可用构建步骤列表中。在参数描述选项卡中，将显示有关构建步骤的信息，显示运行器类型和要执行的PowerShell文件，如下截图所示：
- en: '![](img/b8d97cca-24a1-4f19-a4b8-dfd909135d89.png)'
  id: totrans-156
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b8d97cca-24a1-4f19-a4b8-dfd909135d89.png)'
- en: CI with Visual Studio Team Services
  id: totrans-157
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Visual Studio Team Services进行CI
- en: '**Microsoft Visual Studio Team Services** (**VSTS**) is the cloud version of
    the **Team Foundation Server** (**TFS**). It provides great features that allow
    developers to collaborate on software project development. Similar to TFS, it
    provides an easy and simplified server management experience with enhanced connectivity
    with remote sites.'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '**Microsoft Visual Studio Team Services**（**VSTS**）是**Team Foundation Server**（**TFS**）的云版本。它提供了让开发人员协作进行软件项目开发的出色功能。与TFS类似，它提供了易于理解的服务器管理体验，并增强了与远程站点的连接。'
- en: VSTS provides great experience for development teams practicing CI and **Continuous
    Delivery** (**CD**). It has support for Git repositories for source control, easy-to-understand
    reports, and customizable dashboards for monitoring the overall progress of software
    projects.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: VSTS为实践CI和**持续交付**（**CD**）的开发团队提供了出色的体验。它支持Git存储库进行源代码控制，易于理解的报告以及可定制的仪表板，用于监视软件项目的整体进展。
- en: Also, it has in-built features and tools for build and release management, planning
    and tracking projects, managing code defects, and issues using the *Kanban* and
    *Scrum* methods. It equally has an in-built wiki for information dissemination
    with a development team.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，它还具有内置的构建和发布管理功能，规划和跟踪项目，使用*Kanban*和*Scrum*方法管理代码缺陷和问题。它同样还有一个内置的维基用于与开发团队进行信息传播。
- en: You connect to VSTS through the internet, using Microsoft accounts that need
    to have been created by the developers. However, development teams in an organization
    can configure VSTS authentication to work with **Azure Active Directory** (**Azure
    AD**), or set up Azure AD with security features, such as IP address restrictions
    and multi-factor authentication.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过互联网连接到VSTS，使用开发人员需要已创建的Microsoft帐户。但是，组织中的开发团队可以配置VSTS身份验证以与**Azure Active
    Directory**（**Azure AD**）一起使用，或者设置Azure AD以具有IP地址限制和多因素身份验证等安全功能。
- en: Setting up a project in VSTS
  id: totrans-162
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在VSTS中设置项目
- en: 'To get started with VSTS, navigate to [https://www.visualstudio.com/team-services/](https://www.visualstudio.com/team-services/)
    to create a free account. You can sign in with a Microsoft account, if you have
    created one, or using your organization''s Active Directory authentication. You
    should be redirected to the following screen:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始使用VSTS，请转到[https://www.visualstudio.com/team-services/](https://www.visualstudio.com/team-services/)创建免费帐户。如果您已经创建了Microsoft帐户，可以使用该帐户登录，或者使用您组织的Active
    Directory身份验证。您应该被重定向到以下屏幕：
- en: '![](img/47bff39b-f14e-4e83-9638-d90678de1ded.png)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![](img/47bff39b-f14e-4e83-9638-d90678de1ded.png)'
- en: In VSTS, each account has it own customized URL, which contains a team project
    collection, for example, [https://packt.visualstudio.com](https://packt.visualstudio.com).
    You should specify the URL; in the field and select the Version control to use
    with the projects. VSTS currently supports Git and Team Foundation Version Control.
    Click continue to proceed with the account creation.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 在VSTS中，每个帐户都有自己定制的URL，其中包含一个团队项目集合，例如，[https://packt.visualstudio.com](https://packt.visualstudio.com)。您应该在字段中指定URL，并选择要与项目一起使用的版本控制。VSTS目前支持Git和Team
    Foundation版本控制。单击“继续”以继续进行帐户创建。
- en: 'After the account creation, click on the Projects menu to navigate to the Projects
    page, and then click on New Project to create a new project. This will load the
    project creation screen where you will specify the project name, description,
    the Version control to use, and the work item process. Click on the Create button
    to complete the project creation:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 创建帐户后，单击“项目”菜单导航到项目页面，然后单击“新建项目”创建新项目。这将加载项目创建屏幕，在那里您将指定项目名称，描述，要使用的版本控制以及工作项过程。单击“创建”按钮完成项目创建：
- en: '![](img/c166cb04-a50b-43a5-98a5-8cc789625d85.png)'
  id: totrans-167
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c166cb04-a50b-43a5-98a5-8cc789625d85.png)'
- en: 'After the project creation is completed, you will be presented with the getting
    started screen. The screen provides options of cloning existing projects or pushing
    an existing project to it. Let''s import the `LoanApplication` project we created
    earlier on GitHub. Click on the Import button to begin the import process:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 项目创建完成后，您将看到“入门”屏幕。该屏幕提供了克隆现有项目或将现有项目推送到其中的选项。让我们导入我们之前在GitHub上创建的`LoanApplication`项目。单击“导入”按钮开始导入过程：
- en: '![](img/6116c3a9-7bff-45d9-9b4a-07044998d00d.png)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6116c3a9-7bff-45d9-9b4a-07044998d00d.png)'
- en: 'At the Import screen, specify the source type, and URL to the GitHub repository,
    and provide the GitHub login credentials. Click on the Import button to begin
    the import process:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 在导入屏幕上，指定源类型和GitHub存储库的URL，并提供GitHub登录凭据。单击“导入”按钮开始导入过程：
- en: '![](img/fc0bb721-bf03-4094-b64d-2cfc5089e6bb.png)'
  id: totrans-171
  prefs: []
  type: TYPE_IMG
  zh: '![](img/fc0bb721-bf03-4094-b64d-2cfc5089e6bb.png)'
- en: 'You will be presented with a screen showing the import progress. The import
    process might take some time based on the size of the project to be imported.
    When the process completes, an Import successful message will be displayed on
    the screen:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 您将看到一个显示导入进度的屏幕。根据要导入的项目的大小，导入过程可能需要一些时间。当过程完成时，屏幕上将显示“导入成功”消息：
- en: '![](img/6aa3a2ed-e618-4606-a49b-2ba51a47b5cb.png)'
  id: totrans-173
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6aa3a2ed-e618-4606-a49b-2ba51a47b5cb.png)'
- en: 'Click on Click here to navigate to code view to view the files and folders
    imported by VSTS. The Files screen will present the available files and folders
    in the project with the commits and date details:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 单击“单击此处导航到代码视图”以查看VSTS导入的文件和文件夹。文件屏幕将显示项目中可用的文件和文件夹以及提交和日期详细信息：
- en: '![](img/edcc131d-73b7-4004-bfc3-7e2884dc8ffd.png)'
  id: totrans-175
  prefs: []
  type: TYPE_IMG
  zh: '![](img/edcc131d-73b7-4004-bfc3-7e2884dc8ffd.png)'
- en: Installing Cake into VSTS
  id: totrans-176
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在VSTS中安装Cake
- en: Cake has a VSTS extension that allows you to run the Cake script directly from
    the VSTS build task relatively easily. With the extension installed into VSTS,
    the Cake script would not have to be run using PowerShell, like when running Cake
    scripts in TeamCity.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: Cake在VSTS中有一个扩展，允许您相对容易地直接从VSTS构建任务运行Cake脚本。安装了扩展后，Cake脚本就不必像在TeamCity中运行Cake脚本时那样使用PowerShell来运行。
- en: 'Navigate to the Cake Build URL on Visual Studio Marketplace: [https://marketplace.visualstudio.com/items/cake-build.cake](https://marketplace.visualstudio.com/items/cake-build.cake).
    Click on the Get it free button to begin the installation of the Cake extension
    into VSTS:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 在Visual Studio Marketplace上导航到Cake Build的URL：[https://marketplace.visualstudio.com/items/cake-build.cake](https://marketplace.visualstudio.com/items/cake-build.cake)。点击“获取免费”按钮开始将Cake扩展安装到VSTS中：
- en: '![](img/6d34143d-ba22-49af-8745-47065a3df190.png)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6d34143d-ba22-49af-8745-47065a3df190.png)'
- en: 'Clicking the Get it free button will redirect to the VSTS Visual Studio | Marketplace
    integration page. On this page, select the account where you intend to install
    Cake and click the Install button:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 单击“获取免费”按钮将重定向到VSTS Visual Studio | Marketplace集成页面。在此页面上，选择要安装Cake的帐户，然后单击“安装”按钮：
- en: '![](img/947534b0-a686-443c-988a-be18ff447e97.png)'
  id: totrans-181
  prefs: []
  type: TYPE_IMG
  zh: '![](img/947534b0-a686-443c-988a-be18ff447e97.png)'
- en: 'When the installation is successful, you will be presented with a message stating
    that all is set, similar to what is in the following screenshot. Click on Proceed
    to account button to redirect you to your VSTS account page:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 安装成功后，将显示一条消息，说明一切都已设置，类似于以下截图中的内容。点击“转到帐户”按钮，将您重定向到VSTS帐户页面：
- en: '![](img/b070cbca-7837-40dd-9ccf-6833033490e7.png)'
  id: totrans-183
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b070cbca-7837-40dd-9ccf-6833033490e7.png)'
- en: Adding a build task
  id: totrans-184
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 添加构建任务
- en: After the successful installation of Cake into VSTS, you can proceed to configure
    how your code will be built and how the software will be deployed. VSTS provides
    easy approaches for building your source code and shipping your software.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 成功将Cake安装到VSTS后，您可以继续配置代码的构建方式以及软件的部署方式。VSTS提供了简单的方法来构建您的源代码并发布您的软件。
- en: To create a VSTS build that is powered by Cake, click on Build and Release and
    select the Builds submenu. This will load the build definition page; click the
    +New button on this page to begin the build-creation process.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建由Cake提供支持的VSTS构建，请单击“生成和发布”，然后选择“生成”子菜单。这将加载构建定义页面；单击此页面上的+新建按钮，开始构建创建过程。
- en: 'A screen will be displayed, where the repository is selected, see the following
    screenshot. The screen provides options of selecting the repository from different
    sources:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 将显示一个屏幕，选择存储库，如下截图所示。屏幕提供了从不同来源选择存储库的选项：
- en: '![](img/544cb5b4-077e-422e-a531-7cc654d56472.png)'
  id: totrans-188
  prefs: []
  type: TYPE_IMG
  zh: '![](img/544cb5b4-077e-422e-a531-7cc654d56472.png)'
- en: 'After selecting the repository source, click on the Continue button to load
    the template screen. On this screen, you can choose the build template to use
    for configuring the build. VSTS has featured templates for the various supported
    project types. Each template is configured with build steps related to the template
    project:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 选择存储库来源后，单击“继续”按钮以加载模板屏幕。在此屏幕上，您可以选择用于配置构建的构建模板。VSTS为各种支持的项目类型提供了特色模板。每个模板都配置了与模板项目相关的构建步骤：
- en: '![](img/e63b9142-6916-4a5f-8188-5cd14f45db18.png)'
  id: totrans-190
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e63b9142-6916-4a5f-8188-5cd14f45db18.png)'
- en: 'Scroll down to the bottom of the template list or simply type `Empty` in the
    search box to select the Empty template. Hover the mouse over the template to
    activate the Apply button, and click on the button to proceed to the task creation
    page:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 向下滚动到模板列表的底部，或者在搜索框中简单地输入“Empty”以选择空模板。将鼠标悬停在模板上以激活“应用”按钮，然后单击该按钮，以继续到任务创建页面：
- en: '![](img/1ba64504-80ab-4d87-b810-054e4f38e9c0.png)'
  id: totrans-192
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1ba64504-80ab-4d87-b810-054e4f38e9c0.png)'
- en: 'When the Tasks screen loads, click on the + button to add a task to the build.
    Scroll through the list of displayed task templates to select Cake or use the
    search box to filter the list to Cake. Click the Add button to add the Cake task
    to the list of tasks available on the phase of the build:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 当任务屏幕加载时，单击+按钮以向构建添加任务。滚动浏览显示的任务模板列表，选择Cake，或使用搜索框过滤到Cake。单击“添加”按钮，将Cake任务添加到构建阶段可用任务列表中：
- en: '![](img/d407e556-07ea-4bd5-876c-d191b8a749c7.png)'
  id: totrans-194
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d407e556-07ea-4bd5-876c-d191b8a749c7.png)'
- en: 'After adding the Cake task, click on the task to load the property screen.
    Click on the Browse button to select the `build.cake` file containing the build
    scripts for the `LoanApplication` project to be associated with the build task.
    You can modify the Display name and change the Target and Verbosity properties.
    Also, if there are arguments to be passed to the Cake script, you can supply them
    in the provided field:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 添加Cake任务后，单击任务以加载属性屏幕。单击“浏览”按钮以选择包含“LoanApplication”项目的构建脚本的“build.cake”文件，以与构建任务关联。您可以修改显示名称并更改目标和详细程度属性。此外，如果有要传递给Cake脚本的参数，可以在提供的字段中提供它们：
- en: '![](img/e46ff1de-a080-497a-ab65-c83afea895a1.png)'
  id: totrans-196
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e46ff1de-a080-497a-ab65-c83afea895a1.png)'
- en: 'Click on the Save & queue menu and select Save & queue to ensure the build
    created will be queued on the hosted agent. This will load up the build definition
    and queue screen where you can specify the comment and the Agent queue:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 单击“保存并排队”菜单，然后选择“保存并排队”，以确保创建的构建将在托管代理上排队。这将加载构建定义和排队屏幕，您可以在其中指定注释和代理队列：
- en: '![](img/e95a8519-58e3-4077-9499-e3ae3f19339a.png)'
  id: totrans-198
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e95a8519-58e3-4077-9499-e3ae3f19339a.png)'
- en: A hosted agent is the software that runs the build job. Using a hosted agent
    is the simplest and easiest way for build execution. The hosted agent is managed
    by the VSTS team.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 托管代理是运行构建作业的软件。使用托管代理是执行构建的最简单和最简单的方法。托管代理由VSTS团队管理。
- en: 'If the build is queued successfully, you should get a notification on the screen
    showing the build number stating that the build has been queued:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 如果构建成功排队，您应该会收到屏幕上显示构建编号的通知，指出构建已排队：
- en: '![](img/396d581f-b7cd-45c5-9965-d83a83a5448c.png)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![](img/396d581f-b7cd-45c5-9965-d83a83a5448c.png)'
- en: 'Click on the build number to navigate to the build execution page. The hosted
    agent will process the queue and execute the configured tasks for the build in
    the queue. The build agent will show the progress of build execution. After the
    completion of the execution, the success or failure of the build will be reported:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 单击构建编号以导航到构建执行页面。托管代理将处理队列并执行队列中构建的配置任务。构建代理将显示构建执行的进度。执行完成后，将报告构建的成功或失败。
- en: '![](img/6ddaec63-edb0-41ea-96a6-8b422da65ba3.png)'
  id: totrans-203
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6ddaec63-edb0-41ea-96a6-8b422da65ba3.png)'
- en: VSTS offers great benefits and simplifies the CI and CD processes. It provides
    tools and features that allow different IDE to easily integrate with it and makes
    end-to-end development and project testing relatively easy.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: VSTS提供了巨大的好处，并简化了CI和CD过程。它提供了工具和功能，允许不同的IDE轻松集成，并使端到端的开发和项目测试相对容易。
- en: Summary
  id: totrans-205
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we explored the Cake build automation in detail. We walked
    through the steps of installing Cake and the Cake Bootstrapper. Later, we explored
    the process of writing Cake build scripts and task creation with sample tasks
    that can be used for various build activities.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们详细探讨了Cake构建自动化。我们介绍了安装Cake和Cake Bootstrapper的步骤。之后，我们探讨了编写Cake构建脚本和任务创建的过程，并提供了可用于各种构建活动的示例任务。
- en: Also, we created a build script for the `LoanApplication` project, with the
    build script containing tasks to clean, restore, and build all projects in the
    solution and build the unit test projects contained in the solution.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，我们为`LoanApplication`项目创建了一个构建脚本，其中包含了清理、恢复和构建解决方案中所有项目以及构建解决方案中包含的单元测试项目的任务。
- en: We later created a build step in TeamCity that executes the Cake script by using
    PowerShell as the runner type. Later in the chapter, we walked through setting
    up Microsoft Visual Studio Team Services, installing Cake into VSTS, and configuring
    a build step with the Cake task.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 后来，我们在TeamCity中创建了一个构建步骤，通过使用PowerShell作为运行器类型来执行Cake脚本。在本章的后面，我们介绍了如何设置Microsoft
    Visual Studio Team Services，安装Cake到VSTS，并配置了一个包含Cake任务的构建步骤。
- en: In the final chapter, we will explore how to execute xUnit.net tests with Cake
    scripts. Later in the chapter, we will explore .NET Core versioning, .NET Core
    packaging, and metapackages. We will package the `LoanApplication` project for
    NuGet distribution.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 在最后一章中，我们将探讨如何使用Cake脚本执行xUnit.net测试。在本章的后面，我们将探讨.NET Core版本控制、.NET Core打包和元包。我们将为NuGet分发打包`LoanApplication`项目。
