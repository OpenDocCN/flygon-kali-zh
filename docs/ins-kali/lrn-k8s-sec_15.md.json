["```\n$ kubectl get pods -n insecure-nginx\nNAME\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0READY\u00a0\u00a0 STATUS\u00a0\u00a0\u00a0\u00a0RESTARTS\u00a0\u00a0 AGE\ninsecure-nginx-8455b6d49c-z6wb9\u00a0\u00a0 1/1\u00a0\u00a0\u00a0\u00a0 Running\u00a0\u00a0 0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0163m\n```", "```\nroot@insecure-nginx-8455b6d49c-z6wb9:/# ls /tmp\nminerd2\u00a0\u00a0perg\n```", "```\n- list: miner_ports\n\u00a0\u00a0items: [\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a025, 3333, 3334, 3335, 3336, 3357, 4444,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a05555, 5556, 5588, 5730, 6099, 6666, 7777,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a07778, 8000, 8001, 8008, 8080, 8118, 8333,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a08888, 8899, 9332, 9999, 14433, 14444,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a045560, 45700\n\u00a0\u00a0\u00a0\u00a0]\n- list: miner_domains\n\u00a0\u00a0items: [\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Asia1.ethpool.org\",\"ca.minexmr.com\", \"monero.crypto-pool.fr\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0...\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"xmr-jp1.nanopool.org\",\"xmr-us-east1.nanopool.org\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"xmr-us-west1.nanopool.org\",\"xmr.crypto-pool.fr\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"xmr.pool.minergate.com\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0]\n```", "```\n- macro: minerpool_other\n\u00a0\u00a0condition: (fd.sport in (miner_ports) and fd.sip.name in (miner_domains))\n```", "```\n- macro: net_miner_pool\n\u00a0\u00a0condition: (evt.type in (sendto, sendmsg) and evt.dir=< and (fd.net != \"127.0.0.0/8\" and not fd.snet in (rfc_1918_addresses)) and ((minerpool_http) or (minerpool_https) or (minerpool_other)))\n```", "```\n# The rule is disabled by default.\n# Note: Falco will send DNS requests to resolve miner pool domains which may trigger alerts in your environment.\n- rule: Detect outbound connections to common miner pool ports\n\u00a0\u00a0desc: Miners typically connect to miner pools on common ports.\n\u00a0\u00a0condition: net_miner_pool and not trusted_images_query_miner_domain_dns\n\u00a0\u00a0enabled: true\n\u00a0\u00a0output: Outbound connection to IP/Port flagged by cryptoioc.ch (command=%proc.cmdline port=%fd.rport ip=%fd.rip container=%container.info image=%container.image.repository)\n\u00a0\u00a0priority: CRITICAL\n\u00a0\u00a0tags: [network, mitre_execution]\n```", "```\n19:46:37.939287649: Critical Outbound connection to IP/Port flagged by cryptoioc.ch (command=minerd2 -a cryptonight -o stratum+tcp://monero.crypto-pool.fr:3333 -u 49TfoHGd6apXxNQTSHrMBq891vH6JiHmZHbz5Vx36nLRbz6WgcJunTtgcxno G6snKFeGhAJB5LjyAEnvhBgCs5MtEgML3LU -p x port=37110 ip=100.97.244.198 container=k8s.ns=insecure-nginx k8s.pod=insecure-nginx-8455b6d49c-z6wb9 container=07dce07d5100 image=kaizheh/victim) k8s.ns=insecure-nginx k8s.pod=insecure-nginx-8455b6d49c-z6wb9 container=07dce07d5100 k8s.ns=insecure-nginx k8s.pod=insecure-nginx-8455b6d49c-z6wb9 container=07dce07d5100\n```", "```\n- list: trusted_server_addresses\n\u00a0\u00a0items: [...]\n- list: trusted_server_ports\n\u00a0\u00a0items: [...]\n- rule: Detect anomalous outbound connections \n\u00a0\u00a0desc: Detect anomalous outbound connections\n\u00a0\u00a0condition: (evt.type in (sendto, sendmsg) and container and evt.dir=< and (fd.net != \"127.0.0.0/8\" and not fd.snet in (trusted_server_addresses) or not fd.sport in (trusted_server_ports))) \n\u00a0\u00a0output: Outbound connection to anomalous IP/Port(command=%proc.cmdline port=%fd.rport ip=%fd.rip container=%container.info image=%container.image.repository)\n\u00a0\u00a0priority: CRITICAL\n```", "```\n- rule: Detect crypto miners using the Stratum protocol\n\u00a0\u00a0desc: Miners typically specify the mining pool to connect to with a URI that begins with 'stratum+tcp'\n\u00a0\u00a0condition: spawned_process and proc.cmdline contains \"stratum+tcp\"\n\u00a0\u00a0output: Possible miner running (command=%proc.cmdline container=%container.info image=%container.image.repository)\n\u00a0\u00a0priority: CRITICAL\n\u00a0\u00a0tags: [process, mitre_execution]\n```", "```\n19:46:37.779784798: Critical Possible miner running (command=minerd2 -a cryptonight -o stratum+tcp://monero.crypto-pool.fr:3333 -u 49TfoHGd6apXxNQTSHrMBq891vH6JiHmZHbz5Vx36 nLRbz6WgcJunTtgcxnoG6snKFeGhAJB5LjyAEnvhBgCs5MtEgML3LU -p x container=k8s.ns=insecure-nginx k8s.pod=insecure-nginx-8455b6d49c-z6wb9 container=07dce07d5100 image=kaizheh/victim) k8s.ns=insecure-nginx k8s.pod=insecure-nginx-8455b6d49c-z6wb9 container=07dce07d5100 k8s.ns=insecure-nginx k8s.pod=insecure-nginx-8455b6d49c-z6wb9 container=07dce07d5100\n```", "```\n- list: trusted_nginx_processes\n\u00a0\u00a0items: [\"nginx\"]\n- rule: Detect Anomalous Process Launched in Nginx Container\n\u00a0\u00a0desc: Anomalous process launched inside container.\n\u00a0\u00a0condition: spawned_process and container and not proc.name in (trusted_nginx_processes) and image.repository.name=\"nginx\"\n\u00a0\u00a0output: Anomalous process running in Nginx container (command=%proc.cmdline container=%container.info image=%container.image.repository)\n\u00a0\u00a0priority: CRITICAL\n\u00a0\u00a0tags: [process]\n```", "```\nroot@anchore-cli:/# anchore-cli --json image content kaizheh/victim:nginx files | jq '.content | .[] | select(.filename==\"/tmp/minerd2\")'\n{\n\u00a0\u00a0\"filename\": \"/tmp/minerd2\",\n\u00a0\u00a0\"gid\": 0,\n\u00a0\u00a0\"linkdest\": null,\n\u00a0\u00a0\"mode\": \"00755\",\n\u00a0\u00a0\"sha256\": \"e86db6abf96f5851ee476eeb8c847cd73aebd0bd903827a362 c07389d71bc728\",\n\u00a0\u00a0\"size\": 183048,\n\u00a0\u00a0\"type\": \"file\",\n\u00a0\u00a0\"uid\": 0\n}\n```", "```\n$ curl -H \"Content-Type: application/json\" \"https://www.virustotal.com/vtapi/v2/file/report?apikey=$VIRUS_FEEDS_API_KEY&resource=e86db6abf96f5851ee476eeb8c847cd73aebd0bd903827a 362c07389d71bc728\" | jq .\n```", "```\n{\n\u00a0\u00a0\"scans\": {\n\u00a0\u00a0\u00a0\u00a0\"Fortinet\": {\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"detected\": true,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"version\": \"6.2.142.0\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"result\": \"Riskware/CoinMiner\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"update\": \"20200413\"\n\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0...\n\u00a0\u00a0\u00a0\u00a0\"Antiy-AVL\": {\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"detected\": true,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"version\": \"3.0.0.1\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"result\": \"RiskWare[RiskTool]/Linux.BitCoinMiner.a\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"update\": \"20200413\"\n\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0},\n\u00a0\u00a0...\n\u00a0\u00a0\"resource\": \"e86db6abf96f5851ee476eeb8c847cd73aebd0bd903827a362c07389d71bc 728\",\n\u00a0\u00a0\"scan_date\": \"2020-04-13 18:22:56\",\n\u00a0\u00a0\"total\": 60,\n\u00a0\u00a0\"positives\": 25,\n\u00a0\u00a0\"sha256\": \"e86db6abf96f5851ee476eeb8c847cd73aebd0bd903827a362c07389d71bc 728\",\n }\n```"]